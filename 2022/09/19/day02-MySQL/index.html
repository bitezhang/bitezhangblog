<!DOCTYPE html>
<html lang="zh-CN,default">
    <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/#5.7.5'>
  <meta name="generator" content="Hexo 6.2.0">
  <meta name="Volantis" content="5.7.5">
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
  <link rel="canonical" href="http://example.com/2022/09/19/day02-mysql/"/>
  <!-- 渲染优化 -->
    <meta http-equiv='x-dns-prefetch-control' content='on' />
      <link rel='dns-prefetch' href='https://unpkg.com'>
      <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Content-Security-Policy" content=" default-src 'self' https:; block-all-mixed-content; base-uri 'self' https:; form-action 'self' https:; worker-src 'self' https:; connect-src 'self' https: *; img-src 'self' data: https: *; media-src 'self' https: *; font-src 'self' data: https: *; frame-src 'self' https: *; manifest-src 'self' https: *; child-src https:; script-src 'self' https: 'unsafe-inline' *; style-src 'self' https: 'unsafe-inline' *; ">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <!-- import head_begin begin -->
  <!-- import head_begin end -->
  <!-- Custom Files headBegin begin-->
  
  <!-- Custom Files headBegin end-->
    <link rel="shortcut icon" type='image/x-icon' href="https://gcore.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  <link rel="preload" href="../../../../css/style.css" as="style">
  <link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
<link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <!-- feed -->
  <!-- 页面元数据 -->
  <title>day02-MySQL - 比特张的博客</title>
  <meta name="keywords" content="MySQL,zdy">
  <meta desc name="description" content="个人学习博客 - bitezhang - 比特张的博客">
  
<meta property="og:type" content="article">
<meta property="og:title" content="day02-MySQL">
<meta property="og:url" content="http://example.com/2022/09/19/day02-MySQL/index.html">
<meta property="og:site_name" content="比特张的博客">
<meta property="og:description" content="一、MySQL课程内容1.1 数据库介绍 数据库概念 术语介绍  1.2 MySQL数据库 下载、安装、配置、卸载 MySQL客户端工具的安装及使用  1.3 SQL 结构化查询语言 什么是SQL SQL操作数据（CRUD操作：添加、查询、修改、删除）  1.4 SQL 高级 存储过程 索引 触发器、视图  1.5 数据库设计 数据库设计步骤 数据库设计范式 E-R图 PowerDesigner建">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
<meta property="article:published_time" content="2022-09-19T01:08:56.000Z">
<meta property="article:modified_time" content="2022-10-05T06:55:20.713Z">
<meta property="article:author" content="bitezhang">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
  <style>
    /* 首屏样式 */
    #safearea {
  display: none;
}
:root {
  --color-site-body: #f4f4f4;
  --color-site-bg: #f4f4f4;
  --color-site-inner: #fff;
  --color-site-footer: #666;
  --color-card: #fff;
  --color-text: #444;
  --color-block: #f6f6f6;
  --color-inlinecode: #c74f00;
  --color-codeblock: #fff7ea;
  --color-h1: #3a3a3a;
  --color-h2: #3a3a3a;
  --color-h3: #333;
  --color-h4: #444;
  --color-h5: #555;
  --color-h6: #666;
  --color-p: #444;
  --color-list: #666;
  --color-list-hl: #30ad91;
  --color-meta: #888;
  --color-read-bkg: #e0d8c8;
  --color-read-post: #f8f1e2;
  --color-copyright-bkg: #f5f5f5;
}
* {
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  outline: none;
  margin: 0;
  padding: 0;
}
*::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
*::-webkit-scrollbar-track-piece {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
*::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
html {
  color: var(--color-text);
  width: 100%;
  height: 100%;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  font-size: 16px;
}
html >::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
html >::-webkit-scrollbar-track-piece {
  background: transparent;
}
html >::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
html >::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
body {
  background-color: var(--color-site-body);
  text-rendering: optimizelegibility;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  line-height: 1.6;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}
body.modal-active {
  overflow: hidden;
}
@media screen and (max-width: 680px) {
  body.modal-active {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
a {
  color: #2092ec;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
a:hover {
  color: #ff5722;
}
a:active,
a:hover {
  outline: 0;
}
ul,
ol {
  padding-left: 0;
}
ul li,
ol li {
  list-style: none;
}
header {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
img {
  border: 0;
  background: none;
  max-width: 100%;
}
svg:not(:root) {
  overflow: hidden;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  height: 0;
  border: 0;
  border-radius: 1px;
  -webkit-border-radius: 1px;
  border-bottom: 1px solid rgba(68,68,68,0.1);
}
button,
input {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
  text-transform: none;
  -webkit-appearance: button;
  cursor: pointer;
}
@supports (backdrop-filter: blur(20px)) {
  .blur {
    background: rgba(255,255,255,0.9) !important;
    backdrop-filter: saturate(200%) blur(20px);
  }
}
.shadow {
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.shadow.floatable {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.shadow.floatable:hover {
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
}
#l_cover {
  min-height: 64px;
}
.cover-wrapper {
  top: 0;
  left: 0;
  max-width: 100%;
  height: 100vh;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  align-self: center;
  align-content: center;
  color: var(--color-site-inner);
  padding: 0 16px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  overflow: hidden;
  margin-bottom: -100px;
}
.cover-wrapper .cover-bg {
  position: absolute;
  width: 100%;
  height: 100%;
  background-position: center;
  background-size: cover;
  -webkit-background-size: cover;
  -moz-background-size: cover;
}
.cover-wrapper .cover-bg.lazyload:not(.loaded) {
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
}
.cover-wrapper .cover-bg.lazyload.loaded {
  animation-delay: 0s;
  animation-duration: 0.5s;
  animation-fill-mode: forwards;
  animation-timing-function: ease-out;
  animation-name: fadeIn;
}
@-moz-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  z-index: 1;
  position: relative;
  width: 100%;
  height: 100%;
}
.cover-wrapper#full {
  height: calc(100vh + 100px);
  padding-bottom: 100px;
}
.cover-wrapper#half {
  max-height: 640px;
  min-height: 400px;
  height: calc(36vh - 64px + 200px);
}
.cover-wrapper #scroll-down {
  width: 100%;
  height: 64px;
  position: absolute;
  bottom: 100px;
  text-align: center;
  cursor: pointer;
}
.cover-wrapper #scroll-down .scroll-down-effects {
  color: #fff;
  font-size: 24px;
  line-height: 64px;
  position: absolute;
  width: 24px;
  left: calc(50% - 12px);
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  animation: scroll-down-effect 1.5s infinite;
  -webkit-animation: scroll-down-effect 1.5s infinite;
  -khtml-animation: scroll-down-effect 1.5s infinite;
  -moz-animation: scroll-down-effect 1.5s infinite;
  -o-animation: scroll-down-effect 1.5s infinite;
  -ms-animation: scroll-down-effect 1.5s infinite;
}
@-moz-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  margin-top: 64px;
  margin-bottom: 100px;
}
.cover-wrapper .cover-body,
.cover-wrapper .cover-body .top,
.cover-wrapper .cover-body .bottom {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  max-width: 100%;
}
.cover-wrapper .cover-body .bottom {
  margin-top: 32px;
}
.cover-wrapper .cover-body .title {
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
  font-size: 3.125rem;
  line-height: 1.2;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.cover-wrapper .cover-body .subtitle {
  font-size: 20px;
}
.cover-wrapper .cover-body .logo {
  max-height: 120px;
  max-width: calc(100% - 4 * 16px);
}
@media screen and (min-height: 1024px) {
  .cover-wrapper .cover-body .title {
    font-size: 3rem;
  }
  .cover-wrapper .cover-body .subtitle {
    font-size: 1.05rem;
  }
  .cover-wrapper .cover-body .logo {
    max-height: 150px;
  }
}
.cover-wrapper .cover-body .m_search {
  position: relative;
  max-width: calc(100% - 16px);
  width: 320px;
  vertical-align: middle;
}
.cover-wrapper .cover-body .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  width: 100%;
}
.cover-wrapper .cover-body .m_search .icon,
.cover-wrapper .cover-body .m_search .input {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.cover-wrapper .cover-body .m_search .icon {
  position: absolute;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  line-height: 2.5rem;
  width: 32px;
  top: 0;
  left: 5px;
  color: rgba(68,68,68,0.75);
}
.cover-wrapper .cover-body .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  height: 2.5rem;
  width: 100%;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  font-size: 0.875rem;
  -webkit-appearance: none;
  padding-left: 36px;
  border-radius: 1.4rem;
  -webkit-border-radius: 1.4rem;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(10px);
  border: none;
  color: var(--color-text);
}
@media screen and (max-width: 500px) {
  .cover-wrapper .cover-body .m_search .input {
    padding-left: 36px;
  }
}
.cover-wrapper .cover-body .m_search .input:hover {
  background: rgba(255,255,255,0.8);
}
.cover-wrapper .cover-body .m_search .input:focus {
  background: #fff;
}
.cover-wrapper .list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  -khtml-flex-wrap: wrap;
  -moz-flex-wrap: wrap;
  -o-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  align-items: stretch;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.cover-wrapper .list-h a {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 0;
  -ms-flex: 1 0;
  flex: 1 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  font-weight: 600;
}
.cover-wrapper .list-h a img {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  border-radius: 2px;
  -webkit-border-radius: 2px;
  margin: 4px;
  min-width: 40px;
  max-width: 44px;
}
@media screen and (max-width: 768px) {
  .cover-wrapper .list-h a img {
    min-width: 36px;
    max-width: 40px;
  }
}
@media screen and (max-width: 500px) {
  .cover-wrapper .list-h a img {
    margin: 2px 4px;
    min-width: 32px;
    max-width: 36px;
  }
}
@media screen and (max-width: 375px) {
  .cover-wrapper .list-h a img {
    min-width: 28px;
    max-width: 32px;
  }
}
.cover-wrapper {
  max-width: 100%;
}
.cover-wrapper.search .bottom .menu {
  margin-top: 16px;
}
.cover-wrapper.search .bottom .menu .list-h a {
  white-space: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  align-items: baseline;
  padding: 2px;
  margin: 4px;
  color: var(--color-site-inner);
  opacity: 0.75;
  -webkit-opacity: 0.75;
  -moz-opacity: 0.75;
  text-shadow: 0 1px 2px rgba(0,0,0,0.05);
  border-bottom: 2px solid transparent;
}
.cover-wrapper.search .bottom .menu .list-h a i {
  margin-right: 4px;
}
.cover-wrapper.search .bottom .menu .list-h a p {
  font-size: 0.9375rem;
}
.cover-wrapper.search .bottom .menu .list-h a:hover,
.cover-wrapper.search .bottom .menu .list-h a.active,
.cover-wrapper.search .bottom .menu .list-h a:active {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
  border-bottom: 2px solid var(--color-site-inner);
}
@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }
  :root:not([color-scheme]) {
    --color-site-body: #121212;
    --color-read-bkg: #1f1f1f;
    --color-read-post: #262626;
    --color-site-bg: #1f1f1f;
    --color-site-inner: rgba(238,238,238,0.871);
    --color-site-footer: rgba(170,170,170,0.871);
    --color-card: #262626;
    --color-text: rgba(238,238,238,0.871);
    --color-block: #434343;
    --color-codeblock: #1f1f1f;
    --color-inlinecode: #d56d28;
    --color-h1: rgba(255,255,255,0.871);
    --color-h2: rgba(255,255,255,0.871);
    --color-h3: rgba(255,255,255,0.6);
    --color-h4: rgba(255,255,255,0.6);
    --color-h5: rgba(255,255,255,0.6);
    --color-h6: rgba(255,255,255,0.6);
    --color-p: rgba(217,217,217,0.871);
    --color-list: rgba(217,217,217,0.871);
    --color-list-hl: #63e0c4;
    --color-meta: rgba(191,191,191,0.871);
    --color-link: rgba(191,191,191,0.871);
    --color-copyright-bkg: #21252b;
  }
  :root:not([color-scheme]) img {
    filter: brightness(70%) !important;
  }
  :root:not([color-scheme]) .blur {
    background: rgba(31,31,31,0.9) !important;
  }
  :root:not([color-scheme]) .white-box.blur {
    background: rgba(38,38,38,0.9) !important;
  }
  :root:not([color-scheme]) .nav-main .u-search-input {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a:hover {
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) .article blockquote {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .article-title a {
    color: var(--color-h1) !important;
  }
  :root:not([color-scheme]) details>summary {
    color: var(--color-p) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) details {
    border: 1px solid var(--color-site-bg) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) #u-search .modal,
  :root:not([color-scheme]) #u-search .modal-header,
  :root:not([color-scheme]) #u-search .modal-body {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #u-search .modal-body .modal-results .result:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:focus {
    background: var(--color-site-body) !important;
  }
}
[color-scheme='dark'] {
  --color-site-body: #121212;
  --color-read-bkg: #1f1f1f;
  --color-read-post: #262626;
  --color-site-bg: #1f1f1f;
  --color-site-inner: rgba(238,238,238,0.871);
  --color-site-footer: rgba(170,170,170,0.871);
  --color-card: #262626;
  --color-text: rgba(238,238,238,0.871);
  --color-block: #434343;
  --color-codeblock: #1f1f1f;
  --color-inlinecode: #d56d28;
  --color-h1: rgba(255,255,255,0.871);
  --color-h2: rgba(255,255,255,0.871);
  --color-h3: rgba(255,255,255,0.6);
  --color-h4: rgba(255,255,255,0.6);
  --color-h5: rgba(255,255,255,0.6);
  --color-h6: rgba(255,255,255,0.6);
  --color-p: rgba(217,217,217,0.871);
  --color-list: rgba(217,217,217,0.871);
  --color-list-hl: #63e0c4;
  --color-meta: rgba(191,191,191,0.871);
  --color-link: rgba(191,191,191,0.871);
  --color-copyright-bkg: #21252b;
}
[color-scheme='dark'] img {
  filter: brightness(70%) !important;
}
[color-scheme='dark'] .blur {
  background: rgba(31,31,31,0.9) !important;
}
[color-scheme='dark'] .white-box.blur {
  background: rgba(38,38,38,0.9) !important;
}
[color-scheme='dark'] .nav-main .u-search-input {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a {
  background: var(--color-block) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a:hover {
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] .article blockquote {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .article-title a {
  color: var(--color-h1) !important;
}
[color-scheme='dark'] details>summary {
  color: var(--color-p) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] details {
  border: 1px solid var(--color-site-bg) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] #u-search .modal,
[color-scheme='dark'] #u-search .modal-header,
[color-scheme='dark'] #u-search .modal-body {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #u-search .modal-body .modal-results .result:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:focus {
  background: var(--color-site-body) !important;
}
@media screen and (max-width: 500px) {
  [color-scheme='dark'] .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}
@font-face {
  font-family: 'UbuntuMono';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
@font-face {
  font-family: 'Varela Round';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
.l_header {
  position: fixed;
  z-index: 1000;
  top: 0;
  width: 100%;
  height: 64px;
  background: var(--color-card);
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.l_header.auto {
  transition: opacity 0.4s ease;
  -webkit-transition: opacity 0.4s ease;
  -khtml-transition: opacity 0.4s ease;
  -moz-transition: opacity 0.4s ease;
  -o-transition: opacity 0.4s ease;
  -ms-transition: opacity 0.4s ease;
  visibility: hidden;
}
.l_header.auto.show {
  opacity: 1 !important;
  -webkit-opacity: 1 !important;
  -moz-opacity: 1 !important;
  visibility: visible;
}
.l_header .container {
  margin-left: 16px;
  margin-right: 16px;
}
.l_header #wrapper {
  height: 100%;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.l_header #wrapper .nav-main,
.l_header #wrapper .nav-sub {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  justify-content: space-between;
  -webkit-justify-content: space-between;
  -khtml-justify-content: space-between;
  -moz-justify-content: space-between;
  -o-justify-content: space-between;
  -ms-justify-content: space-between;
  align-items: center;
}
.l_header #wrapper .nav-main {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.l_header #wrapper.sub .nav-main {
  transform: translateY(-64px);
  -webkit-transform: translateY(-64px);
  -khtml-transform: translateY(-64px);
  -moz-transform: translateY(-64px);
  -o-transform: translateY(-64px);
  -ms-transform: translateY(-64px);
}
.l_header #wrapper .nav-sub {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
  height: 64px;
  width: calc(100% - 2 * 16px);
  position: absolute;
}
.l_header #wrapper .nav-sub ::-webkit-scrollbar {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (min-width: 2048px) {
  .l_header #wrapper .nav-sub {
    max-width: 55vw;
    margin: auto;
  }
}
.l_header #wrapper.sub .nav-sub {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
}
.l_header #wrapper .title {
  position: relative;
  color: var(--color-text);
  padding-left: 24px;
  max-height: 64px;
}
.l_header #wrapper .nav-main .title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  line-height: 64px;
  padding: 0 24px;
  font-size: 1.25rem;
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
}
.l_header #wrapper .nav-main .title img {
  height: 64px;
}
.l_header .nav-sub {
  max-width: 1080px;
  margin: auto;
}
.l_header .nav-sub .title {
  font-weight: bold;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  line-height: 1.2;
  max-height: 64px;
  white-space: normal;
  flex-shrink: 1;
}
.l_header .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  line-height: 64px;
  align-items: center;
}
.l_header .switcher .s-toc {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (max-width: 768px) {
  .l_header .switcher .s-toc {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
  }
}
.l_header .switcher >li {
  height: 48px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  margin: 2px;
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li {
    margin: 0 1px;
    height: 48px;
  }
}
.l_header .switcher >li >a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  align-items: center;
  width: 48px;
  height: 48px;
  padding: 0.85em 1.1em;
  border-radius: 100px;
  -webkit-border-radius: 100px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  color: #3dd9b6;
}
.l_header .switcher >li >a:hover {
  border: none;
}
.l_header .switcher >li >a.active,
.l_header .switcher >li >a:active {
  border: none;
  background: var(--color-site-bg);
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li >a {
    width: 36px;
    height: 48px;
  }
}
.l_header .nav-sub .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
}
.l_header .m_search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  height: 64px;
  width: 240px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (max-width: 1024px) {
  .l_header .m_search {
    width: 44px;
    min-width: 44px;
  }
  .l_header .m_search input::placeholder {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
  }
  .l_header .m_search:hover {
    width: 240px;
  }
  .l_header .m_search:hover input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (min-width: 500px) {
  .l_header .m_search:hover .input {
    width: 100%;
  }
  .l_header .m_search:hover .input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search {
    min-width: 0;
  }
  .l_header .m_search input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.l_header .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  width: 100%;
  align-items: center;
}
.l_header .m_search .icon {
  position: absolute;
  width: 36px;
  left: 5px;
  color: var(--color-meta);
}
@media screen and (max-width: 500px) {
  .l_header .m_search .icon {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
.l_header .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 1.3;
  width: 100%;
  color: var(--color-text);
  background: #fafafa;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  padding-left: 40px;
  font-size: 0.875rem;
  border-radius: 8px;
  -webkit-border-radius: 8px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (min-width: 500px) {
  .l_header .m_search .input:focus {
    box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
    -webkit-box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search .input {
    background: var(--color-block);
    padding-left: 8px;
    border: none;
  }
  .l_header .m_search .input:hover,
  .l_header .m_search .input:focus {
    border: none;
  }
}
@media (max-width: 500px) {
  .l_header .m_search {
    left: 0;
    width: 0;
    overflow: hidden;
    position: absolute;
    background: #fff;
    transition: all 0.28s ease;
    -webkit-transition: all 0.28s ease;
    -khtml-transition: all 0.28s ease;
    -moz-transition: all 0.28s ease;
    -o-transition: all 0.28s ease;
    -ms-transition: all 0.28s ease;
  }
  .l_header .m_search .input {
    border-radius: 32px;
    -webkit-border-radius: 32px;
    margin-left: 16px;
    padding-left: 16px;
  }
  .l_header.z_search-open .m_search {
    width: 100%;
  }
  .l_header.z_search-open .m_search .input {
    width: calc(100% - 120px);
  }
}
ul.m-pc >li>a {
  color: inherit;
  border-bottom: 2px solid transparent;
}
ul.m-pc >li>a:active,
ul.m-pc >li>a.active {
  border-bottom: 2px solid #3dd9b6;
}
ul.m-pc li:hover >ul.list-v,
ul.list-v li:hover >ul.list-v {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.nav-list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  align-items: stretch;
}
ul.nav-list-h>li {
  position: relative;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  height: 100%;
  line-height: 2.4;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
ul.nav-list-h>li >a {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: 600;
}
ul.list-v {
  z-index: 1;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: absolute;
  background: var(--color-card);
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  margin-top: -6px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  padding: 8px 0;
}
ul.list-v.show {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.list-v hr {
  margin-top: 8px;
  margin-bottom: 8px;
}
ul.list-v >li {
  white-space: nowrap;
  word-break: keep-all;
}
ul.list-v >li.header {
  font-size: 0.78125rem;
  font-weight: bold;
  line-height: 2em;
  color: var(--color-meta);
  margin: 8px 16px 4px;
}
ul.list-v >li.header i {
  margin-right: 8px;
}
ul.list-v >li ul {
  margin-left: 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: -40px;
}
ul.list-v .aplayer-container {
  min-height: 64px;
  padding: 6px 16px;
}
ul.list-v >li>a {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  color: var(--color-list);
  font-size: 0.875rem;
  font-weight: bold;
  line-height: 36px;
  padding: 0 20px 0 16px;
  text-overflow: ellipsis;
  margin: 0 4px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
@media screen and (max-width: 1024px) {
  ul.list-v >li>a {
    line-height: 40px;
  }
}
ul.list-v >li>a >i {
  margin-right: 8px;
}
ul.list-v >li>a:active,
ul.list-v >li>a.active {
  color: var(--color-list-hl);
}
ul.list-v >li>a:hover {
  color: var(--color-list-hl);
  background: var(--color-site-bg);
}
.l_header .menu >ul>li>a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding: 0 8px;
}
.l_header .menu >ul>li>a >i {
  margin-right: 4px;
}
.l_header ul.nav-list-h>li {
  color: var(--color-list);
  line-height: 64px;
}
.l_header ul.nav-list-h>li >a {
  max-height: 64px;
  overflow: hidden;
  color: inherit;
}
.l_header ul.nav-list-h>li >a:active,
.l_header ul.nav-list-h>li >a.active {
  color: #3dd9b6;
}
.l_header ul.nav-list-h>li:hover>a {
  color: var(--color-list-hl);
}
.l_header ul.nav-list-h>li i.music {
  animation: rotate-effect 1.5s linear infinite;
  -webkit-animation: rotate-effect 1.5s linear infinite;
  -khtml-animation: rotate-effect 1.5s linear infinite;
  -moz-animation: rotate-effect 1.5s linear infinite;
  -o-animation: rotate-effect 1.5s linear infinite;
  -ms-animation: rotate-effect 1.5s linear infinite;
}
@-moz-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-webkit-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-o-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
.menu-phone li ul.list-v {
  right: calc(100% - 0.5 * 16px);
}
.menu-phone li ul.list-v ul {
  right: calc(100% - 0.5 * 16px);
}
#wrapper {
  max-width: 1080px;
  margin: auto;
}
@media screen and (min-width: 2048px) {
  #wrapper {
    max-width: 55vw;
  }
}
#wrapper .menu {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 1;
  -ms-flex: 1 1;
  flex: 1 1;
  margin: 0 16px 0 0;
}
#wrapper .menu .list-v ul {
  left: calc(100% - 0.5 * 16px);
}
.menu-phone {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: 16px;
  right: 8px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.menu-phone ul {
  right: calc(100% - 0.5 * 16px);
}
@media screen and (max-width: 500px) {
  .menu-phone {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: block;
  }
}
.l_header {
  max-width: 65vw;
  left: calc((100% - 65vw) * 0.5);
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}
@media screen and (max-width: 2048px) {
  .l_header {
    max-width: 1112px;
    left: calc((100% - 1112px) * 0.5);
  }
}
@media screen and (max-width: 1112px) {
  .l_header {
    left: 0;
    border-radius: 0;
    -webkit-border-radius: 0;
    max-width: 100%;
  }
}
@media screen and (max-width: 500px) {
  .l_header .container {
    margin-left: 0;
    margin-right: 0;
  }
  .l_header #wrapper .nav-main .title {
    padding-left: 16px;
    padding-right: 16px;
  }
  .l_header #wrapper .nav-sub {
    width: 100%;
  }
  .l_header #wrapper .nav-sub .title {
    overflow-y: scroll;
    margin-top: 2px;
    padding: 8px 16px;
  }
  .l_header #wrapper .switcher {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
    margin-right: 8px;
  }
  .l_header .menu {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
@media screen and (max-width: 500px) {
  .list-v li {
    max-width: 270px;
  }
}
#u-search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 60px 20px;
  z-index: 1001;
}
@media screen and (max-width: 680px) {
  #u-search {
    padding: 0px;
  }
}
@media screen and (prefers-color-scheme: dark) and (max-width: 500px) {
  .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}

  </style>
  <link rel="stylesheet" href="../../../../css/style.css" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="../../../../css/style.css"></noscript>
    <script>
      let userColorScheme=localStorage.getItem("color-scheme")
      if(userColorScheme){
        document.documentElement.setAttribute("color-scheme", userColorScheme);
      }
    </script>
  
<script>
if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode))
    document.write(
	'<style>'+
		'html{'+
			'overflow-x: hidden !important;'+
			'overflow-y: hidden !important;'+
		'}'+
		'.kill-ie{'+
			'text-align:center;'+
			'height: 100%;'+
			'margin-top: 15%;'+
			'margin-bottom: 5500%;'+
		'}'+
    '.kill-t{'+
      'font-size: 2rem;'+
    '}'+
    '.kill-c{'+
      'font-size: 1.2rem;'+
    '}'+
		'#l_header,#l_body{'+
			'display: none;'+
		'}'+
	'</style>'+
    '<div class="kill-ie">'+
        `<span class="kill-t"><b>抱歉，您的浏览器无法访问本站</b></span><br/>`+
        `<span class="kill-c">微软已经于2016年终止了对 Internet Explorer (IE) 10 及更早版本的支持，<br/>继续使用存在极大的安全隐患，请使用当代主流的浏览器进行访问。</span><br/>`+
        `<a target="_blank" rel="noopener" href="https://blogs.windows.com/windowsexperience/2021/05/19/the-future-of-internet-explorer-on-windows-10-is-in-microsoft-edge/"><strong>了解详情 ></strong></a>`+
    '</div>');
</script>


<noscript>
	<style>
		html{
			overflow-x: hidden !important;
			overflow-y: hidden !important;
		}
		.kill-noscript{
			text-align:center;
			height: 100%;
			margin-top: 15%;
			margin-bottom: 5500%;
		}
    .kill-t{
      font-size: 2rem;
    }
    .kill-c{
      font-size: 1.2rem;
    }
		#l_header,#l_body{
			display: none;
		}
	</style>
    <div class="kill-noscript">
        <span class="kill-t"><b>抱歉，您的浏览器无法访问本站</b></span><br/>
        <span class="kill-c">本页面需要浏览器支持（启用）JavaScript</span><br/>
        <a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=启用JavaScript"><strong>了解详情 ></strong></a>
    </div>
</noscript>


  <script>
  /************这个文件存放不需要重载的全局变量和全局函数*********/
  window.volantis = {}; // volantis 全局变量
  volantis.debug = false; // 开启调试模式
  volantis.dom = {}; // 页面Dom see: /source/js/app.js etc.

  volantis.GLOBAL_CONFIG ={
    debug: false,
    cdn: {"js":{"app":"../../../../js/app.js","parallax":"../../../../js/plugins/parallax.js","rightMenu":"../../../../js/plugins/rightMenu.js","rightMenus":"../../../../js/plugins/rightMenus.js","sites":"../../../../js/plugins/tags/sites.js","friends":"../../../../js/plugins/tags/friends.js","contributors":"../../../../js/plugins/tags/contributors.js","search":"../../../../js/search/hexo.js"},"css":{"style":"../../../../css/style.css"}},
    default: {"avatar":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg","link":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/link/8f277b4ee0ecd.svg","cover":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg","image":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/image/2659360.svg"},
    lastupdate: new Date(1665990608227),
    sidebar: {
      for_page: ["blogger","category","tagcloud","text","webinfo"],
      for_post: ["toc"],
      webinfo: {
        lastupd: {
          enable: true,
          friendlyShow: true
        },
        runtime: {
          data: "2022/09/01",
          unit: "天"
        }
      }
    },
    plugins: {
      message: {"enable":true,"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/css/iziToast.min.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/js/iziToast.min.js","icon":{"default":"fa-solid fa-info-circle light-blue","quection":"fa-solid fa-question-circle light-blue"},"time":{"default":5000,"quection":20000},"position":"topRight","transitionIn":"bounceInLeft","transitionOut":"fadeOutRight","titleColor":"var(--color-text)","messageColor":"var(--color-text)","backgroundColor":"var(--color-card)","zindex":2147483647,"copyright":{"enable":true,"title":"知识共享许可协议","message":"请遵守 CC BY-NC-SA 4.0 协议。","icon":"far fa-copyright light-blue"},"aplayer":{"enable":true,"play":"fa-solid fa-play","pause":"fa-solid fa-pause"},"rightmenu":{"enable":true,"notice":true}},
      fancybox: {"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.umd.js"},
      
      aplayer: {
        id: 7632089142,
        enable:true
      },
      
      
      
    }
  }

  /******************** volantis.EventListener ********************************/
  // 事件监听器 see: /source/js/app.js
  volantis.EventListener = {}
  // 这里存放pjax切换页面时将被移除的事件监听器
  volantis.EventListener.list = []
  //构造方法
  function volantisEventListener(type, f, ele) {
    this.type = type
    this.f = f
    this.ele = ele
  }
  // 移除事件监听器
  volantis.EventListener.remove = () => {
    volantis.EventListener.list.forEach(function (i) {
      i.ele.removeEventListener(i.type, i.f, false)
    })
    volantis.EventListener.list = []
  }
  /******************** volantis.dom.$ ********************************/
  // 注：这里没有选择器，也没有forEach一次只处理一个dom，这里重新封装主题常用的dom方法，返回的是dom对象，对象包含了以下方法，同时保留dom的原生API
  function volantisDom(ele) {
    if (!ele) ele = document.createElement("div")
    this.ele = ele;
    // ==============================================================
    this.ele.find = (c) => {
      let q = this.ele.querySelector(c)
      if (q)
        return new volantisDom(q)
    }
    // ==============================================================
    this.ele.hasClass = (c) => {
      return this.ele.className.match(new RegExp('(\\s|^)' + c + '(\\s|$)'));
    }
    this.ele.addClass = (c) => {
      this.ele.classList.add(c);
      return this.ele
    }
    this.ele.removeClass = (c) => {
      this.ele.classList.remove(c);
      return this.ele
    }
    this.ele.toggleClass = (c) => {
      if (this.ele.hasClass(c)) {
        this.ele.removeClass(c)
      } else {
        this.ele.addClass(c)
      }
      return this.ele
    }
    // ==============================================================
    // 参数 r 为 true 表示pjax切换页面时事件监听器将被移除，false不移除
    this.ele.on = (c, f, r = 1) => {
      this.ele.addEventListener(c, f, false)
      if (r) {
        volantis.EventListener.list.push(new volantisEventListener(c, f, this.ele))
      }
      return this.ele
    }
    this.ele.click = (f, r) => {
      this.ele.on("click", f, r)
      return this.ele
    }
    this.ele.scroll = (f, r) => {
      this.ele.on("scroll", f, r)
      return this.ele
    }
    // ==============================================================
    this.ele.html = (c) => {
      // if(c=== undefined){
      //   return this.ele.innerHTML
      // }else{
      this.ele.innerHTML = c
      return this.ele
      // }
    }
    // ==============================================================
    this.ele.hide = (c) => {
      this.ele.style.display = "none"
      return this.ele
    }
    this.ele.show = (c) => {
      this.ele.style.display = "block"
      return this.ele
    }
    // ==============================================================
    return this.ele
  }
  volantis.dom.$ = (ele) => {
    return !!ele ? new volantisDom(ele) : null;
  }
  /******************** RunItem ********************************/
  function RunItem() {
    this.list = []; // 存放回调函数
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = ()=>{
          volantis.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) =>{
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index,1);
        }
      }
    }
    // 构造一个可以run的对象
    function Item(fn, name) {
      // 函数名称
      this.name = name || fn.name;
      // run方法
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }
  /******************** Pjax ********************************/
  // /layout/_plugins/pjax/index.ejs
  // volantis.pjax.send(callBack[,"callBackName"]) 传入pjax:send回调函数
  // volantis.pjax.push(callBack[,"callBackName"]) 传入pjax:complete回调函数
  // volantis.pjax.error(callBack[,"callBackName"]) 传入pjax:error回调函数
  volantis.pjax = {};
  volantis.pjax.method = {
    complete: new RunItem(),
    error: new RunItem(),
    send: new RunItem(),
  };
  volantis.pjax = Object.assign(volantis.pjax, {
    push: volantis.pjax.method.complete.push,
    error: volantis.pjax.method.error.push,
    send: volantis.pjax.method.send.push,
  });
  /******************** RightMenu ********************************/
  // volantis.rightmenu.handle(callBack[,"callBackName"]) 外部菜单项控制
  // 可在 volantis.mouseEvent 处获取右键事件
  volantis.rightmenu = {};
  volantis.rightmenu.method = {
    handle: new RunItem(),
  }
  volantis.rightmenu = Object.assign(volantis.rightmenu, {
    handle: volantis.rightmenu.method.handle.push,
  });
  /********************  Dark Mode  ********************************/
  // /layout/_partial/scripts/darkmode.ejs
  // volantis.dark.mode 当前模式 dark or light
  // volantis.dark.toggle() 暗黑模式触发器
  // volantis.dark.push(callBack[,"callBackName"]) 传入触发器回调函数
  volantis.dark = {};
  volantis.dark.method = {
    toggle: new RunItem(),
  };
  volantis.dark = Object.assign(volantis.dark, {
    push: volantis.dark.method.toggle.push,
  });
  /********************  Message  ********************************/
  // VolantisApp.message
  /********************  isMobile  ********************************/
  // /source/js/app.js
  // volantis.isMobile
  // volantis.isMobileOld
  /********************脚本动态加载函数********************************/
  // volantis.js(src, cb)  cb 可以传入onload回调函数 或者 JSON对象 例如: volantis.js("src", ()=>{}) 或 volantis.js("src", {defer:true,onload:()=>{}})
  // volantis.css(src)

  // 返回Promise对象，如下方法同步加载资源，这利于处理文件资源之间的依赖关系，例如：APlayer 需要在 MetingJS 之前加载
  // (async () => {
  //     await volantis.js("...theme.plugins.aplayer.js.aplayer...")
  //     await volantis.js("...theme.plugins.aplayer.js.meting...")
  // })();

  // 已经加入了setTimeout
  volantis.js = (src, cb) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }
  volantis.css = (src) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  }
  /********************按需加载的插件********************************/
  // volantis.import.jQuery().then(()=>{})
  volantis.import = {
    jQuery: () => {
      if (typeof jQuery == "undefined") {
        return volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/jquery/dist/jquery.min.js")
      } else {
        return new Promise(resolve => {
          resolve()
        });
      }
    }
  }
  /********************** requestAnimationFrame ********************************/
  // 1、requestAnimationFrame 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率，一般来说，这个频率为每秒60帧。
  // 2、在隐藏或不可见的元素中，requestAnimationFrame 将不会进行重绘或回流，这当然就意味着更少的的 cpu，gpu 和内存使用量。
  volantis.requestAnimationFrame = (fn)=>{
    if (!window.requestAnimationFrame) {
      window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
    }
    window.requestAnimationFrame(fn)
  }
  /************************ layoutHelper *****************************************/
  volantis.layoutHelper = (helper, html, opt)=>{
    opt = Object.assign({clean:false, pjax:true}, opt)
    function myhelper(helper, html, clean) {
      volantis.tempDiv = document.createElement("div");
      volantis.tempDiv.innerHTML = html;
      let layoutHelper = document.querySelector("#layoutHelper-"+helper)
      if (layoutHelper) {
        if (clean) {
          layoutHelper.innerHTML = ""
        }
        layoutHelper.append(volantis.tempDiv);
      }
    }
    myhelper(helper, html, opt.clean)
    if (opt.pjax) {
      volantis.pjax.push(()=>{
        myhelper(helper, html, opt.clean)
      },"layoutHelper-"+helper)
    }
  }
  /****************************** 滚动事件处理 ****************************************/
  volantis.scroll = {
    engine: new RunItem(),
    unengine: new RunItem(),
  };
  volantis.scroll = Object.assign(volantis.scroll, {
    push: volantis.scroll.engine.push,
  });
  // 滚动条距离顶部的距离
  volantis.scroll.getScrollTop = () =>{
    let scrollPos;
    if (window.pageYOffset) {
      scrollPos = window.pageYOffset;
    } else if (document.compatMode && document.compatMode != 'BackCompat') {
      scrollPos = document.documentElement.scrollTop;
    } else if (document.body) {
      scrollPos = document.body.scrollTop;
    }
    return scrollPos;
  }
  // 使用 requestAnimationFrame 处理滚动事件
  // `volantis.scroll.del` 中存储了一个数值, 该数值检测一定时间间隔内滚动条滚动的位移, 数值的检测频率是浏览器的刷新频率. 数值为正数时, 表示向下滚动. 数值为负数时, 表示向上滚动.
  volantis.scroll.handleScrollEvents = () => {
    volantis.scroll.lastScrollTop = volantis.scroll.getScrollTop()
    function loop() {
      const scrollTop = volantis.scroll.getScrollTop();
      if (volantis.scroll.lastScrollTop !== scrollTop) {
        volantis.scroll.del = scrollTop - volantis.scroll.lastScrollTop;
        volantis.scroll.lastScrollTop = scrollTop;
        // if (volantis.scroll.del > 0) {
        //   console.log("向下滚动");
        // } else {
        //   console.log("向上滚动");
        // }
        // 注销过期的unengine未滚动事件
        volantis.scroll.unengine.list=[]
        volantis.scroll.engine.start();
      }else{
        volantis.scroll.unengine.start();
      }
      volantis.requestAnimationFrame(loop)
    }
    volantis.requestAnimationFrame(loop)
  }
  volantis.scroll.handleScrollEvents()
  // 触发页面滚动至目标元素位置
  volantis.scroll.to = (ele, option = {}) =>{
    // 默认配置
    opt = {
      top: ele.getBoundingClientRect().top + document.documentElement.scrollTop,
      behavior: "smooth"
    }
    // 定义配置
    if ("top" in option) {
      opt.top = option.top
    }
    if ("behavior" in option) {
      opt.behavior = option.behavior
    }
    if ("addTop" in option) {
      opt.top += option.addTop
    }
    if (!("observerDic" in option)) {
      option.observerDic = 100
    }
    // 滚动
    window.scrollTo(opt);
    // 监视器
    // 监视并矫正元素滚动到指定位置
    // 用于处理 lazyload 引起的 cls 导致的定位失败问题
    // option.observer = false
    if (option.observer) {
      setTimeout(()=>{
        volantis.scroll.unengine.push(()=>{
          let me = ele.getBoundingClientRect().top
          if(!(me >= -option.observerDic && me <= option.observerDic)){
            volantis.scroll.to(ele, option)
          }
          volantis.scroll.unengine.remove("unengineObserver")
        },"unengineObserver")
      },1000)
    }
  }
  /********************** Content Visibility ********************************/
  // 见 source/css/first.styl 如果遇到任何问题 删除 .post-story 即可
  // 一个元素被声明 content-visibility 属性后 如果元素不在 viewport 中 浏览器不会计算其后代元素样式和属性 从而节省 Style & Layout 耗时
  // content-visibility 的副作用: 锚点失效 等等(实验初期 暂不明确), 使用此方法清除样式
  volantis.cleanContentVisibility = ()=>{
    if (document.querySelector(".post-story")) {
      console.log("cleanContentVisibility");
      document.querySelectorAll(".post-story").forEach(e=>{
        e.classList.remove("post-story")
      })
    }
  }
  /******************************************************************************/
  /******************************************************************************/
  /******************************************************************************/
  //图像加载出错时的处理
  function errorImgAvatar(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg";
    img.onerror = null;
  }
  function errorImgCover(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg";
    img.onerror = null;
  }
  /******************************************************************************/
</script>

  <!-- import head_end begin -->
  <!-- import head_end end -->
  <!-- Custom Files headEnd begin-->
  
  <!-- Custom Files headEnd end-->
</head>
  <body itemscope itemtype="http://schema.org/WebPage">
    <!-- import body_begin begin-->
    <!-- import body_begin end-->
    <!-- Custom Files bodyBegin begin-->
    
    <!-- Custom Files bodyBegin end-->
    <header itemscope itemtype="http://schema.org/WPHeader" id="l_header" class="l_header auto shadow floatable blur show" style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a id="s-comment" class="fa-solid fa-comments fa-fw" target="_self"  href="/" onclick="return false;" title="comment"></a></li>
        
          <li><a id="s-toc" class="s-toc fa-solid fa-list fa-fw" target="_self"  href="/" onclick="return false;" title="toc"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='../../../../index.html'>
          
            <img no-lazy class='logo' src='https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/Logo-NavBar@3x.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://www.bitezhang.top/" title="博客"
                  
                  
                  
                    active-action="action-https:wwwbitezhangtop"
                  >
                  <i class='fa-solid fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../categories/" title="分类"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../tags/" title="标签"
                  
                  
                  
                    active-action="action-tags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fas fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
          
				</ul>
			</div>
      
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fa-solid fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>
      

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fa-solid fa-search fa-fw" target="_self" href="/" onclick="return false;" title="search"></a></li>
				
				<li>
          <a class="s-menu fa-solid fa-bars fa-fw" target="_self" href="/" onclick="return false;" title="menu"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://www.bitezhang.top/" title="博客"
                  
                  
                  
                    active-action="action-https:wwwbitezhangtop"
                  >
                  <i class='fa-solid fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../categories/" title="分类"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../tags/" title="标签"
                  
                  
                  
                    active-action="action-tags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="../../../../about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fas fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
            
          </ul>
        </li>
			</ul>

      <!-- Custom Files header begin -->
      
      <!-- Custom Files header end -->
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
    
      <!-- see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs -->
      <div id="none" class='cover-wrapper post search' style="display: none;">
        
  <div class='cover-bg lazyload placeholder' data-bg="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/wallpaper/background/be3835ff1ecf4c779ca9b46949ba2e93.jpg"></div>

<div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">背影+</p>
    
    
      <p class="subtitle">Will you be all right tomorrow</p>
    
  </div>
  <div class='bottom'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="搜索一下" />
          <i class="icon fa-solid fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a target="_blank" rel="noopener" href="https://www.bitezhang.top/"
              
              
              active-action="action-https:wwwbitezhangtop">
              <p>主页</p>
            </a>
          
            <a href="../../../../categories/"
              
              
              active-action="action-categories">
              <p>分类</p>
            </a>
          
            <a href="../../../../tags/"
              
              
              active-action="action-tags">
              <p>标签</p>
            </a>
          
            <a href="../../../../archives/"
              
              
              active-action="action-archives">
              <p>归档</p>
            </a>
          
            <a href="../../../../friends/"
              
              
              active-action="action-friends">
              <p>友链</p>
            </a>
          
            <a href="../../../../about/"
              
              
              active-action="action-about">
              <p>关于</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

        <div id="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
      </div>
    
  
</div>

      <div id="safearea">
        <div class="body-wrapper">
          
<div id="l_main" class=''>
  <article itemscope itemtype="http://schema.org/Article" class="article post white-box reveal md shadow floatable blur article-type-post" id="post" itemscope itemprop="blogPost">
  <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/19/day02-MySQL/">
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="比特张的博客">
  </span>
  <span hidden itemprop="post" itemscope itemtype="http://schema.org/Post">
    <meta itemprop="name" content="比特张的博客">
    <meta itemprop="description" content="个人学习博客">
  </span>
  


  
    <span hidden>
      <meta itemprop="image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
    </span>
  
  <div class="article-meta" id="top">
    
      

  
    <meting-js
      mini='true'
      volume='0.7'
      loop='all'
      order='list'
      server='netease'
      type='song'
      id='564179919'>
    </meting-js>
  


    
    
    
      <h1 class="title" itemprop="name headline">
        day02-MySQL
      </h1>
      <div class='new-meta-box'>
        
          
        
          
            
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fa-solid fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：19.7k 字</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fa-solid fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：80 分钟</p>
    </a>
  </div>


          
        
          
        
        <!-- Custom Files topMeta begin-->
        
        <!-- Custom Files topMeta end-->
      </div>
    
  </div>


  <div id="layoutHelper-page-plugins"></div>
  <div id="post-body" itemprop="articleBody">
    <h2 id="一、MySQL课程内容"><a href="#一、MySQL课程内容" class="headerlink" title="一、MySQL课程内容"></a>一、MySQL课程内容</h2><h3 id="1-1-数据库介绍"><a href="#1-1-数据库介绍" class="headerlink" title="1.1 数据库介绍"></a>1.1 数据库介绍</h3><ul>
<li>数据库概念</li>
<li>术语介绍</li>
</ul>
<h3 id="1-2-MySQL数据库"><a href="#1-2-MySQL数据库" class="headerlink" title="1.2 MySQL数据库"></a>1.2 MySQL数据库</h3><ul>
<li>下载、安装、配置、卸载</li>
<li>MySQL客户端工具的安装及使用</li>
</ul>
<h3 id="1-3-SQL-结构化查询语言"><a href="#1-3-SQL-结构化查询语言" class="headerlink" title="1.3 SQL 结构化查询语言"></a>1.3 SQL 结构化查询语言</h3><ul>
<li>什么是SQL</li>
<li>SQL操作数据（CRUD操作：添加、查询、修改、删除）</li>
</ul>
<h3 id="1-4-SQL-高级"><a href="#1-4-SQL-高级" class="headerlink" title="1.4 SQL 高级"></a>1.4 SQL 高级</h3><ul>
<li>存储过程</li>
<li>索引</li>
<li>触发器、视图</li>
</ul>
<h3 id="1-5-数据库设计"><a href="#1-5-数据库设计" class="headerlink" title="1.5 数据库设计"></a>1.5 数据库设计</h3><ul>
<li>数据库设计步骤</li>
<li>数据库设计范式</li>
<li>E-R图</li>
<li>PowerDesigner建模工具、PDMan</li>
</ul>
<h3 id="1-6-数据库事务"><a href="#1-6-数据库事务" class="headerlink" title="1.6 数据库事务"></a>1.6 数据库事务</h3><ul>
<li>什么是事务</li>
<li>事务特性ACID</li>
<li>事务隔离级别</li>
<li>事务管理</li>
</ul>
<h2 id="二、数据库介绍"><a href="#二、数据库介绍" class="headerlink" title="二、数据库介绍"></a>二、数据库介绍</h2><h3 id="2-1-数据库概念"><a href="#2-1-数据库概念" class="headerlink" title="2.1 数据库概念"></a>2.1 数据库概念</h3><blockquote>
<p>数据库，就是存放数据的仓库</p>
<p>数据库（DataBase，简称DB）是长期存储在计算机内部有结构的、大量的、共享的数据集合。</p>
</blockquote>
<ul>
<li><p>长期存储：持久存储</p>
</li>
<li><p>有结构：</p>
<ul>
<li>类型：数据库不仅可以存放数据，而且存放的数据还是有类型的</li>
<li>关系：存储数据与数据之间的关系</li>
</ul>
</li>
<li><p>大量：大多数数据库都是文件系统的，也就是说存储在数据库中的数据实际上就是存储在磁盘的文件中</p>
</li>
<li><p>共享：多个应用程序可以通过数据库实现数据的共享</p>
</li>
</ul>
<h3 id="2-2-关系型数据库与非关系型数据库"><a href="#2-2-关系型数据库与非关系型数据库" class="headerlink" title="2.2 关系型数据库与非关系型数据库"></a>2.2 关系型数据库与非关系型数据库</h3><ul>
<li><p>关系型数据库</p>
<blockquote>
<p>关系型数据库，采用了关系模型来组织数据的存储，以行和列的形式存储数据并记录数据与数据之间的关系 —— 将数据存储在表格中，可以通过建立表格与表格之间的关联来维护数据与数据之间的关系。</p>
<p>学生信息—-  学生表</p>
<p>班级信息—-  班级表</p>
</blockquote>
</li>
<li><p>非关系型数据库</p>
<blockquote>
<p>非关系型数据库，采用键值对的模型来存储数据，只完成数据的记录，不会记录数据与数据之间的关系。</p>
<p>在非关系型数据库中基于其特定的存储结构来解决一些大数据应用的难题。</p>
<p>NoSQL(Not only SQL)数据库来指代非关系型数据库。</p>
</blockquote>
</li>
</ul>
<h3 id="2-3-常见的数据库产品"><a href="#2-3-常见的数据库产品" class="headerlink" title="2.3 常见的数据库产品"></a>2.3 常见的数据库产品</h3><p><strong>关系型数据库产品</strong></p>
<ul>
<li><p><code>MySQL</code> 免费</p>
<ul>
<li>MariaDB </li>
<li>Percona Server</li>
</ul>
</li>
<li><p>PostgreSQL</p>
</li>
<li><p><code>Oracle</code> 收费</p>
</li>
<li><p>SQL Server</p>
</li>
<li><p>Access</p>
</li>
<li><p>Sybase</p>
</li>
<li><p>达梦数据库</p>
</li>
</ul>
<p> <strong>非关系型数据库产品</strong></p>
<ul>
<li><p>面向检索的列式存储   Column-Oriented</p>
<ul>
<li>HaBase （Hadoop子系统）</li>
<li>BigTable （Google）</li>
</ul>
</li>
<li><p>面向高并发的缓存存储Key-Value</p>
<ul>
<li><code>Redis</code></li>
<li>MemcacheDB</li>
</ul>
</li>
<li><p>面向海量数据访问的文档存储 Document–Oriented</p>
<ul>
<li><code>MongoDB</code></li>
<li>CouchDB</li>
</ul>
</li>
</ul>
<h3 id="2-4-数据库术语"><a href="#2-4-数据库术语" class="headerlink" title="2.4 数据库术语"></a>2.4 数据库术语</h3><p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111301.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111301.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<ul>
<li><p><code>数据库（Database）</code>：存储的数据的集合，提供数据存储的服务</p>
</li>
<li><p><code>数据（Data）</code>：实际上指的是描述事物的符号记录</p>
</li>
<li><p><code>数据库管理系统（Database Management System，DBMS ）</code>： 数据库管理系统，是位于用户与操作系统之间的一层数据管理软件</p>
</li>
<li><p><code>数据库系统管理员（Database Anministrator，简称为DBA）</code>:负责数据库创建、使用及维护的专门人员</p>
</li>
<li><p><code>数据库系统（Database System，DBS）</code>：数据库系统管理员、数据库管理系统及数据库组成整个单元</p>
</li>
</ul>
<h2 id="三、MySQL数据库环境准备"><a href="#三、MySQL数据库环境准备" class="headerlink" title="三、MySQL数据库环境准备"></a>三、MySQL数据库环境准备</h2><blockquote>
<p>MySQL下载、安装、配置、卸载，安装DBMS、使用DBMS</p>
</blockquote>
<h3 id="3-1-MySQL版本及下载"><a href="#3-1-MySQL版本及下载" class="headerlink" title="3.1 MySQL版本及下载"></a>3.1 MySQL版本及下载</h3><h4 id="3-1-1-版本"><a href="#3-1-1-版本" class="headerlink" title="3.1.1 版本"></a>3.1.1 版本</h4><ul>
<li><p>MySQL 是Oracle的免费的关系型数据库 ， 官网 <a target="_blank" rel="noopener" href="https://www.mysql.com/">https://www.mysql.com/</a></p>
</li>
<li><p>MySQL 目前的最新版本为<code>8.0.26</code> ，在企业项目中主流版本： 5.0 —  5.5 — 5.6 — <code>5.7</code> — <code>8.0.26</code> </p>
<ul>
<li>5.x   —   2020年 5.7.32 </li>
<li>8.x   —   2018年8.0.11  —   2019年 8.0.16 — 2021年 8.0.26</li>
</ul>
</li>
<li><p>MySQL 8.x新特性</p>
<ul>
<li>性能：官方8.x比5.7速度要快2倍</li>
<li>支持NoSQL存储：5.7开始提供了对NoSQL的支持，8.0.x做了更进一步的改进</li>
<li>窗口函数</li>
<li>索引：隐藏索引、降序索引</li>
<li>可用性、可靠性</li>
</ul>
</li>
</ul>
<h4 id="3-1-2-下载"><a href="#3-1-2-下载" class="headerlink" title="3.1.2 下载"></a>3.1.2 下载</h4><ul>
<li><p>官网下载：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/installer/">https://dev.mysql.com/downloads/installer/</a>  </p>
<ul>
<li>需要注册oracle</li>
<li>服务器在国外，下载速度….</li>
</ul>
</li>
<li><p>镜像下载：<a target="_blank" rel="noopener" href="https://www.filehorse.com/download-mysql-64/download/">https://www.filehorse.com/download-mysql-64/download/</a></p>
</li>
</ul>
<h3 id="3-2-MySQL-安装"><a href="#3-2-MySQL-安装" class="headerlink" title="3.2 MySQL 安装"></a>3.2 MySQL 安装</h3><blockquote>
<p>傻瓜式（直接点击下一步）</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111313.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111313.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong>选择<code>Developer Default</code>模式安装</strong></p>
<p>此模式会安装开发人员需要的常用组件；在安装这些组件时需要对应的环境依赖，我们要暂停，先去安装依赖的环境：</p>
<p>例如：<code>Microsoft Visual C++ 2019 Redistributable Package (x64) is not installed. Latest binary compatible version will be installed if agreed to resolve this requirement.</code></p>
<p>安装：</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111322.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111322.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong>选择自定义<code>Custom</code>安装</strong></p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111329.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111329.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="3-3-MySQL配置"><a href="#3-3-MySQL配置" class="headerlink" title="3.3 MySQL配置"></a>3.3 MySQL配置</h3><h4 id="3-3-1-端口配置"><a href="#3-3-1-端口配置" class="headerlink" title="3.3.1 端口配置"></a>3.3.1 端口配置</h4><p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111340.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111340.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="3-3-2-账号密码设置"><a href="#3-3-2-账号密码设置" class="headerlink" title="3.3.2 账号密码设置"></a>3.3.2 账号密码设置</h4><p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111347.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111347.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="3-3-3-服务名称"><a href="#3-3-3-服务名称" class="headerlink" title="3.3.3 服务名称"></a>3.3.3 服务名称</h4><p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111355.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111355.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111406.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111406.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="3-4-MySQL-服务的启动与停止"><a href="#3-4-MySQL-服务的启动与停止" class="headerlink" title="3.4 MySQL 服务的启动与停止"></a>3.4 MySQL 服务的启动与停止</h3><blockquote>
<p>MySQL是以服务的形式运行在系统中</p>
</blockquote>
<h4 id="3-4-1-计算机管理窗口"><a href="#3-4-1-计算机管理窗口" class="headerlink" title="3.4.1 计算机管理窗口"></a>3.4.1 计算机管理窗口</h4><p><code>此电脑</code>—<code>右键</code>—<code>管理</code></p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111413.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111413.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="3-4-2-windows命令行"><a href="#3-4-2-windows命令行" class="headerlink" title="3.4.2 windows命令行"></a>3.4.2 windows命令行</h4><p>打开命令行 ： <code>win + R</code>  — 输入<code>cmd</code>回车</p>
<p>以管理员身份打开命令行：<code>win+s</code>—- 输入<code>cmd</code>—-选择<code>以管理员身份运行</code></p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111420.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111420.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="3-5-MySQL卸载"><a href="#3-5-MySQL卸载" class="headerlink" title="3.5 MySQL卸载"></a>3.5 MySQL卸载</h3><ul>
<li><p>关闭服务</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## 管理员身份启动 cmd 命令行</span><br><span class="line">net stop mysql80</span><br></pre></td></tr></table></figure>
</li>
<li><p>卸载软件</p>
<ul>
<li><p>打开控制面板</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111430.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111430.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
<li><p>点击“程序和功能”</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111439.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111439.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
<li><p>卸载MySQL</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111447.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111447.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
</ul>
</li>
<li><p>删除目录</p>
<ul>
<li>MySQL的安装目录：<code>C:\Program Files (x86)\MySQL</code></li>
<li>MySQL的数据文件目录(默认隐藏)：<code>C:\ProgramData\MySQL</code>  (如果不允许删除，强制删除)</li>
</ul>
</li>
<li><p>删除注册表</p>
<ul>
<li><p>打开注册表：<code> win+r</code> — 输入<code>regedit</code>—回车</p>
</li>
<li><p>删除 <code>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\MySQL80</code></p>
</li>
<li><p>删除搜索<code>mysql</code>的相关项（非必须）</p>
</li>
</ul>
</li>
</ul>
<h2 id="四、MySQL的管理工具"><a href="#四、MySQL的管理工具" class="headerlink" title="四、MySQL的管理工具"></a>四、MySQL的管理工具</h2><blockquote>
<p>当完成数据库的安装之后，mysql是以服务的形式运行在windows&#x2F;linux系统，用户是通过DBMS工具来对MySQL进行操作的，当我们安装完成MySQL之后默认安装了<code>mysql Commcand line Client</code>，此工具是一个命令行形式的工具，通常我们会单独安装可视化的DBMS工具：</p>
<ul>
<li>SQLyog</li>
<li>Navicat for MySQL</li>
</ul>
</blockquote>
<h3 id="4-1-MySQL-Command-line-Client使用"><a href="#4-1-MySQL-Command-line-Client使用" class="headerlink" title="4.1 MySQL Command line Client使用"></a>4.1 MySQL Command line Client使用</h3><ul>
<li><p>打开<code>MySQL Command line Client</code>: 开始菜单 — MySQL — MySQL 8.0 Command line Client</p>
</li>
<li><p>连接MySQL : <code>输入密码</code>即可   （如果密码错误或者mysql服务没有启动，窗口会闪退）</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111455.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111455.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
<li><p>关闭MySQL Command line Client：输入<code>exit</code>指令回车即可退出</p>
</li>
</ul>
<h3 id="4-2-可视化工具Navicat使用"><a href="#4-2-可视化工具Navicat使用" class="headerlink" title="4.2 可视化工具Navicat使用"></a>4.2 可视化工具Navicat使用</h3><h4 id="4-2-1-Navicat工具下载及安装"><a href="#4-2-1-Navicat工具下载及安装" class="headerlink" title="4.2.1 Navicat工具下载及安装"></a>4.2.1 Navicat工具下载及安装</h4><blockquote>
<p>傻瓜式安装</p>
</blockquote>
<h4 id="4-2-2-创建连接"><a href="#4-2-2-创建连接" class="headerlink" title="4.2.2 创建连接"></a>4.2.2 创建连接</h4><ul>
<li><p>打开navicat工具</p>
</li>
<li><p>创建连接：</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111503.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111503.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
</ul>
<h2 id="五、MySQL逻辑结构"><a href="#五、MySQL逻辑结构" class="headerlink" title="五、MySQL逻辑结构"></a>五、MySQL逻辑结构</h2><blockquote>
<p>MySQL可以存储数据，但是存储在MySQL中的数据需要按照特定的结果进行存储</p>
<p>学生 ——  学校</p>
<p>数据 ——  数据库</p>
</blockquote>
<h3 id="5-1-逻辑结构"><a href="#5-1-逻辑结构" class="headerlink" title="5.1 逻辑结构"></a>5.1 逻辑结构</h3><p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111510.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111510.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="5-2-记录-x2F-元组"><a href="#5-2-记录-x2F-元组" class="headerlink" title="5.2 记录&#x2F;元组"></a>5.2 记录&#x2F;元组</h3><p><strong><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111517.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111517.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></strong></p>
<h2 id="六、SQL-结构化查询语言"><a href="#六、SQL-结构化查询语言" class="headerlink" title="六、SQL 结构化查询语言"></a>六、SQL 结构化查询语言</h2><h3 id="6-1-SQL概述"><a href="#6-1-SQL概述" class="headerlink" title="6.1 SQL概述"></a>6.1 SQL概述</h3><blockquote>
<p>SQL（Structured Query Language）结构化查询语言，用于存取、查询、更新数据以及管理关系型数据库系统</p>
</blockquote>
<h4 id="6-1-1-SQL发展"><a href="#6-1-1-SQL发展" class="headerlink" title="6.1.1 SQL发展"></a>6.1.1 SQL发展</h4><ul>
<li>SQL是在1981年由IBM公司推出，一经推出基于其简洁的语法在数据库中得到了广泛的应用，成为主流数据库的通用规范</li>
<li>SQL由ANSI组织确定规范</li>
<li>在不同的数据库产品中遵守SQL的通用规范，但是也对SQL有一些不同的改进，形成了一些数据库的专有指令<ul>
<li>MySQL:  limit</li>
<li>SQLServer ： top</li>
<li>Oracle：rownum</li>
</ul>
</li>
</ul>
<h4 id="6-1-2-SQL分类"><a href="#6-1-2-SQL分类" class="headerlink" title="6.1.2 SQL分类"></a>6.1.2 SQL分类</h4><blockquote>
<p>根据SQL指令完成的数据库操作的不同，可以将SQL指令分为四类：</p>
</blockquote>
<ul>
<li>**DDL Data Definition Language  数据定义语言 **<ul>
<li>用于完成对数据库对象（数据库、数据表、视图、索引等）的创建、删除、修改</li>
</ul>
</li>
<li><strong>DMLData Manipulation Language  数据操作&#x2F;操纵语言</strong> <ul>
<li>用于完成对数据表中的数据的添加、删除、修改操作</li>
<li>添加：将数据存储到数据表</li>
<li>删除：将数据从数据表移除</li>
<li>修改：对数据表中的数据进行修改</li>
</ul>
</li>
<li><strong>DQL Data Query Language  数据查询语言</strong><ul>
<li>用于将数据表中的数据查询出来</li>
</ul>
</li>
<li><strong>DCL Data Control Language  数据控制语言</strong><ul>
<li>用于完成事务管理等控制性操作</li>
</ul>
</li>
</ul>
<h3 id="6-2-SQL基本语法"><a href="#6-2-SQL基本语法" class="headerlink" title="6.2 SQL基本语法"></a>6.2 SQL基本语法</h3><blockquote>
<p>在MySQL Command Line Client 或者navicat等工具中都可以编写SQL指令</p>
</blockquote>
<ul>
<li>SQL指令不区分大小写</li>
<li>每条SQL表达式结束之后都以<code>;</code>结束</li>
<li>SQL关键字之间以<code>空格</code>进行分隔</li>
<li>SQL之间可以不限制换行（可以有空格的地方就可以有换行）</li>
</ul>
<h3 id="6-3-DDL-数据定义语言"><a href="#6-3-DDL-数据定义语言" class="headerlink" title="6.3 DDL 数据定义语言"></a>6.3 DDL 数据定义语言</h3><h4 id="6-3-1-DDL-数据库操作"><a href="#6-3-1-DDL-数据库操作" class="headerlink" title="6.3.1 DDL-数据库操作"></a>6.3.1 DDL-数据库操作</h4><blockquote>
<p>使用DDL语句可以创建数据库、查询数据库、修改数据库、删除数据库</p>
</blockquote>
<p><strong>查询数据库</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 显示当前mysql中的数据库列表</span><br><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line"></span><br><span class="line">## 显示指定名称的数据的创建的<span class="keyword">SQL</span>指令</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> database <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>创建数据库</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">## 创建数据库  dbName表示创建的数据库名称，可以自定义</span><br><span class="line"><span class="keyword">create</span> database <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 创建数据库，当指定名称的数据库不存在时执行创建</span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 在创建数据库的同时指定数据库的字符集（字符集：数据存储在数据库中采用的编码格式 utf8  gbk）</span><br><span class="line"><span class="keyword">create</span> database <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span> <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br></pre></td></tr></table></figure>

<p><strong>修改数据库</strong> 修改数据库字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## 修改数据库的字符集</span><br><span class="line"><span class="keyword">alter</span> database <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span> <span class="type">character</span> <span class="keyword">set</span> utf8;  # utf8  gbk</span><br></pre></td></tr></table></figure>

<p><strong>删除数据库</strong> 删除数据库时会删除当前数据库中所有的数据表以及数据表中的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 删除数据库</span><br><span class="line"><span class="keyword">drop</span> database <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 如果数据库存在则删除数据库</span><br><span class="line"><span class="keyword">drop</span> database <span class="keyword">is</span> <span class="keyword">exists</span> <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>使用&#x2F;切换数据库</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use <span class="operator">&lt;</span>dbName<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="6-3-2-DDL-数据表操作"><a href="#6-3-2-DDL-数据表操作" class="headerlink" title="6.3.2 DDL-数据表操作"></a>6.3.2 DDL-数据表操作</h4><p><strong>创建数据表</strong></p>
<blockquote>
<p>数据表实际就是一个二维的表格，一个表格是由多列组成，表格中的每一类称之为表格的一个字段</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111527.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111527.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">   stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span>,</span><br><span class="line">   stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   stu_tel <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span>,</span><br><span class="line">   stu_qq <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>查询数据表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables;</span><br></pre></td></tr></table></figure>

<p><strong>查询表结构</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>删除数据表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 删除数据表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 当数据表存在时删除数据表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if  <span class="keyword">exists</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>修改数据表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">## 修改表名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> rename <span class="keyword">to</span> <span class="operator">&lt;</span>newTableName<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 数据表也是有字符集的，默认字符集和数据库一致</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line"></span><br><span class="line">## 添加列（字段）</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> <span class="keyword">add</span> <span class="operator">&lt;</span>columnName<span class="operator">&gt;</span> <span class="type">varchar</span>(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">## 修改列（字段）的列表和类型</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> change <span class="operator">&lt;</span>oldColumnName<span class="operator">&gt;</span> <span class="operator">&lt;</span>newCloumnName<span class="operator">&gt;</span> <span class="operator">&lt;</span>type<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 只修改列（字段）类型</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> modify <span class="operator">&lt;</span>columnName<span class="operator">&gt;</span> <span class="operator">&lt;</span>newType<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">## 删除列（字段）</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stus <span class="keyword">drop</span> <span class="operator">&lt;</span>columnName<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-4-MySQL数据类型"><a href="#6-4-MySQL数据类型" class="headerlink" title="6.4 MySQL数据类型"></a>6.4 MySQL数据类型</h3><blockquote>
<p>数据类型，指的是数据表中的列中支持存放的数据的类型</p>
</blockquote>
<h4 id="6-4-1-数值类型"><a href="#6-4-1-数值类型" class="headerlink" title="6.4.1 数值类型"></a>6.4.1 数值类型</h4><p>在mysql中有多种数据类型可以存放数值，不同的类型存放的数值的范围或者形式是不同的</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>内存空间大小</th>
<th>范围</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>tinyint</td>
<td>1byte</td>
<td>有符号   -128<del>127<br>无符号  0</del>255</td>
<td>特小型整数（年龄）</td>
</tr>
<tr>
<td>smallint</td>
<td>2byte  （16bit）</td>
<td>有符号   -32768 ~ 32767<br/>无符号  0~65535</td>
<td>小型整数</td>
</tr>
<tr>
<td>mediumint</td>
<td>3byte</td>
<td>有符号   -2^31 ~ 2^31 - 1<br/>无符号  0~2^32-1</td>
<td>中型整数</td>
</tr>
<tr>
<td><strong><code>int/integer</code></strong></td>
<td>4byte</td>
<td></td>
<td>整数</td>
</tr>
<tr>
<td><strong>bigint</strong></td>
<td>8byte</td>
<td></td>
<td>大型整数</td>
</tr>
<tr>
<td>float</td>
<td>4byte</td>
<td></td>
<td>单精度</td>
</tr>
<tr>
<td><strong>double</strong></td>
<td>8byte</td>
<td></td>
<td>双精度</td>
</tr>
<tr>
<td>decimal</td>
<td>第一参数+2</td>
<td></td>
<td>decimal(10,2)<br/>表示数值一共有10位<br>小数位有2位</td>
</tr>
</tbody></table>
<h4 id="6-4-2-字符串类型"><a href="#6-4-2-字符串类型" class="headerlink" title="6.4.2 字符串类型"></a>6.4.2 字符串类型</h4><blockquote>
<p>存储字符序列的类型</p>
</blockquote>
<table>
<thead>
<tr>
<th>类型</th>
<th>字符长度</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>char</code></td>
<td>0~255 字节</td>
<td>定长字符串，最多可以存储255个字符 ;当我们指定数据表字段为char(n)<br>此列中的数据最长为n个字符，如果添加的数据少于n，则补’\u0000’至n长度</td>
</tr>
<tr>
<td><code>varchar</code></td>
<td>0~65536 字节</td>
<td>可变长度字符串，此类型的类最大长度为65535</td>
</tr>
<tr>
<td>tinyblob</td>
<td>0~255 字节</td>
<td>存储二进制字符串</td>
</tr>
<tr>
<td>blob</td>
<td>0~65535</td>
<td>存储二进制字符串</td>
</tr>
<tr>
<td>mediumblob</td>
<td>0~1677215</td>
<td>存储二进制字符串</td>
</tr>
<tr>
<td>longblob</td>
<td>0~4294967295</td>
<td>存储二进制字符串</td>
</tr>
<tr>
<td>tinytext</td>
<td>0~255</td>
<td>文本数据（字符串）</td>
</tr>
<tr>
<td>text</td>
<td>0~65535</td>
<td>文本数据（字符串）</td>
</tr>
<tr>
<td>mediumtext</td>
<td>0~1677215</td>
<td>文本数据（字符串）</td>
</tr>
<tr>
<td><code>longtext</code></td>
<td>0~4294967295</td>
<td>文本数据（字符串）</td>
</tr>
</tbody></table>
<h4 id="6-4-3-日期类型"><a href="#6-4-3-日期类型" class="headerlink" title="6.4.3 日期类型"></a>6.4.3 日期类型</h4><blockquote>
<p>在MySQL数据库中，我们可以使用字符串来存储时间，但是如果我们需要基于时间字段进行查询操作（查询在某个时间段内的数据）就不便于查询实现</p>
</blockquote>
<table>
<thead>
<tr>
<th>类型</th>
<th>格式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>date</code></td>
<td>2021-09-13</td>
<td>日期，只存储年月日</td>
</tr>
<tr>
<td>time</td>
<td>11:12:13</td>
<td>时间，只存储时分秒</td>
</tr>
<tr>
<td>year</td>
<td>2021</td>
<td>年份</td>
</tr>
<tr>
<td><code>datetime</code></td>
<td>2021-09-13 11:12:13</td>
<td>日期+时间，存储年月日时分秒</td>
</tr>
<tr>
<td>timestamp</td>
<td>20210913 111213</td>
<td>日期+时间 （时间戳）</td>
</tr>
</tbody></table>
<h3 id="6-5-字段约束"><a href="#6-5-字段约束" class="headerlink" title="6.5 字段约束"></a>6.5 字段约束</h3><h4 id="6-5-1-约束介绍"><a href="#6-5-1-约束介绍" class="headerlink" title="6.5.1 约束介绍"></a>6.5.1 约束介绍</h4><blockquote>
<p>在创建数据表的时候，指定的对数据表的列的数据限制性的要求（对表的列中的数据进行限制）</p>
</blockquote>
<p>为什么要给表中的列添加约束呢？</p>
<ul>
<li>保证数据的有效性</li>
<li>保证数据的完整性</li>
<li>保证数据的正确性</li>
</ul>
<p>字段常见的约束有哪些呢？</p>
<ul>
<li><p>非空约束（not null）：限制此列的值必须提供，不能为null </p>
</li>
<li><p>唯一约束（unique）：在表中的多条数据，此列的值不能重复</p>
</li>
<li><p>主键约束（primary key）：非空+唯一，能够唯一标识数据表中的一条数据</p>
</li>
<li><p>外键约束（foreign key）：建立不同表之间的关联关系</p>
</li>
</ul>
<h4 id="6-5-2-非空约束"><a href="#6-5-2-非空约束" class="headerlink" title="6.5.2 非空约束"></a>6.5.2 非空约束</h4><blockquote>
<p>限制数据表中此列的值必须提供</p>
</blockquote>
<ul>
<li><p>创建表：设置图书表的 book_name  not null</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> books(</span><br><span class="line">  book_isbn <span class="type">char</span>(<span class="number">4</span>),</span><br><span class="line">  book_name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  book_author <span class="type">varchar</span>(<span class="number">6</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加数据：</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111538.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111538.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
</ul>
<h4 id="6-5-3-唯一约束"><a href="#6-5-3-唯一约束" class="headerlink" title="6.5.3 唯一约束"></a>6.5.3 唯一约束</h4><blockquote>
<p>在表中的多条数据，此列的值不能重复</p>
</blockquote>
<ul>
<li><p>创建表：设置图书表的book_isbn为 unique</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> books(</span><br><span class="line">  book_isbn <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">unique</span>,</span><br><span class="line">  book_name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  book_author <span class="type">varchar</span>(<span class="number">6</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加数据：</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111548.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111548.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
</ul>
<h4 id="6-5-4-主键约束"><a href="#6-5-4-主键约束" class="headerlink" title="6.5.4 主键约束"></a>6.5.4 主键约束</h4><blockquote>
<p>主键——就是数据表中记录的唯一标识，在一张表中只能有一个主键（主键可以是一个列，也可以是多个列的组合）</p>
<p>当一个字段声明为主键之后，添加数据时：</p>
<ul>
<li>此字段数据不能为null</li>
<li>此字段数据不能重复</li>
</ul>
</blockquote>
<p><strong>创建表时添加主键约束</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> books(</span><br><span class="line">  book_isbn <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">primary</span> key,</span><br><span class="line">  book_name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  book_author <span class="type">varchar</span>(<span class="number">6</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> books(</span><br><span class="line">  book_isbn <span class="type">char</span>(<span class="number">4</span>),</span><br><span class="line">  book_name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  book_author <span class="type">varchar</span>(<span class="number">6</span>),</span><br><span class="line">  <span class="keyword">primary</span> key(book_isbn)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>删除数据表主键约束</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> books <span class="keyword">drop</span> <span class="keyword">primary</span> key;</span><br></pre></td></tr></table></figure>

<p><strong>创建表之后添加主键约束</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">## 创建表时没有添加主键约束</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> books(</span><br><span class="line">  book_isbn <span class="type">char</span>(<span class="number">4</span>),</span><br><span class="line">  book_name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  book_author <span class="type">varchar</span>(<span class="number">6</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">## 创建表之后添加主键约束</span><br><span class="line"> <span class="keyword">alter</span> <span class="keyword">table</span> books modify book_isbn <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">primary</span> key;</span><br></pre></td></tr></table></figure>



<h4 id="6-5-5-主键自动增长"><a href="#6-5-5-主键自动增长" class="headerlink" title="6.5.5 主键自动增长"></a>6.5.5 主键自动增长</h4><blockquote>
<p>在我们创建一张数据表时，如果数据表中有列可以作为主键（例如：学生表的学号、图书表的isbn）我们可以直接这是这个列为主键；</p>
<p>当有些数据表中没有合适的列作为主键时，我们可以额外定义一个与记录本身无关的列（ID）作为主键，此列数据无具体的含义主要用于标识一条记录，在mysql中我们可以将此列定义为int，同时设置为<code>自动增长</code>，当我们向数据表中新增一条记录时，无需提供ID列的值，它会自动生成。</p>
</blockquote>
<p><strong>定义主键自动增长</strong></p>
<ul>
<li>定义int类型字段自动增长：<code>auto_increment</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> types(</span><br><span class="line">   type_id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">   type_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   type_remark <span class="type">varchar</span>(<span class="number">100</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>注意：自动增长从1开始，每添加一条记录，自动的增长的列会自定+1，当我们把某条记录删除之后再添加数据，自动增长的数据也不会重复生成（自动增长只保证唯一性、不保证连续性）</p>
<h4 id="6-5-6-联合主键"><a href="#6-5-6-联合主键" class="headerlink" title="6.5.6 联合主键"></a>6.5.6 联合主键</h4><blockquote>
<p>联合组件——将数据表中的多列组合在一起设置为表的主键</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111557.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111557.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong>定义联合主键</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> grades(</span><br><span class="line">    stu_num <span class="type">char</span>(<span class="number">8</span>),</span><br><span class="line">    course_id <span class="type">int</span>,</span><br><span class="line">    score <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">primary</span> key(stu_num,course_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>注意：在实际企业项目的数据库设计中，联合主键使用频率并不高；当一个张数据表中没有明确的字段可以作为主键时，我们可以额外添加一个ID字段作为主键。</p>
<h4 id="6-5-7-外键约束"><a href="#6-5-7-外键约束" class="headerlink" title="6.5.7 外键约束"></a>6.5.7 外键约束</h4><p>在多表关联部分讲解</p>
<h3 id="6-6-DML-数据操纵语言"><a href="#6-6-DML-数据操纵语言" class="headerlink" title="6.6 DML 数据操纵语言"></a>6.6 DML 数据操纵语言</h3><blockquote>
<p>用于完成对数据表中数据的插入、删除、修改操作</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">   stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">   stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   stu_tel <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span>,</span><br><span class="line">   stu_qq <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h4 id="6-6-1-插入数据"><a href="#6-6-1-插入数据" class="headerlink" title="6.6.1 插入数据"></a>6.6.1 插入数据</h4><p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span>(columnName,columnName....) <span class="keyword">values</span>(value1,value2....);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">## 向数据表中指定的列添加数据（不允许为空的列必须提供数据）</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus(stu_num,stu_name,stu_gender,stu_age,stu_tel) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210101&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;13030303300&#x27;</span>);</span><br><span class="line"></span><br><span class="line">## 数据表名后的字段名列表顺序可以不与表中一致，但是<span class="keyword">values</span>中值的顺序必须与表名后字段名顺序对应</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus(stu_num,stu_name,stu_age,stu_tel,stu_gender)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210103&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;13030303302&#x27;</span>,<span class="string">&#x27;女&#x27;</span>);</span><br><span class="line"></span><br><span class="line">## 当要向表中的所有列添加数据时，数据表名后面的字段列表可以省略，但是<span class="keyword">values</span>中的值的顺序要与数据表定义的字段保持一致; </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus <span class="keyword">values</span>(<span class="string">&#x27;20210105&#x27;</span>,<span class="string">&#x27;孙琦&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;13030303304&#x27;</span>,<span class="string">&#x27;666666&#x27;</span>);</span><br><span class="line">## 不过在项目开发中，即使要向所有列添加数据,也建议将列名的列表显式写出来(增强<span class="keyword">SQL</span>的稳定性)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus(stu_num,stu_name,stu_gender,stu_age,stu_tel,stu_qq) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210105&#x27;</span>,<span class="string">&#x27;孙琦&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;13030303304&#x27;</span>,<span class="string">&#x27;666666&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h4 id="6-6-2-删除数据"><a href="#6-6-2-删除数据" class="headerlink" title="6.6.2 删除数据"></a>6.6.2 删除数据</h4><blockquote>
<p>从数据表中删除满足特定条件（所有）的记录</p>
</blockquote>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> [<span class="keyword">where</span> conditions];</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">## 删除学号为<span class="number">20210102</span>的学生信息</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_num<span class="operator">=</span><span class="string">&#x27;20210102&#x27;</span>;</span><br><span class="line"></span><br><span class="line">## 删除年龄大于<span class="number">20</span>岁的学生信息(如果满足<span class="keyword">where</span>子句的记录有多条，则删除多条记录)</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&gt;</span><span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">## 如果删除语句没有<span class="keyword">where</span>子句，则表示删除当前数据表中的所有记录(敏感操作)</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> stus;</span><br></pre></td></tr></table></figure>



<h4 id="6-6-3-修改数据"><a href="#6-6-3-修改数据" class="headerlink" title="6.6.3 修改数据"></a>6.6.3 修改数据</h4><blockquote>
<p>对数据表中已经添加的记录进行修改</p>
</blockquote>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> <span class="keyword">set</span> columnName<span class="operator">=</span><span class="keyword">value</span> [<span class="keyword">where</span> conditions]</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## 将学号为<span class="number">20210105</span>的学生姓名修改为“孙七”（只修改一列）</span><br><span class="line"><span class="keyword">update</span> stus <span class="keyword">set</span> stu_name<span class="operator">=</span><span class="string">&#x27;孙七&#x27;</span> <span class="keyword">where</span> stu_num<span class="operator">=</span><span class="string">&#x27;20210105&#x27;</span>;</span><br><span class="line"></span><br><span class="line">## 将学号为<span class="number">20210103</span>的学生  性别修改为“男”,同时将QQ修改为 <span class="number">777777</span>（修改多列）</span><br><span class="line"><span class="keyword">update</span> stus <span class="keyword">set</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>,stu_qq<span class="operator">=</span><span class="string">&#x27;777777&#x27;</span> <span class="keyword">where</span> stu_num<span class="operator">=</span><span class="string">&#x27;20210103&#x27;</span>;</span><br><span class="line"></span><br><span class="line">## 根据主键修改其他所有列</span><br><span class="line"> <span class="keyword">update</span> stus <span class="keyword">set</span> stu_name<span class="operator">=</span><span class="string">&#x27;韩梅梅&#x27;</span>,stu_gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>,stu_age<span class="operator">=</span><span class="number">18</span>,stu_tel<span class="operator">=</span><span class="string">&#x27;13131313311&#x27;</span> ,stu_qq<span class="operator">=</span><span class="string">&#x27;999999&#x27;</span> <span class="keyword">where</span> stu_num<span class="operator">=</span><span class="string">&#x27;20210102&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">## 如果<span class="keyword">update</span>语句没有<span class="keyword">where</span>子句，则表示修改当前表中所有行（记录）</span><br><span class="line"><span class="keyword">update</span> stus <span class="keyword">set</span> stu_name<span class="operator">=</span><span class="string">&#x27;Tom&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="6-7-DQL-数据查询语言"><a href="#6-7-DQL-数据查询语言" class="headerlink" title="6.7 DQL 数据查询语言"></a>6.7 DQL 数据查询语言</h3><blockquote>
<p>从数据表中提取满足特定条件的记录</p>
<ul>
<li>单表查询</li>
<li>多表联合查询</li>
</ul>
</blockquote>
<h4 id="6-7-1-查询基础语法"><a href="#6-7-1-查询基础语法" class="headerlink" title="6.7.1 查询基础语法"></a>6.7.1 查询基础语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## <span class="keyword">select</span> 关键字后指定要显示查询到的记录的哪些列</span><br><span class="line"><span class="keyword">select</span> colnumName1[,colnumName2,colnumName3...] <span class="keyword">from</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> [<span class="keyword">where</span> conditions];</span><br><span class="line"></span><br><span class="line">## 如果要显示查询到的记录的所有列，则可以使用 <span class="operator">*</span> 替代字段名列表  （在项目开发中不建议使用<span class="operator">*</span>）</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus;</span><br></pre></td></tr></table></figure>

<h4 id="6-7-2-where-子句"><a href="#6-7-2-where-子句" class="headerlink" title="6.7.2 where 子句"></a>6.7.2 where 子句</h4><blockquote>
<p>在删除、修改及查询的语句后都可以添加where子句（条件），用于筛选满足特定的添加的数据进行删除、修改和查询操作。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tableName <span class="keyword">where</span> conditions;</span><br><span class="line"><span class="keyword">update</span> tabeName <span class="keyword">set</span> ... <span class="keyword">where</span> conditions;</span><br><span class="line"><span class="keyword">select</span> .... <span class="keyword">from</span> tableName <span class="keyword">where</span> conditions;</span><br></pre></td></tr></table></figure>

<p><strong>条件关系运算符</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">##   <span class="operator">=</span>  等于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_num <span class="operator">=</span> <span class="string">&#x27;20210101&#x27;</span>;</span><br><span class="line"></span><br><span class="line">##   <span class="operator">!=</span>  <span class="operator">&lt;&gt;</span>  不等于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_num <span class="operator">!=</span> <span class="string">&#x27;20210101&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_num <span class="operator">&lt;&gt;</span> <span class="string">&#x27;20210101&#x27;</span>;</span><br><span class="line"></span><br><span class="line">## <span class="operator">&gt;</span>  大于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&gt;</span><span class="number">18</span>;</span><br><span class="line"></span><br><span class="line">## <span class="operator">&lt;</span>  小于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&lt;</span><span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">## <span class="operator">&gt;=</span> 大于等于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&gt;=</span><span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">## <span class="operator">&lt;=</span> 小于等于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&lt;=</span><span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">## <span class="keyword">between</span> <span class="keyword">and</span> 区间查询      <span class="keyword">between</span> v1 <span class="keyword">and</span> v2     [v1,v2]</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p><strong>条件逻辑运算符</strong></p>
<blockquote>
<p>在where子句中，可以将多个条件通过逻辑预算(and  or   not )进行连接，通过多个条件来筛选要操作的数据。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">## <span class="keyword">and</span> 并且  筛选多个条件同时满足的记录</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span> <span class="keyword">and</span> stu_age<span class="operator">&lt;</span><span class="number">21</span>;</span><br><span class="line"></span><br><span class="line">## <span class="keyword">or</span> 或者  筛选多个条件中至少满足一个条件的记录</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span> <span class="keyword">or</span> stu_age<span class="operator">&lt;</span><span class="number">21</span>;</span><br><span class="line"></span><br><span class="line">## <span class="keyword">not</span> 取反</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age <span class="keyword">not</span> <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>



<h4 id="6-7-3-LIKE-子句"><a href="#6-7-3-LIKE-子句" class="headerlink" title="6.7.3 LIKE 子句"></a>6.7.3 LIKE 子句</h4><blockquote>
<p>在where子句的条件中，我们可以使用like关键字来实现模糊查询</p>
</blockquote>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tableName <span class="keyword">where</span> columnName <span class="keyword">like</span> <span class="string">&#x27;reg&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>在like关键字后的reg表达式中<ul>
<li><code>%</code>表示任意多个字符  【<code>%o%</code> 包含字母o】</li>
<li><code>_</code>表示任意一个字符  【<code>_o%</code> 第二个字母为o】</li>
</ul>
</li>
</ul>
<p><strong>示例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 查询学生姓名包含字母o的学生信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_name <span class="keyword">like</span> <span class="string">&#x27;%o%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 查询学生姓名第一个字为`张`的学生信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_name <span class="keyword">like</span> <span class="string">&#x27;张%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 查询学生姓名最后一个字母为o的学生信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_name <span class="keyword">like</span> <span class="string">&#x27;%o&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 查询学生姓名中第二个字母为o的学生信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_name <span class="keyword">like</span> <span class="string">&#x27;_o%&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="6-7-4-对查询结果的处理"><a href="#6-7-4-对查询结果的处理" class="headerlink" title="6.7.4 对查询结果的处理"></a>6.7.4 对查询结果的处理</h4><p><strong>设置查询的列</strong></p>
<blockquote>
<p>声明显示查询结果的指定列</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> colnumName1,columnName2,... <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&gt;</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p><strong>计算列</strong></p>
<blockquote>
<p>对从数据表中查询的记录的列进行一定的运算之后显示出来</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">## 出生年份 <span class="operator">=</span> 当前年份 <span class="operator">-</span> 年龄</span><br><span class="line"><span class="keyword">select</span> stu_name,<span class="number">2021</span><span class="operator">-</span>stu_age <span class="keyword">from</span> stus;</span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+</span></span><br><span class="line"><span class="operator">|</span> stu_name  <span class="operator">|</span> <span class="number">2021</span><span class="operator">-</span>stu_age <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+</span></span><br><span class="line"><span class="operator">|</span> omg       <span class="operator">|</span>         <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅    <span class="operator">|</span>         <span class="number">2003</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom       <span class="operator">|</span>         <span class="number">2001</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Lucy      <span class="operator">|</span>         <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Polly     <span class="operator">|</span>         <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Theo      <span class="operator">|</span>         <span class="number">2004</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+</span></span><br></pre></td></tr></table></figure>

<p><strong>as 字段取别名</strong></p>
<blockquote>
<p>我们可以为查询结果的列名 去一个语义性更强的别名   (如下案例中<code>as</code>关键字也可以省略)</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> stu_name,<span class="number">2021</span><span class="operator">-</span>stu_age <span class="keyword">as</span> stu_birth_year <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------------+</span></span><br><span class="line"><span class="operator">|</span> stu_name  <span class="operator">|</span> stu_birth_year <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------------+</span></span><br><span class="line"><span class="operator">|</span> omg       <span class="operator">|</span>           <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅    <span class="operator">|</span>           <span class="number">2003</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom       <span class="operator">|</span>           <span class="number">2001</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Lucy      <span class="operator">|</span>           <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Polly     <span class="operator">|</span>           <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Theo      <span class="operator">|</span>           <span class="number">2004</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------------+</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> stu_name <span class="keyword">as</span> 姓名,<span class="number">2021</span><span class="operator">-</span>stu_age <span class="keyword">as</span> 出生年份 <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+</span></span><br><span class="line"><span class="operator">|</span> 姓名      <span class="operator">|</span> 出生年份     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+</span></span><br><span class="line"><span class="operator">|</span> omg       <span class="operator">|</span>         <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅    <span class="operator">|</span>         <span class="number">2003</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom       <span class="operator">|</span>         <span class="number">2001</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Lucy      <span class="operator">|</span>         <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Polly     <span class="operator">|</span>         <span class="number">2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Theo      <span class="operator">|</span>         <span class="number">2004</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+</span></span><br></pre></td></tr></table></figure>

<p><strong>distinct 消除重复行</strong></p>
<blockquote>
<p>从查询的结果中将重复的记录消除 <code>distinct</code></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> stu_age <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> stu_age <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">17</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> stu_age <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> stu_age <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">17</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br></pre></td></tr></table></figure>



<h4 id="6-7-5-排序-order-by"><a href="#6-7-5-排序-order-by" class="headerlink" title="6.7.5 排序 -  order by"></a>6.7.5 排序 -  order by</h4><blockquote>
<p>将查询到的满足条件的记录按照指定的列的值升序&#x2F;降序排列</p>
</blockquote>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tableName <span class="keyword">where</span> conditions <span class="keyword">order</span> <span class="keyword">by</span> columnName <span class="keyword">asc</span><span class="operator">|</span><span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>order by columnName 表示将查询结果按照指定的列排序<ul>
<li>asc 按照指定的列升序（默认）</li>
<li>desc 按照指定的列降序</li>
</ul>
</li>
</ul>
<p><strong>实例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># 单字段排序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&gt;</span><span class="number">15</span> <span class="keyword">order</span> <span class="keyword">by</span> stu_gender <span class="keyword">desc</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------+------------+---------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name  <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> stu_tel     <span class="operator">|</span> stu_qq <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------+------------+---------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> omg       <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span> <span class="number">13030303300</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> Tom       <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span> <span class="number">13030303302</span> <span class="operator">|</span> <span class="number">777777</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210105</span> <span class="operator">|</span> Polly     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span> <span class="number">13030303304</span> <span class="operator">|</span> <span class="number">666666</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210106</span> <span class="operator">|</span> Theo      <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">17</span> <span class="operator">|</span> <span class="number">13232323322</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 韩梅梅    <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span> <span class="number">13131313311</span> <span class="operator">|</span> <span class="number">999999</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> Lucy      <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span> <span class="number">13131323334</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------+------------+---------+-------------+--------+</span></span><br><span class="line"></span><br><span class="line"># 多字段排序 ： 先满足第一个排序规则，当第一个排序的列的值相同时再按照第二个列的规则排序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus <span class="keyword">where</span> stu_age<span class="operator">&gt;</span><span class="number">15</span> <span class="keyword">order</span> <span class="keyword">by</span> stu_gender <span class="keyword">asc</span>,stu_age <span class="keyword">desc</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------+------------+---------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name  <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> stu_tel     <span class="operator">|</span> stu_qq <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------+------------+---------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> Lucy      <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span> <span class="number">13131323334</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 韩梅梅    <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span> <span class="number">13131313311</span> <span class="operator">|</span> <span class="number">999999</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> omg       <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span> <span class="number">13030303300</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210105</span> <span class="operator">|</span> Polly     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span> <span class="number">13030303304</span> <span class="operator">|</span> <span class="number">666666</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> Tom       <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span> <span class="number">13030303302</span> <span class="operator">|</span> <span class="number">777777</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210106</span> <span class="operator">|</span> Theo      <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">17</span> <span class="operator">|</span> <span class="number">13232323322</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------+------------+---------+-------------+--------+</span></span><br></pre></td></tr></table></figure>

<h4 id="6-7-6-聚合函数"><a href="#6-7-6-聚合函数" class="headerlink" title="6.7.6 聚合函数"></a>6.7.6 聚合函数</h4><blockquote>
<p>SQL中提供了一些可以对查询的记录的列进行计算的函数——聚合函数</p>
<ul>
<li>count</li>
<li>max</li>
<li>min</li>
<li>sum</li>
<li>avg</li>
</ul>
</blockquote>
<ul>
<li><p><code>count()</code> 统计函数，统计满足条件的指定字段值的个数（记录数）</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 统计学生表中学生总数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(stu_num) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">count</span>(stu_num) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="operator">|</span>              <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"></span><br><span class="line"># 统计学生表中性别为男的学生总数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(stu_num) <span class="keyword">from</span> stus <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">count</span>(stu_num) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="operator">|</span>              <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>max()</code> 计算最大值，查询满足条件的记录中指定列的最大值</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(stu_age) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">max</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(stu_age) <span class="keyword">from</span> stus <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">max</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>min()</code>  计算最小值，查询满足条件的记录中指定列的最小值</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(stu_age) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">min</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(stu_age) <span class="keyword">from</span> stus  <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">min</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">18</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>sum()</code> 计算和，查询满足条件的记录中  指定的列的值的总和</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 计算所有学生年龄的综合</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(stu_age) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">sum</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>          <span class="number">133</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"></span><br><span class="line"># 计算所有性别为男的学生的年龄的综合</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(stu_age) <span class="keyword">from</span> stus  <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">sum</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">94</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>avg()</code> 求平均值，查询满足条件的记录中 计算指定列的平均值</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(stu_age) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">avg</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">19.0000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(stu_age) <span class="keyword">from</span> stus <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">avg</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">18.8000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="6-7-7-日期函数-和-字符串函数"><a href="#6-7-7-日期函数-和-字符串函数" class="headerlink" title="6.7.7 日期函数 和 字符串函数"></a>6.7.7 日期函数 和 字符串函数</h4><p><strong>日期函数</strong> </p>
<blockquote>
<p>当我们向日期类型的列添加数据时，可以通过字符串类型赋值（字符串的格式必须为 yyyy-MM-dd hh:mm:ss）</p>
<p>如果我们想要获取当前系统时间添加到日期类型的列，可以使用<code>now()</code> 或者 <code>sysdate()</code></p>
</blockquote>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field         <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> stu_num       <span class="operator">|</span> <span class="type">char</span>(<span class="number">8</span>)     <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_name      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">20</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_gender    <span class="operator">|</span> <span class="type">char</span>(<span class="number">2</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_age       <span class="operator">|</span> <span class="type">int</span>         <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_tel       <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>)    <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_qq        <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_enterence <span class="operator">|</span> datetime    <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------------+------+-----+---------+-------+</span></span><br><span class="line"></span><br><span class="line"># 通过字符串类型 给日期类型的列赋值</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus(stu_num,stu_name,stu_gender,stu_age,stu_tel,stu_qq,stu_enterence)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20200108&#x27;</span>,<span class="string">&#x27;张小三&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;13434343344&#x27;</span>,<span class="string">&#x27;123111&#x27;</span>,<span class="string">&#x27;2021-09-01 09:00:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 通过now()获取当前时间</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus(stu_num,stu_name,stu_gender,stu_age,stu_tel,stu_qq,stu_enterence)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210109&#x27;</span>,<span class="string">&#x27;张小四&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;13434343355&#x27;</span>,<span class="string">&#x27;1233333&#x27;</span>,now());</span><br><span class="line"></span><br><span class="line"># 通过sysdate()获取当前时间</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stus(stu_num,stu_name,stu_gender,stu_age,stu_tel,stu_qq,stu_enterence)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210110&#x27;</span>,<span class="string">&#x27;李雷&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">16</span>,<span class="string">&#x27;13434343366&#x27;</span>,<span class="string">&#x27;123333344&#x27;</span>,sysdate());</span><br><span class="line"></span><br><span class="line"># 通过now和sysdate获取当前系统时间</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> now();</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> now()               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2021</span><span class="number">-09</span><span class="number">-10</span> <span class="number">16</span>:<span class="number">22</span>:<span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> sysdate();</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> sysdate()           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2021</span><span class="number">-09</span><span class="number">-10</span> <span class="number">16</span>:<span class="number">22</span>:<span class="number">26</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br></pre></td></tr></table></figure>

<p><strong>字符串函数</strong></p>
<blockquote>
<p>就是通过SQL指令对字符串进行处理</p>
</blockquote>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># concat(colnum1,colunm2,...) 拼接多列</span><br><span class="line"><span class="keyword">select</span> concat(stu_name,<span class="string">&#x27;-&#x27;</span>,stu_gender) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> concat(stu_name,<span class="string">&#x27;-&#x27;</span>,stu_gender) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅<span class="operator">-</span>女                       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom<span class="operator">-</span>男                          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Lucy<span class="operator">-</span>女                         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 林涛<span class="operator">-</span>男                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"></span><br><span class="line"># <span class="built_in">upper</span>(<span class="keyword">column</span>) 将字段的值转换成大写</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">upper</span>(stu_name) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">upper</span>(stu_name) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TOM             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> LUCY            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> POLLY           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> THEO            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 林涛            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"></span><br><span class="line"># <span class="built_in">lower</span>(<span class="keyword">column</span>) 将指定列的值转换成小写</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">lower</span>(stu_name) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">lower</span>(stu_name) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> tom             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> lucy            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> polly           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> theo            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"></span><br><span class="line"># <span class="built_in">substring</span>(<span class="keyword">column</span>,<span class="keyword">start</span>,len) 从指定列中截取部分显示 <span class="keyword">start</span>从<span class="number">1</span>开始</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> stu_name,<span class="built_in">substring</span>(stu_tel,<span class="number">8</span>,<span class="number">4</span>) <span class="keyword">from</span> stus;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------------------+</span></span><br><span class="line"><span class="operator">|</span> stu_name  <span class="operator">|</span> <span class="built_in">substring</span>(stu_tel,<span class="number">8</span>,<span class="number">4</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------------------+</span></span><br><span class="line"><span class="operator">|</span> 韩梅梅    <span class="operator">|</span> <span class="number">3311</span>                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom       <span class="operator">|</span> <span class="number">3302</span>                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Lucy      <span class="operator">|</span> <span class="number">3334</span>                   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------------------+</span></span><br></pre></td></tr></table></figure>



<h4 id="6-7-8-分组查询-group-by"><a href="#6-7-8-分组查询-group-by" class="headerlink" title="6.7.8 分组查询 - group by"></a>6.7.8 分组查询 - group by</h4><blockquote>
<p>分组——就是将数据表中的记录按照指定的类进行分组</p>
</blockquote>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 分组字段<span class="operator">/</span>聚合函数 </span><br><span class="line"><span class="keyword">from</span> 表名 </span><br><span class="line">[<span class="keyword">where</span> 条件] </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 分组列名 [<span class="keyword">having</span> 条件]</span><br><span class="line">[<span class="keyword">order</span> <span class="keyword">by</span> 排序字段]</span><br></pre></td></tr></table></figure>

<ul>
<li><code>select</code> 后使用<code>* </code>显示对查询的结果进行分组之后，显示每组的第一条记录（这种显示通常是无意义的）</li>
<li><code>select</code>后通常显示分组字段和聚合函数(对分组后的数据进行统计、求和、平均值等)</li>
<li>语句执行属性： 1️⃣先根据where条件从数据库查询记录 2️⃣group by对查询记录进行分组 3️⃣执行having对分组后的数据进行筛选</li>
</ul>
<p><strong>示例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"># 先对查询的学生信息按性别进行分组（分成了男、女两组），然后再分别统计每组学生的个数</span><br><span class="line"><span class="keyword">select</span> stu_gender,<span class="built_in">count</span>(stu_num) <span class="keyword">from</span> stus <span class="keyword">group</span> <span class="keyword">by</span> stu_gender;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------------+</span></span><br><span class="line"><span class="operator">|</span> stu_gender <span class="operator">|</span> <span class="built_in">count</span>(stu_num) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------------+</span></span><br><span class="line"><span class="operator">|</span> 女         <span class="operator">|</span>              <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 男         <span class="operator">|</span>              <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------------+</span></span><br><span class="line"></span><br><span class="line"># 先对查询的学生信息按性别进行分组（分成了男、女两组），然后再计算每组的平均年龄</span><br><span class="line"><span class="keyword">select</span> stu_gender,<span class="built_in">avg</span>(stu_age) <span class="keyword">from</span> stus <span class="keyword">group</span> <span class="keyword">by</span> stu_gender;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> stu_gender <span class="operator">|</span> <span class="built_in">avg</span>(stu_age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">19.7500</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18.2000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 先对学生按年龄进行分组（分了<span class="number">16</span>、<span class="number">17</span>、<span class="number">18</span>、<span class="number">20</span>、<span class="number">21</span>、<span class="number">22</span>六组），然后统计各组的学生数量，还可以对最终的结果排序</span><br><span class="line"><span class="keyword">select</span> stu_age,<span class="built_in">count</span>(stu_num) <span class="keyword">from</span> stus <span class="keyword">group</span> <span class="keyword">by</span> stu_age <span class="keyword">order</span> <span class="keyword">by</span> stu_age;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> stu_age <span class="operator">|</span> <span class="built_in">count</span>(stu_num) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">16</span> <span class="operator">|</span>              <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">17</span> <span class="operator">|</span>              <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>              <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span>              <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span>              <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span>              <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"></span><br><span class="line"># 查询所有学生，按年龄进行分组，然后分别统计每组的人数，再筛选当前组人数<span class="operator">&gt;</span><span class="number">1</span>的组，再按年龄升序显示出来</span><br><span class="line"><span class="keyword">select</span> stu_age,<span class="built_in">count</span>(stu_num) </span><br><span class="line"><span class="keyword">from</span> stus </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> stu_age </span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(stu_num)<span class="operator">&gt;</span><span class="number">1</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> stu_age;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> stu_age <span class="operator">|</span> <span class="built_in">count</span>(stu_num) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">16</span> <span class="operator">|</span>              <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span>              <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"></span><br><span class="line"># 查询性别为<span class="string">&#x27;男&#x27;</span>的学生，按年龄进行分组，然后分别统计每组的人数，再筛选当前组人数<span class="operator">&gt;</span><span class="number">1</span>的组，再按年龄升序显示出来</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> stu_age,<span class="built_in">count</span>(stu_num)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">from</span> stus</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">group</span> <span class="keyword">by</span> stu_age</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">having</span> <span class="built_in">count</span>(stu_num)<span class="operator">&gt;</span><span class="number">1</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">order</span> <span class="keyword">by</span> stu_age;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> stu_age <span class="operator">|</span> <span class="built_in">count</span>(stu_num) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">16</span> <span class="operator">|</span>              <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span>              <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------------+</span></span><br></pre></td></tr></table></figure>



<h4 id="6-7-9-分页查询-limit"><a href="#6-7-9-分页查询-limit" class="headerlink" title="6.7.9 分页查询 - limit"></a>6.7.9 分页查询 - limit</h4><blockquote>
<p>当数据表中的记录比较多的时候，如果一次性全部查询出来显示给用户，用户的可读性&#x2F;体验性就不太好，因此我们可以将这些数据分页进行展示。</p>
</blockquote>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... </span><br><span class="line"><span class="keyword">from</span> ...  </span><br><span class="line"><span class="keyword">where</span> ...</span><br><span class="line">limit param1,param2</span><br></pre></td></tr></table></figure>

<ul>
<li>param1  int , 表示获取查询语句的结果中的第一条数据的索引（索引从0开始）</li>
<li>param2  int, 表示获取的查询记录的条数（如果剩下的数据条数&lt;param2，则返回剩下的所有记录）</li>
</ul>
<p><strong>案例</strong></p>
<p>对数据表中的学生信息进行分页显示，总共有10条数据，我们每页显示3条</p>
<blockquote>
<p>总记录数  count  10</p>
<p>每页显示  pageSize   3</p>
<p>总页数： pageCount &#x3D; count%pageSize&#x3D;&#x3D;0 ? count&#x2F;pageSize :  count&#x2F;pageSize +1; </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 查询第一页：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus [<span class="keyword">where</span> ...] limit <span class="number">0</span>,<span class="number">3</span>;         (<span class="number">1</span><span class="number">-1</span>)<span class="operator">*</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"># 查询第二页：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus [<span class="keyword">where</span> ...] limit <span class="number">3</span>,<span class="number">3</span>;         (<span class="number">2</span><span class="number">-1</span>)<span class="operator">*</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"># 查询第三页：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus [<span class="keyword">where</span> ...] limit <span class="number">6</span>,<span class="number">3</span>;         (<span class="number">3</span><span class="number">-1</span>)<span class="operator">*</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"># 查询第四页：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stus [<span class="keyword">where</span> ...] limit <span class="number">9</span>,<span class="number">3</span>;         (<span class="number">4</span><span class="number">-1</span>)<span class="operator">*</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"># 如果在一张数据表中：</span><br><span class="line"># pageNum表示查询的页码</span><br><span class="line"># pageSize表示每页显示的条数</span><br><span class="line"># 通用分页语句如下：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">&lt;</span>tableName<span class="operator">&gt;</span> [<span class="keyword">where</span> ...] limit (pageNum<span class="number">-1</span>)<span class="operator">*</span>pageSize,pageSize;</span><br></pre></td></tr></table></figure>

<h2 id="七、数据表的关联关系"><a href="#七、数据表的关联关系" class="headerlink" title="七、数据表的关联关系"></a>七、数据表的关联关系</h2><h3 id="7-1-关联关系介绍"><a href="#7-1-关联关系介绍" class="headerlink" title="7.1 关联关系介绍"></a>7.1 关联关系介绍</h3><blockquote>
<p>MySQL是一个关系型数据库，不仅可以存储数据，还可以维护数据与数据之间的关系——通过在数据表中添加字段建立外键约束</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111615.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111615.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p>数据与数据之间的<code>关联关系</code>分为四种：</p>
<ul>
<li>一对一关联</li>
<li>一对多关联</li>
<li>多对一关联</li>
<li>多对多关联</li>
</ul>
<h3 id="7-2-一对一关联"><a href="#7-2-一对一关联" class="headerlink" title="7.2 一对一关联"></a>7.2 一对一关联</h3><blockquote>
<p>人 — 身份证     一个人只有一个身份证、一个身份证只对应一个人</p>
<p>学生 —  学籍      一个学生只有一个学籍、一个学籍也对应唯一的一个学生</p>
<p>用户 — 用户详情   一个用户只有一个详情、一个详情也只对应一个用户</p>
</blockquote>
<p><strong>方案1：</strong> 主键关联——两张数据表中主键相同的数据为相互对应的数据</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111621.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111621.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong>方案2：</strong>唯一外键 —— 在任意一张表中添加一个字段添加外键约束与另一张表主键关联，并且将外键列添加唯一约束</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111630.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111630.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="7-3-一对多与多对一"><a href="#7-3-一对多与多对一" class="headerlink" title="7.3 一对多与多对一"></a>7.3 一对多与多对一</h3><blockquote>
<p>班级 — 学生    （一对多）   一个班级包含多个学生</p>
<p>学生 — 班级    （多对一）  多个学生可以属于同一个班级</p>
<p>图书 — 分类              商品 —- 商品类别</p>
</blockquote>
<p><strong>方案：</strong>在多的一端添加外键 ，与一的一端主键进行关联</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111637.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111637.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="7-4-多对多关联"><a href="#7-4-多对多关联" class="headerlink" title="7.4 多对多关联"></a>7.4 多对多关联</h3><blockquote>
<p>学生 —  课程    一个学生可以选择多门课、一门课程也可以由多个学生选择</p>
<p>会员 — 社团     一个会员可以参加多个社团、一个社团也可以招纳多个会员</p>
</blockquote>
<p><strong>方法</strong>：额外创建一张关系表来维护多对多关联——在关系表中定义两个外键，分别与两个数据表的主键进行关联</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111644.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111644.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="7-5-外键约束"><a href="#7-5-外键约束" class="headerlink" title="7.5 外键约束"></a>7.5 外键约束</h3><blockquote>
<p>外键约束——将一个列添加外键约束与另一张表的主键(唯一列)进行关联之后，这个外键约束的列添加的数据必须要在关联的主键字段中存在</p>
</blockquote>
<p>案例：学生表  与  班级表   </p>
<ol>
<li><p>先创建班级表</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> classes(</span><br><span class="line">    class_id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    class_name <span class="type">varchar</span>(<span class="number">40</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span>,</span><br><span class="line">    class_remark <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建学生表（在学生表中添加外键与班级表的主键进行关联）</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 【方式一】在创建表的时候，定义cid字段，并添加外键约束</span><br><span class="line"># 由于cid 列 要与classes表的class_id进行关联，因此cid字段类型和长度要与 class_id一致</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">	stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">    stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    cid <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">constraint</span> FK_STUDENTS_CLASSES <span class="keyword">foreign</span> key(cid) <span class="keyword">references</span> classes(class_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#【方式二】先创建表，再添加外键约束</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">	stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">    stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    cid <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"># 在创建表之后，为cid添加外键约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">add</span> <span class="keyword">constraint</span> FK_STUDENTS_CLASSES <span class="keyword">foreign</span> key(cid) <span class="keyword">references</span> classes(class_id);</span><br><span class="line"></span><br><span class="line"># 删除外键约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">drop</span> <span class="keyword">foreign</span> key FK_STUDENTS_CLASSES;</span><br></pre></td></tr></table></figure>
</li>
<li><p>向班级表添加班级信息</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2104&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2105&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2106&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Python2106&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> classes;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> class_id <span class="operator">|</span> class_name <span class="operator">|</span> class_remark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">1</span> <span class="operator">|</span> Java2104   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> Java2105   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> Java2106   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> Python2106 <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>向学生表中添加学生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210102&#x27;</span>,<span class="string">&#x27;李斯&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>, <span class="number">4</span> );</span><br><span class="line"></span><br><span class="line"># 添加学生时，设置给cid外键列的值必须在其关联的主表classes的classs_id列存在</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210103&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>, <span class="number">6</span> );  </span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-6-外键约束-级联"><a href="#7-6-外键约束-级联" class="headerlink" title="7.6 外键约束-级联"></a>7.6 外键约束-级联</h3><blockquote>
<p>当学生表中存在学生信息关联班级表的某条记录时，就不能对班级表的这条记录进行修改ID和删除操作，如下：</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> classes;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> class_id <span class="operator">|</span> class_name <span class="operator">|</span> class_remark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">1</span> <span class="operator">|</span> Java2104   <span class="operator">|</span> ...          <span class="operator">|</span>    # 班级表中class_id<span class="operator">=</span><span class="number">1</span>的班级信息 被学生表中的记录关联了</span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> Java2105   <span class="operator">|</span> ...          <span class="operator">|</span>    # 我们就不能修改Java2104的class_id,并且不能删除   </span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> Java2106   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> Python2106 <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> cid  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> 张三     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 李四     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> 王五     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> 赵柳     <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> classes <span class="keyword">set</span> class_id<span class="operator">=</span><span class="number">5</span> <span class="keyword">where</span> class_name<span class="operator">=</span><span class="string">&#x27;Java2104&#x27;</span>;</span><br><span class="line"></span><br><span class="line">ERROR <span class="number">1451</span> (<span class="number">23000</span>): Cannot <span class="keyword">delete</span> <span class="keyword">or</span> <span class="keyword">update</span> a parent <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails (`db_test2`.`students`, <span class="keyword">CONSTRAINT</span> `FK_STUDENTS_CLASSES` <span class="keyword">FOREIGN</span> KEY (`cid`) <span class="keyword">REFERENCES</span> `classes` (`class_id`))</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> classes <span class="keyword">where</span> class_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">ERROR <span class="number">1451</span> (<span class="number">23000</span>): Cannot <span class="keyword">delete</span> <span class="keyword">or</span> <span class="keyword">update</span> a parent <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails (`db_test2`.`students`, <span class="keyword">CONSTRAINT</span> `FK_STUDENTS_CLASSES` <span class="keyword">FOREIGN</span> KEY (`cid`) <span class="keyword">REFERENCES</span> `classes` (`class_id`))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果一定要修改Java2104 的班级ID，该如何实现呢 ？</p>
<ul>
<li>将引用Java2104班级id的学生记录中的cid修改为 NULL</li>
<li>在修改班级信息表中Java2104记录的 class_id</li>
<li>将学生表中cid设置为NULL的记录的cid重新修改为 Java2104这个班级的新的id</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>️⃣<span class="keyword">update</span> students <span class="keyword">set</span> cid<span class="operator">=</span><span class="keyword">NULL</span> <span class="keyword">where</span> cid<span class="operator">=</span><span class="number">1</span>;  # 结果如下：</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> cid  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> 张三     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 李四     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> 王五     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> 赵柳     <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>️⃣<span class="keyword">update</span> classes <span class="keyword">set</span> class_id<span class="operator">=</span><span class="number">5</span> <span class="keyword">where</span> class_name<span class="operator">=</span><span class="string">&#x27;Java2104&#x27;</span>; # 结果如下</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> class_id <span class="operator">|</span> class_name <span class="operator">|</span> class_remark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> Java2105   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> Java2106   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> Python2106 <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">5</span> <span class="operator">|</span> Java2104   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>️⃣<span class="keyword">update</span> students <span class="keyword">set</span> cid<span class="operator">=</span><span class="number">5</span> <span class="keyword">where</span> cid <span class="keyword">IS</span> <span class="keyword">NULL</span>;  # 结果如下</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> cid  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> 张三     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 李四     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> 王五     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> 赵柳     <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br></pre></td></tr></table></figure>

<p><strong><code>我们可以使用级联操作来实现：</code></strong></p>
<ol>
<li><p>在添加外键时，设置<strong>级联修改</strong> 和 <strong>级联删除</strong></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 删除原有的外键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">drop</span> <span class="keyword">foreign</span> key FK_STUDENTS_CLASSES;</span><br><span class="line"></span><br><span class="line"># 重新添加外键，并设置级联修改和级联删除</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">add</span> <span class="keyword">constraint</span> FK_STUDENTS_CLASSES <span class="keyword">foreign</span> key(cid) <span class="keyword">references</span> classes(class_id) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试级联修改：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># 班级信息</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> class_id <span class="operator">|</span> class_name <span class="operator">|</span> class_remark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> Java2105   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> Java2106   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> Python2106 <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">5</span> <span class="operator">|</span> Java2104   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"># 学生信息</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> cid  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> 张三     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 李四     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> 王五     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> 赵柳     <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"></span><br><span class="line"># 直接修改Java2104的class_id,关联Java2104这个班级的学生记录的cid也会同步修改</span><br><span class="line"><span class="keyword">update</span> classes <span class="keyword">set</span> class_id<span class="operator">=</span><span class="number">1</span> <span class="keyword">where</span> class_name<span class="operator">=</span><span class="string">&#x27;Java2104&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 班级信息</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> class_id <span class="operator">|</span> class_name <span class="operator">|</span> class_remark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> Java2105   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> Java2106   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> Python2106 <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">1</span> <span class="operator">|</span> Java2104   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"># 学生信息</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> cid  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210101</span> <span class="operator">|</span> 张三     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210102</span> <span class="operator">|</span> 李四     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210103</span> <span class="operator">|</span> 王五     <span class="operator">|</span> 男         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> 赵柳     <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试级联删除</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 删除class_id<span class="operator">=</span><span class="number">1</span>的班级信息，学生表引用此班级信息的记录也会被同步删除</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> classes <span class="keyword">where</span> class_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> class_id <span class="operator">|</span> class_name <span class="operator">|</span> class_remark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> Java2105   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> Java2106   <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> Python2106 <span class="operator">|</span> ...          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+--------------+</span></span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_num  <span class="operator">|</span> stu_name <span class="operator">|</span> stu_gender <span class="operator">|</span> stu_age <span class="operator">|</span> cid  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20210104</span> <span class="operator">|</span> 赵柳     <span class="operator">|</span> 女         <span class="operator">|</span>      <span class="number">18</span> <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------------+---------+------+</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="八、连接查询"><a href="#八、连接查询" class="headerlink" title="八、连接查询"></a>八、连接查询</h2><blockquote>
<p>通过对DQL的学习，我们可以很轻松的从一张数据表中查询出需要的数据；在企业的应用开发中，我们经常需要从多张表中查询数据（例如：我们查询学生信息的时候需要同时查询学生的班级信息），可以通过连接查询从多张数据表提取数据:</p>
<p>在MySQL中可以使用join实现多表的联合查询——连接查询，join按照其功能不同分为三个操作：</p>
<ul>
<li><p>inner join 内连接</p>
</li>
<li><p>left join 左连接</p>
</li>
<li><p>right join 右连接</p>
</li>
</ul>
</blockquote>
<h3 id="8-1-数据准备"><a href="#8-1-数据准备" class="headerlink" title="8.1 数据准备"></a>8.1 数据准备</h3><h4 id="8-1-1-创建数据表"><a href="#8-1-1-创建数据表" class="headerlink" title="8.1.1 创建数据表"></a>8.1.1 创建数据表</h4><p>创建班级信息表 和 学生信息表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> classes(</span><br><span class="line">    class_id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    class_name <span class="type">varchar</span>(<span class="number">40</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span>,</span><br><span class="line">    class_remark <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">    stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary</span> key,</span><br><span class="line">    stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    cid <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">constraint</span> FK_STUDENTS_CLASSES <span class="keyword">foreign</span> key(cid) <span class="keyword">references</span> classes(class_id) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="8-1-2-添加数据"><a href="#8-1-2-添加数据" class="headerlink" title="8.1.2 添加数据"></a>8.1.2 添加数据</h4><p>添加班级信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Java2104 包含三个学生信息</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2104&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># Java2105 包含两个学生信息</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2105&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 以下两个班级在学生表中没有对应的学生信息</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2106&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,class_remark) <span class="keyword">values</span>(<span class="string">&#x27;Python2105&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>添加学生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 以下三个学生信息 属于 class_id<span class="operator">=</span><span class="number">1</span> 的班级 （Java2104）</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210101&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210102&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210103&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"># 以下三个学生信息 属于 class_id<span class="operator">=</span><span class="number">2</span> 的班级 （Java2105）</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210104&#x27;</span>,<span class="string">&#x27;赵柳&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid) </span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;20210105&#x27;</span>,<span class="string">&#x27;孙七&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"># 小红和小明没有设置班级信息</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;20210106&#x27;</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;20210107&#x27;</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure>



<h3 id="8-2-内连接-INNER-JOIN"><a href="#8-2-内连接-INNER-JOIN" class="headerlink" title="8.2 内连接 INNER JOIN"></a>8.2 内连接 INNER JOIN</h3><p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> tableName1 <span class="keyword">inner</span> <span class="keyword">join</span> tableName2 <span class="keyword">ON</span> 匹配条件 [<span class="keyword">where</span> 条件];</span><br></pre></td></tr></table></figure>

<h4 id="8-2-1-笛卡尔积"><a href="#8-2-1-笛卡尔积" class="headerlink" title="8.2.1 笛卡尔积"></a>8.2.1 笛卡尔积</h4><ul>
<li><p>笛卡尔积（A集合&amp;B集合）：使用A中的每个记录一次关联B中每个记录，笛卡尔积的总数&#x3D;A总数*B总数</p>
</li>
<li><p>如果直接执行<code>select ... from tableName1 inner join tableName2;</code>会获取两种数据表中的数据集合的笛卡尔积（依次使用tableName1 表中的每一条记录 去 匹配 tableName2的每条数据）</p>
</li>
</ul>
<h4 id="8-2-2-内连接条件"><a href="#8-2-2-内连接条件" class="headerlink" title="8.2.2 内连接条件"></a>8.2.2 内连接条件</h4><blockquote>
<p>两张表时用inner join连接查询之后生产的笛卡尔积数据中很多数据都是无意义的，我们如何消除无意义的数据呢？ —— 添加两张进行连接查询时的条件</p>
</blockquote>
<ul>
<li>使用 <code>on</code>设置两张表连接查询的匹配条件</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用where设置过滤条件：先生成笛卡尔积再从笛卡尔积中过滤数据（效率很低）</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">INNER</span> <span class="keyword">JOIN</span> classes <span class="keyword">where</span> students.cid <span class="operator">=</span> classes.class_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用ON设置连接查询条件：先判断连接条件是否成立，如果成立两张表的数据进行组合生成一条结果记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">INNER</span> <span class="keyword">JOIN</span> classes <span class="keyword">ON</span> students.cid <span class="operator">=</span> classes.class_id;</span><br></pre></td></tr></table></figure>

<ul>
<li>结果：只获取两种表中匹配条件成立的数据，任何一张表在另一种表如果没有找到对应匹配则不会出现在查询结果中（例如：小红和小明没有对应的班级信息，Java2106和Python2106没有对应的学生）。</li>
</ul>
<h3 id="8-2-左连接-LEFT-JOIN"><a href="#8-2-左连接-LEFT-JOIN" class="headerlink" title="8.2 左连接 LEFT JOIN"></a>8.2 左连接 LEFT JOIN</h3><blockquote>
<p>需求：请查询出所有的学生信息，如果学生有对应的班级信息，则将对应的班级信息也查询出来</p>
</blockquote>
<p>左连接：显示左表中的所有数据，如果在有右表中存在与左表记录满足匹配条件的数据，则进行匹配；如果右表中不存在匹配数据，则显示为Null</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 语法</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> leftTabel <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> rightTable <span class="keyword">ON</span> 匹配条件 [<span class="keyword">where</span> 条件];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左连接 : 显示左表中的所有记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> classes <span class="keyword">ON</span> students.cid <span class="operator">=</span> classes.class_id;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111659.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111659.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="8-3-右连接-RIGHT-JOIN"><a href="#8-3-右连接-RIGHT-JOIN" class="headerlink" title="8.3 右连接 RIGHT JOIN"></a>8.3 右连接 RIGHT JOIN</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 右连接 ：显示右表中的所有记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> classes <span class="keyword">ON</span> students.cid <span class="operator">=</span> classes.class_id;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111705.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111705.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="8-4-数据表别名"><a href="#8-4-数据表别名" class="headerlink" title="8.4 数据表别名"></a>8.4 数据表别名</h3><blockquote>
<p>如果在连接查询的多张表中存在相同名字的字段，我们可以使用<code>表名.字段名</code>来进行区分，如果表名太长则不便于SQL语句的编写，我们可以使用数据表别名</p>
</blockquote>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.<span class="operator">*</span>,c.class_name</span><br><span class="line"><span class="keyword">from</span> students s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> classes c</span><br><span class="line"><span class="keyword">ON</span> s.cid <span class="operator">=</span> c.class_id;</span><br></pre></td></tr></table></figure>



<h3 id="8-5-子查询-x2F-嵌套查询"><a href="#8-5-子查询-x2F-嵌套查询" class="headerlink" title="8.5 子查询&#x2F;嵌套查询"></a>8.5 子查询&#x2F;嵌套查询</h3><blockquote>
<p>子查询 — 先进行一次查询，第一次查询的结果作为第二次查询的源&#x2F;条件（第二次查询是基于第一次的查询结果来进行的）</p>
</blockquote>
<h4 id="8-5-1-子查询返回单个值-单行单列"><a href="#8-5-1-子查询返回单个值-单行单列" class="headerlink" title="8.5.1 子查询返回单个值-单行单列"></a>8.5.1 子查询返回单个值-单行单列</h4><p><strong>案例1：</strong><code>查询班级名称为&#39;Java2104&#39;班级中的学生信息</code>(只知道班级名称，而不知道班级ID)</p>
<ul>
<li>传统的方式：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- a.查询Java2104班的班级编号</span></span><br><span class="line"><span class="keyword">select</span> class_id <span class="keyword">from</span> classes <span class="keyword">where</span> class_name<span class="operator">=</span><span class="string">&#x27;Java2104&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b.查询此班级编号下的学生信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>子查询：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果子查询返回的结果是一个值（单列单行），条件可以直接使用关系运算符（=  != ....）</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid <span class="operator">=</span> (<span class="keyword">select</span> class_id <span class="keyword">from</span> classes <span class="keyword">where</span> class_name<span class="operator">=</span><span class="string">&#x27;Java2105&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="8-5-2-子查询返回多个值-多行单列"><a href="#8-5-2-子查询返回多个值-多行单列" class="headerlink" title="8.5.2 子查询返回多个值-多行单列"></a>8.5.2 子查询返回多个值-多行单列</h4><p><strong>案例2：</strong><code>查询所有Java班级中的学生信息</code></p>
<ul>
<li>传统的方式：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- a.查询所有Java班的班级编号</span></span><br><span class="line"><span class="keyword">select</span> class_id <span class="keyword">from</span> classes <span class="keyword">where</span> class_name <span class="keyword">LIKE</span> <span class="string">&#x27;Java%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>  class_id    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">1</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">2</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">3</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- b.查询这些班级编号中的学生信息(union 将多个查询语句的结果整合在一起)</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid<span class="operator">=</span><span class="number">2</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid<span class="operator">=</span><span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>子查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果子查询返回的结果是多个值（单列多行），条件使用IN / NOT IN</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid <span class="keyword">IN</span> (<span class="keyword">select</span> class_id <span class="keyword">from</span> classes <span class="keyword">where</span> class_name <span class="keyword">LIKE</span> <span class="string">&#x27;Java%&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="8-5-3-子查询返回多个值-多行多列"><a href="#8-5-3-子查询返回多个值-多行多列" class="headerlink" title="8.5.3 子查询返回多个值-多行多列"></a>8.5.3 子查询返回多个值-多行多列</h4><p><strong>案例3：</strong><code>查询cid=1的班级中性别为男的学生信息</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多条件查询：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 子查询:先查询cid=1班级中的所有学生信息，将这些信息作为一个整体虚拟表(多行多列)</span></span><br><span class="line"><span class="comment">--        再基于这个虚拟表查询性别为男的学生信息（‘虚拟表’需要别名）</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> cid<span class="operator">=</span><span class="number">1</span>) t <span class="keyword">where</span> t.stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h2 id="九、存储过程"><a href="#九、存储过程" class="headerlink" title="九、存储过程"></a>九、存储过程</h2><h3 id="9-1-存储过程介绍"><a href="#9-1-存储过程介绍" class="headerlink" title="9.1 存储过程介绍"></a>9.1 存储过程介绍</h3><h4 id="9-1-1-SQL指令执行过程"><a href="#9-1-1-SQL指令执行过程" class="headerlink" title="9.1.1 SQL指令执行过程"></a>9.1.1 SQL指令执行过程</h4><p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111715.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111715.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p>从SQL执行执行的流程中我们分析存在的问题：</p>
<ol>
<li><p>如果我们需要重复多次执行相同的SQL，SQL执行都需要通过连接传递到MySQL，并且需要经过编译和执行的步骤；</p>
</li>
<li><p>如果我们需要连续执行多个SQL指令，并且第二个SQL指令需要使用第一个SQL指令执行的结果作为参数；</p>
</li>
</ol>
<h4 id="9-1-2-存储过程的介绍"><a href="#9-1-2-存储过程的介绍" class="headerlink" title="9.1.2 存储过程的介绍"></a>9.1.2 存储过程的介绍</h4><blockquote>
<p>存储过程：</p>
<p>将能够完成特定功能的SQL指令进行封装（SQL指令集），编译之后存储在数据库服务器上，并且为之取一个名字，客户端可以通过名字直接调用这个SQL指令集，获取执行结果。</p>
</blockquote>
<h4 id="9-1-3-存储过程优缺点分析"><a href="#9-1-3-存储过程优缺点分析" class="headerlink" title="9.1.3 存储过程优缺点分析"></a>9.1.3 存储过程优缺点分析</h4><p><strong>存储过程优点：</strong></p>
<ol>
<li><p>SQL指令无需客户端编写，通过网络传送，可以节省网络开销，同时避免SQL指令在网络传输过程中被恶意篡改保证安全性；</p>
</li>
<li><p>存储过程经过编译创建并保存在数据库中的，执行过程无需重复的进行编译操作，对SQL指令的执行过程进行了性能提升；</p>
</li>
<li><p>存储过程中多个SQL指令之间存在逻辑关系，支持流程控制语句（分支、循环），可以实现更为复杂的业务;</p>
</li>
</ol>
<p><strong>存储过程的缺点：</strong></p>
<ol>
<li><p>存储过程是根据不同的数据库进行编译、创建并存储在数据库中；当我们需要切换到其他的数据库产品时，需要重写编写针对于新数据库的存储过程；</p>
</li>
<li><p>存储过程受限于数据库产品，如果需要高性能的优化会成为一个问题；</p>
</li>
<li><p>在互联网项目中，如果需要数据库的高（连接）并发访问，使用存储过程会增加数据库的连接执行时间（因为我们将复杂的业务交给了数据库进行处理）</p>
</li>
</ol>
<h3 id="9-2-创建存储过程"><a href="#9-2-创建存储过程" class="headerlink" title="9.2 创建存储过程"></a>9.2 创建存储过程</h3><h4 id="9-2-1-存储过程创建语法"><a href="#9-2-1-存储过程创建语法" class="headerlink" title="9.2.1 存储过程创建语法"></a>9.2.1 存储过程创建语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法:</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> <span class="operator">&lt;</span>proc_name<span class="operator">&gt;</span>([<span class="keyword">IN</span><span class="operator">/</span><span class="keyword">OUT</span> args])</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	  <span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h4 id="9-2-2-示例"><a href="#9-2-2-示例" class="headerlink" title="9.2.2 示例"></a>9.2.2 示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个存储过程实现加法运算:  Java语法中，方法是有参数和返回值的</span></span><br><span class="line"><span class="comment">--                                存储过程中，是有输入参数 和 输出参数的</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test1(<span class="keyword">IN</span> a <span class="type">int</span>,<span class="keyword">IN</span> b <span class="type">int</span>,<span class="keyword">OUT</span> c <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">SET</span> c <span class="operator">=</span> a<span class="operator">+</span>b;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>



<h3 id="9-3-调用存储过程"><a href="#9-3-调用存储过程" class="headerlink" title="9.3 调用存储过程"></a>9.3 调用存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="comment">-- 定义变量@m</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@m</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">-- 调用存储过程，将3传递给a，将2传递给b，将@m传递给c</span></span><br><span class="line"><span class="keyword">call</span> proc_test1(<span class="number">3</span>,<span class="number">2</span>,<span class="variable">@m</span>);</span><br><span class="line"><span class="comment">-- 显示变量值</span></span><br><span class="line"><span class="keyword">select</span> <span class="variable">@m</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>



<h3 id="9-4-存储过程中变量的使用"><a href="#9-4-存储过程中变量的使用" class="headerlink" title="9.4 存储过程中变量的使用"></a>9.4 存储过程中变量的使用</h3><blockquote>
<p>存储过程中的变量分为两种：局部变量 和 用户变量</p>
</blockquote>
<h4 id="9-4-1-定义局部变量"><a href="#9-4-1-定义局部变量" class="headerlink" title="9.4.1 定义局部变量"></a>9.4.1 定义局部变量</h4><p>局部变量：定义在存储过程中的变量，只能在存储过程内部使用</p>
<ul>
<li>局部变量定义语法</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 局部变量要定义在存储过程中，而且必须定义在存储过程开始</span></span><br><span class="line"><span class="keyword">declare</span> <span class="operator">&lt;</span>attr_name<span class="operator">&gt;</span> <span class="operator">&lt;</span>type<span class="operator">&gt;</span> [<span class="keyword">default</span> <span class="keyword">value</span>];</span><br></pre></td></tr></table></figure>

<ul>
<li>局部变量定义示例：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test2(<span class="keyword">IN</span> a <span class="type">int</span>,<span class="keyword">OUT</span> r <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">declare</span> x <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;  <span class="comment">-- 定义x  int类型，默认值为0</span></span><br><span class="line"> <span class="keyword">declare</span> y <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span>;  <span class="comment">-- 定义y</span></span><br><span class="line"> <span class="keyword">set</span> x <span class="operator">=</span> a<span class="operator">*</span>a;</span><br><span class="line"> <span class="keyword">set</span> y <span class="operator">=</span> a<span class="operator">/</span><span class="number">2</span>; </span><br><span class="line"> <span class="keyword">set</span> r <span class="operator">=</span> x<span class="operator">+</span>y;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h4 id="9-4-2-定义用户变量"><a href="#9-4-2-定义用户变量" class="headerlink" title="9.4.2 定义用户变量"></a>9.4.2 定义用户变量</h4><p>用户变量：相当于全局变量，定义的用户变量可以通过<code>select @attrName from dual</code>进行查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用户变量会存储在mysql数据库的数据字典中（dual）</span></span><br><span class="line"><span class="comment">-- 用户变量定义使用set关键字直接定义，变量名要以@开头</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@n</span><span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h4 id="9-4-3-给变量设置值"><a href="#9-4-3-给变量设置值" class="headerlink" title="9.4.3 给变量设置值"></a>9.4.3 给变量设置值</h4><ul>
<li>无论是局部变量还是用户变量，都是使用<code>set</code>关键字修改值</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="variable">@n</span><span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test2(<span class="number">6</span>,<span class="variable">@n</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@n</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="9-4-4-将查询结果赋值给变量"><a href="#9-4-4-将查询结果赋值给变量" class="headerlink" title="9.4.4 将查询结果赋值给变量"></a>9.4.4 将查询结果赋值给变量</h4><p>在存储过程中使用select..into..给变量赋值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询学生数量</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test3(<span class="keyword">OUT</span> c <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> <span class="built_in">count</span>(stu_num) <span class="keyword">INTO</span> c <span class="keyword">from</span> students; <span class="comment">-- 将查询到学生数量赋值给c</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="keyword">call</span> proc_test3(<span class="variable">@n</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@n</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="9-4-5-用户变量使用注意事项"><a href="#9-4-5-用户变量使用注意事项" class="headerlink" title="9.4.5 用户变量使用注意事项"></a>9.4.5 用户变量使用注意事项</h4><blockquote>
<p>因为用户变量相当于全局变量，可以在SQL指令以及多个存储过程中共享，在开发中建议尽量少使用用户变量，用户变量过多会导致程序不易理解、难以维护。</p>
</blockquote>
<h3 id="9-5-存储过程的参数"><a href="#9-5-存储过程的参数" class="headerlink" title="9.5 存储过程的参数"></a>9.5 存储过程的参数</h3><blockquote>
<p>MySQL存储过程的参数一共有三种：IN  \  OUT  \  INOUT</p>
</blockquote>
<h4 id="9-5-1-IN-输入参数"><a href="#9-5-1-IN-输入参数" class="headerlink" title="9.5.1 IN 输入参数"></a>9.5.1 IN 输入参数</h4><p>输入参数——在调用存储过程中传递数据给存储过程的参数（在调用的过程必须为具有实际值的变量 或者  字面值）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程：添加学生信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test4(<span class="keyword">IN</span> snum <span class="type">char</span>(<span class="number">8</span>),<span class="keyword">IN</span> sname <span class="type">varchar</span>(<span class="number">20</span>), <span class="keyword">IN</span> gender <span class="type">char</span>(<span class="number">2</span>), <span class="keyword">IN</span> age <span class="type">int</span>, <span class="keyword">IN</span> cid <span class="type">int</span>, <span class="keyword">IN</span> remark <span class="type">varchar</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid,remark)</span><br><span class="line">	<span class="keyword">values</span>(snum,sname,gender,age,cid,remark);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> proc_test4(<span class="string">&#x27;20210108&#x27;</span>,<span class="string">&#x27;小丽&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>,<span class="number">1</span>,<span class="string">&#x27;aaa&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="9-5-2-OUT-输出参数"><a href="#9-5-2-OUT-输出参数" class="headerlink" title="9.5.2 OUT 输出参数"></a>9.5.2 OUT 输出参数</h4><p>输出参数——将存储过程中产生的数据返回给过程调用者，相当于Java方法的返回值，但不同的是一个存储过程可以有多个输出参数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程，根据学生学号，查询学生姓名</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test5(<span class="keyword">IN</span> snum <span class="type">char</span>(<span class="number">8</span>),<span class="keyword">OUT</span> sname <span class="type">varchar</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> stu_name <span class="keyword">INTO</span> sname <span class="keyword">from</span> students <span class="keyword">where</span> stu_num<span class="operator">=</span>snum;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@name</span><span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test5(<span class="string">&#x27;20210108&#x27;</span>,<span class="variable">@name</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@name</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="9-5-3-INOUT-输入输出参数"><a href="#9-5-3-INOUT-输入输出参数" class="headerlink" title="9.5.3 INOUT 输入输出参数"></a>9.5.3 INOUT 输入输出参数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test6(<span class="keyword">INOUT</span> str <span class="type">varchar</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> stu_name <span class="keyword">INTO</span> str <span class="keyword">from</span> students <span class="keyword">where</span> stu_num<span class="operator">=</span>str;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@name</span><span class="operator">=</span><span class="string">&#x27;20210108&#x27;</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test6(<span class="variable">@name</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@name</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>



<h3 id="9-6-存储过程中流程控制"><a href="#9-6-存储过程中流程控制" class="headerlink" title="9.6 存储过程中流程控制"></a>9.6 存储过程中流程控制</h3><blockquote>
<p>在存储过程中支持流程控制语句用于实现逻辑的控制</p>
</blockquote>
<h4 id="9-6-1-分支语句"><a href="#9-6-1-分支语句" class="headerlink" title="9.6.1 分支语句"></a>9.6.1 分支语句</h4><ul>
<li>if-then-else</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单分支：如果条件成立，则执行SQL</span></span><br><span class="line">if conditions <span class="keyword">then</span></span><br><span class="line">	<span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"><span class="comment">-- 如果参数a的值为1，则添加一条班级信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test7(<span class="keyword">IN</span> a <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	 if a<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">			<span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2109&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">	 <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 双分支：如果条件成立则执行SQL1，否则执行SQL2</span></span><br><span class="line">if conditions <span class="keyword">then</span></span><br><span class="line">	<span class="comment">-- SQL1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="comment">-- SQL2</span></span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 如果参数a的值为1，则添加一条班级信息；否则添加一条学生信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test7(<span class="keyword">IN</span> a <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	 if a<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">			<span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2109&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">	 <span class="keyword">else</span></span><br><span class="line">	    <span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid,remark) <span class="keyword">values</span>(<span class="string">&#x27;20210110&#x27;</span>,<span class="string">&#x27;小花&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">19</span>,<span class="number">1</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line">	 <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>case</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- case</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test8(<span class="keyword">IN</span> a <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">case</span> a</span><br><span class="line">	<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span>  </span><br><span class="line">		<span class="comment">-- SQL1   如果a的值为1  则执行SQL1</span></span><br><span class="line">		<span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2110&#x27;</span>,<span class="string">&#x27;wahaha&#x27;</span>);</span><br><span class="line">	<span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">		<span class="comment">-- SQL2   如果a的值为2  则执行SQL2</span></span><br><span class="line">		<span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age,cid,remark) </span><br><span class="line">		<span class="keyword">values</span>(<span class="string">&#x27;20210111&#x27;</span>,<span class="string">&#x27;小刚&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="number">2</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	  	<span class="comment">-- SQL (如果变量的值和所有when的值都不匹配，则执行else中的这个SQL)</span></span><br><span class="line">		<span class="keyword">update</span> students <span class="keyword">set</span> stu_age<span class="operator">=</span><span class="number">18</span> <span class="keyword">where</span> stu_num<span class="operator">=</span><span class="string">&#x27;20210110&#x27;</span>;</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>



<h4 id="9-6-2-循环语句"><a href="#9-6-2-循环语句" class="headerlink" title="9.6.2 循环语句"></a>9.6.2 循环语句</h4><ul>
<li>while</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- while</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test9(<span class="keyword">IN</span> num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">declare</span> i <span class="type">int</span>;</span><br><span class="line">	<span class="keyword">set</span> i <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	while i<span class="operator">&lt;</span>num do</span><br><span class="line">			<span class="comment">-- SQL</span></span><br><span class="line">			<span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,remark) <span class="keyword">values</span>( CONCAT(<span class="string">&#x27;Java&#x27;</span>,i) ,<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">			<span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">	<span class="keyword">end</span> while;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> proc_test9(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>repeat</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- repeat</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test10(<span class="keyword">IN</span> num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">declare</span> i <span class="type">int</span>;</span><br><span class="line">	<span class="keyword">set</span> i <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">	repeat</span><br><span class="line">		<span class="comment">-- SQL</span></span><br><span class="line">		<span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,remark) <span class="keyword">values</span>( CONCAT(<span class="string">&#x27;Python&#x27;</span>,i) ,<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">		<span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">	until i <span class="operator">&gt;</span> num <span class="keyword">end</span> repeat;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> proc_test10(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>loop</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- loop</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test11(<span class="keyword">IN</span> num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">declare</span> i <span class="type">int</span> ;</span><br><span class="line">	 <span class="keyword">set</span> i <span class="operator">=</span><span class="number">0</span>;</span><br><span class="line">	 myloop:loop</span><br><span class="line">			<span class="comment">-- SQL</span></span><br><span class="line">			<span class="keyword">insert</span> <span class="keyword">into</span> classes(class_name,remark) <span class="keyword">values</span>( CONCAT(<span class="string">&#x27;HTML&#x27;</span>,i) ,<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">			<span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">			if i<span class="operator">=</span>num <span class="keyword">then</span></span><br><span class="line">			   leave myloop;</span><br><span class="line">			<span class="keyword">end</span> if;</span><br><span class="line">	 <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> proc_test11(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<h3 id="9-7-存储过程管理"><a href="#9-7-存储过程管理" class="headerlink" title="9.7 存储过程管理"></a>9.7 存储过程管理</h3><h4 id="9-7-1-查询存储过程"><a href="#9-7-1-查询存储过程" class="headerlink" title="9.7.1 查询存储过程"></a>9.7.1 查询存储过程</h4><blockquote>
<p>存储过程是属于某个数据库的，也就是说当我们将存储过程创建在某个数据库之后，只能在当前数据库中调用此存储过程。</p>
<p>查询存储过程：查询某个数据库中有哪些存储过程</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 根据数据库名，查询当前数据库中的存储过程</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">procedure</span> status <span class="keyword">where</span> db<span class="operator">=</span><span class="string">&#x27;db_test2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询存储过程的创建细节</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">procedure</span> db_test2.proc_test1;</span><br></pre></td></tr></table></figure>

<h4 id="9-7-2-修改存储过程"><a href="#9-7-2-修改存储过程" class="headerlink" title="9.7.2 修改存储过程"></a>9.7.2 修改存储过程</h4><blockquote>
<p>修改存储过程指的是修改存储过程的特征&#x2F;特性</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">procedure</span> <span class="operator">&lt;</span>proc_name<span class="operator">&gt;</span> 特征<span class="number">1</span> [特征<span class="number">2</span> 特征<span class="number">3</span> ....]</span><br></pre></td></tr></table></figure>

<p>存储过程的特征参数：</p>
<ul>
<li><code>CONTAINS SQL</code> 表示子程序包含 SQL 语句，但不包含读或写数据的语句</li>
<li><code>NO SQL</code> 表示子程序中不包含 SQL 语句</li>
<li><code>READS SQL DATA</code> 表示子程序中包含读数据的语句</li>
<li><code>MODIFIES SQL DATA</code> 表示子程序中包含写数据的语句</li>
<li><code>SQL SECURITY</code> { DEFINER |INVOKER } 指明谁有权限来执行<ul>
<li>DEFINER 表示只有定义者自己才能够执行</li>
<li>INVOKER 表示调用者可以执行</li>
</ul>
</li>
<li><code>COMMENT &#39;string&#39;</code> 表示注释信息</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">procedure</span> proc_test1 <span class="keyword">READS</span> <span class="keyword">SQL</span> DATA;</span><br></pre></td></tr></table></figure>

<h4 id="9-7-3-删除存储过程"><a href="#9-7-3-删除存储过程" class="headerlink" title="9.7.3 删除存储过程"></a>9.7.3 删除存储过程</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除存储过程</span></span><br><span class="line"><span class="comment">-- drop 删除数据库中的对象 数据库、数据表、列、存储过程、视图、触发器、索引....</span></span><br><span class="line"><span class="comment">-- delete 删除数据表中的数据</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> proc_test1;</span><br></pre></td></tr></table></figure>

<h3 id="9-8-存储过程练习案例"><a href="#9-8-存储过程练习案例" class="headerlink" title="9.8 存储过程练习案例"></a>9.8 存储过程练习案例</h3><blockquote>
<p>使用存储过程解决企业项目开发过程中的问题</p>
<p>案例：使用存储过程完成借书操作</p>
</blockquote>
<h4 id="9-8-1-数据准备"><a href="#9-8-1-数据准备" class="headerlink" title="9.8.1 数据准备"></a>9.8.1 数据准备</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库</span></span><br><span class="line"><span class="keyword">create</span> database db_test3;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用数据库</span></span><br><span class="line">use db_test3;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建图书信息表：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> books(</span><br><span class="line">   book_id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	 book_name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 book_author <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 book_price <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 book_stock <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 book_desc <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加图书信息</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> books(book_name,book_author,book_price,book_stock,book_desc)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;Java程序设计&#x27;</span>,<span class="string">&#x27;亮亮&#x27;</span>,<span class="number">38.80</span>,<span class="number">12</span>,<span class="string">&#x27;亮亮老师带你学Java&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> books(book_name,book_author,book_price,book_stock,book_desc)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;Java王者之路&#x27;</span>,<span class="string">&#x27;威哥&#x27;</span>,<span class="number">44.40</span>,<span class="number">9</span>,<span class="string">&#x27;千锋威哥，Java王者领路人&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建学生信息表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">	stu_num <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">primary</span> key,</span><br><span class="line">	stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加学生信息</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;1001&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;1002&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;1003&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<p><strong>业务分析</strong></p>
<blockquote>
<p>哪个学生借哪本书，借了多少本？</p>
<p>操作：</p>
<ul>
<li>保存借书记录</li>
<li>修改图书库存</li>
</ul>
<p>条件：</p>
<ul>
<li>判断学生是否存在？</li>
<li>判断图书是否存在、库存是否充足？</li>
</ul>
</blockquote>
<p><strong>创建借书记录表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 借书记录表：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> records(</span><br><span class="line">   rid <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	 snum <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 bid <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 borrow_num <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 is_return <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>, <span class="comment">-- 0表示为归还   1 表示已经归还</span></span><br><span class="line">	 borrow_date <span class="type">date</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	 <span class="keyword">constraint</span> FK_RECORDS_STUDENTS <span class="keyword">foreign</span> key(snum) <span class="keyword">references</span> students(stu_num),</span><br><span class="line">	 <span class="keyword">constraint</span> FK_RECORDS_BOOKS <span class="keyword">foreign</span> key(bid) <span class="keyword">REFERENCES</span> books(book_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="9-8-2-创建存储过程实现借书业务"><a href="#9-8-2-创建存储过程实现借书业务" class="headerlink" title="9.8.2 创建存储过程实现借书业务"></a>9.8.2 创建存储过程实现借书业务</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 实现借书业务：</span></span><br><span class="line"><span class="comment">-- 参数1： a 输入参数  学号</span></span><br><span class="line"><span class="comment">-- 参数2： b 输入参数  图书编号</span></span><br><span class="line"><span class="comment">-- 参数3： m 输入参数  借书的数量</span></span><br><span class="line"><span class="comment">-- 参数4： state 输出参数  借书的状态（1 借书成功，2 学号不存在，3 图书不存在， 4 库存不足）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_borrow_book(<span class="keyword">IN</span> a <span class="type">char</span>(<span class="number">4</span>),<span class="keyword">IN</span> b <span class="type">int</span>, <span class="keyword">IN</span> m <span class="type">int</span>,<span class="keyword">OUT</span> state <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">declare</span> stu_count <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">declare</span> book_count <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">declare</span> stock <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">-- 判断学号是否存在：根据参数 a 到学生信息表查询是否有stu_num=a的记录</span></span><br><span class="line">	<span class="keyword">select</span> <span class="built_in">count</span>(stu_num) <span class="keyword">INTO</span> stu_count <span class="keyword">from</span> students <span class="keyword">where</span> stu_num<span class="operator">=</span>a;</span><br><span class="line">	if stu_count<span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">		 <span class="comment">-- 学号存在</span></span><br><span class="line">		 <span class="comment">-- 判断图书ID是否存在：根据参数b 查询图书记录总数</span></span><br><span class="line">		 <span class="keyword">select</span> <span class="built_in">count</span>(book_id) <span class="keyword">INTO</span> book_count <span class="keyword">from</span> books <span class="keyword">where</span> book_id<span class="operator">=</span>b;</span><br><span class="line">		 if book_count <span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">		      <span class="comment">-- 图书存在</span></span><br><span class="line">			  <span class="comment">-- 判断图书库存是否充足：查询当前图书库存，然后和参数m进行比较</span></span><br><span class="line">				<span class="keyword">select</span> book_stock <span class="keyword">INTO</span> stock <span class="keyword">from</span> books <span class="keyword">where</span> book_id<span class="operator">=</span>b;</span><br><span class="line">				if stock <span class="operator">&gt;=</span> m <span class="keyword">then</span></span><br><span class="line">					<span class="comment">-- 执行借书</span></span><br><span class="line">					<span class="comment">-- 操作1：在借书记录表中添加记录</span></span><br><span class="line">					<span class="keyword">insert</span> <span class="keyword">into</span> records(snum,bid,borrow_num,is_return,borrow_date) </span><br><span class="line">					<span class="keyword">values</span>(a,b,m,<span class="number">0</span>,sysdate());</span><br><span class="line">					<span class="comment">-- 操作2：修改图书库存</span></span><br><span class="line">					<span class="keyword">update</span> books <span class="keyword">set</span> book_stock<span class="operator">=</span>stock<span class="operator">-</span>m <span class="keyword">where</span> book_id<span class="operator">=</span>b;</span><br><span class="line">					<span class="comment">-- 借书成功</span></span><br><span class="line">					<span class="keyword">set</span> state<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				  <span class="comment">-- 库存不足</span></span><br><span class="line">					<span class="keyword">set</span> state<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line">				<span class="keyword">end</span> if;				</span><br><span class="line">		 <span class="keyword">else</span></span><br><span class="line">				<span class="comment">-- 图书不存在</span></span><br><span class="line">				<span class="keyword">set</span> state <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">		 <span class="keyword">end</span> if;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	   <span class="comment">-- 不存在</span></span><br><span class="line">		 <span class="keyword">set</span> state <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程借书</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@state</span><span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">call</span> proc_borrow_book(<span class="string">&#x27;1001&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="variable">@state</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@state</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="9-8-3-创建存储过程实现还书业务"><a href="#9-8-3-创建存储过程实现还书业务" class="headerlink" title="9.8.3 创建存储过程实现还书业务"></a>9.8.3 创建存储过程实现还书业务</h4><p>期待…</p>
<h3 id="9-9-游标"><a href="#9-9-游标" class="headerlink" title="9.9 游标"></a>9.9 游标</h3><blockquote>
<p>问题：如果我们要创建一个存储 过程，需要返回查询语句查询到的多条数据，该如何实现呢？</p>
</blockquote>
<h4 id="9-1-1-游标的概念"><a href="#9-1-1-游标的概念" class="headerlink" title="9.1.1 游标的概念"></a>9.1.1 游标的概念</h4><p>游标可以用来依次取出查询结果集中的每一条数据——逐条读取查询结果集中的记录</p>
<h4 id="9-1-2-游标的使用步骤"><a href="#9-1-2-游标的使用步骤" class="headerlink" title="9.1.2 游标的使用步骤"></a>9.1.2 游标的使用步骤</h4><p><strong>1、声明游标</strong></p>
<ul>
<li>声明游标语法：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> cursor_nanme <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> select_statement;</span><br></pre></td></tr></table></figure>

<ul>
<li>实例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> mycursor <span class="keyword">cursor</span> <span class="keyword">for</span> <span class="keyword">select</span> book_name,book_author,book_price <span class="keyword">from</span> books;</span><br></pre></td></tr></table></figure>

<p><strong>2、打开游标</strong></p>
<ul>
<li>语法</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> mycursor;</span><br></pre></td></tr></table></figure>

<p><strong>3、使用游标</strong></p>
<ul>
<li>使用游标：提取游标当前指向的记录（提取之后，游标自动下移）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FETCH</span> mycursor <span class="keyword">INTO</span> bname,bauthor,bprice;</span><br></pre></td></tr></table></figure>

<p><strong>4、关闭游标</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CLOSE</span> mycursor; </span><br></pre></td></tr></table></figure>

<h4 id="9-1-3-游标使用案例"><a href="#9-1-3-游标使用案例" class="headerlink" title="9.1.3 游标使用案例"></a>9.1.3 游标使用案例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 游标使用案例</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test2(<span class="keyword">OUT</span> <span class="keyword">result</span> <span class="type">varchar</span>(<span class="number">200</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">declare</span> bname <span class="type">varchar</span>(<span class="number">20</span>);</span><br><span class="line">	 <span class="keyword">declare</span> bauthor <span class="type">varchar</span>(<span class="number">20</span>);</span><br><span class="line">	 <span class="keyword">declare</span> bprice <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">	 <span class="keyword">declare</span> num <span class="type">int</span>; </span><br><span class="line">	 <span class="keyword">declare</span> i <span class="type">int</span>;</span><br><span class="line">	 <span class="keyword">declare</span> str <span class="type">varchar</span>(<span class="number">50</span>);</span><br><span class="line">	 <span class="comment">-- 此查询语句执行之后返回的是一个结果集（多条记录），使用游标可以来遍历查询结果集</span></span><br><span class="line">	 <span class="keyword">declare</span> mycursor <span class="keyword">cursor</span> <span class="keyword">for</span> <span class="keyword">select</span> book_name,book_author,book_price <span class="keyword">from</span> books;</span><br><span class="line">	 <span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">INTO</span> num <span class="keyword">from</span> books;</span><br><span class="line">	 <span class="comment">-- 打开游标</span></span><br><span class="line">	 <span class="keyword">open</span> mycursor;</span><br><span class="line">	 <span class="comment">-- 使用游标要结合循环语句</span></span><br><span class="line">	 <span class="keyword">set</span> i<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line">	 while i<span class="operator">&lt;</span>num do</span><br><span class="line">		  <span class="comment">-- 使用游标：提取游标当前指向的记录（提取之后，游标自动下移）</span></span><br><span class="line">			<span class="keyword">FETCH</span> mycursor <span class="keyword">INTO</span> bname,bauthor,bprice;</span><br><span class="line">			<span class="keyword">set</span> i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">			<span class="comment">-- set str=concat_ws(&#x27;~&#x27;,bname,bauthor,bprice);</span></span><br><span class="line">			<span class="keyword">select</span> concat_ws(<span class="string">&#x27;~&#x27;</span>,bname,bauthor,bprice) <span class="keyword">INTO</span> str;</span><br><span class="line">			<span class="keyword">set</span> <span class="keyword">result</span> <span class="operator">=</span> concat_ws(<span class="string">&#x27;,&#x27;</span>,<span class="keyword">result</span>,str);</span><br><span class="line">	 <span class="keyword">end</span> while;</span><br><span class="line"></span><br><span class="line">	 <span class="comment">-- 关闭游标</span></span><br><span class="line">	 <span class="keyword">close</span> mycursor;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例测试</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@r</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test2(<span class="variable">@r</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@r</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>



<h2 id="十、触发器"><a href="#十、触发器" class="headerlink" title="十、触发器"></a>十、触发器</h2><h3 id="10-1-触发器的介绍"><a href="#10-1-触发器的介绍" class="headerlink" title="10.1 触发器的介绍"></a>10.1 触发器的介绍</h3><p>触发器，就是一种特殊的存储过程。触发器和存储过程一样是一个能够完成特定功能、存储在数据库服务器上的SQL片段，但是触发器无需调用，当对数据表中的数据执行DML操作时自动触发这个SQL片段的执行，无需手动调用。</p>
<p>在MySQL,只有执行insert\delete\update操作才能触发触发器的执行。</p>
<h3 id="10-2-触发器的使用"><a href="#10-2-触发器的使用" class="headerlink" title="10.2 触发器的使用"></a>10.2 触发器的使用</h3><h4 id="10-2-1-案例说明"><a href="#10-2-1-案例说明" class="headerlink" title="10.2.1 案例说明"></a>10.2.1 案例说明</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 学生信息表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">	stu_num <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">primary</span> key,</span><br><span class="line">	stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	stu_age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 学生信息操作日志表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stulogs(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	<span class="type">time</span> <span class="type">TIMESTAMP</span>,</span><br><span class="line">	log_text <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 当向students表中添加学生信息时，同时要在 stulogs表中添加一条操作日志</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;1004&#x27;</span>,<span class="string">&#x27;夏利&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"><span class="comment">-- 手动进行记录日志</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(),<span class="string">&#x27;添加1004学生信息&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>案例：当向学生信息表添加、删除、修改学生信息时，使用触发器自定进行日志记录</p>
<h4 id="10-2-2-创建触发器"><a href="#10-2-2-创建触发器" class="headerlink" title="10.2.2 创建触发器"></a>10.2.2 创建触发器</h4><p>语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_name</span><br><span class="line"><span class="operator">&lt;</span>before<span class="operator">|</span>after<span class="operator">&gt;</span>                     <span class="comment">-- 定义触发时机</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">insert</span><span class="operator">|</span><span class="keyword">delete</span><span class="operator">|</span><span class="keyword">update</span><span class="operator">&gt;</span>             <span class="comment">-- 定义DML类型</span></span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span>					   <span class="comment">-- 声明为行级触发器（只要操作一条记录就触发触发器执行一次）</span></span><br><span class="line">sql_statement 	                   <span class="comment">-- 触发器操作</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建触发器：当学生信息表发生添加操作时，则向日志信息表中记录一条日志</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test1</span><br><span class="line">after <span class="keyword">insert</span> <span class="keyword">on</span> students</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;添加&#x27;</span>,NEW.stu_num,<span class="string">&#x27;学生信息&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h4 id="10-2-3-查看触发器"><a href="#10-2-3-查看触发器" class="headerlink" title="10.2.3 查看触发器"></a>10.2.3 查看触发器</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> triggers;</span><br></pre></td></tr></table></figure>

<h4 id="10-2-3-测试触发器"><a href="#10-2-3-测试触发器" class="headerlink" title="10.2.3 测试触发器"></a>10.2.3 测试触发器</h4><ul>
<li>我们创建的触发器是在students表发生insert操作时触发，我们只需执行学生信息的添加操作</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 测试1：添加一个学生信息，触发器执行了一次</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;1005&#x27;</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试2：一条SQL指令添加了2条学生信息，触发器就执行了2次</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stu_num,stu_name,stu_gender,stu_age) <span class="keyword">values</span>(<span class="string">&#x27;1006&#x27;</span>,<span class="string">&#x27;小刚&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>),(<span class="string">&#x27;1007&#x27;</span>,<span class="string">&#x27;李磊&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<h4 id="10-2-4-删除触发器"><a href="#10-2-4-删除触发器" class="headerlink" title="10.2.4 删除触发器"></a>10.2.4 删除触发器</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> tri_test1;</span><br></pre></td></tr></table></figure>

<h3 id="10-3-NEW与OLD"><a href="#10-3-NEW与OLD" class="headerlink" title="10.3 NEW与OLD"></a>10.3 NEW与OLD</h3><blockquote>
<p>触发器用于监听对数据表中数据的insert、delete、update操作，在触发器中通常处理一些DML的关联操作；我们可以使用<code>NEW</code>和<code>OLD</code>关键字在触发器中获取触发这个触发器的DML操作的数据</p>
<ul>
<li>NEW : 在触发器中用于获取insert操作添加的数据、update操作修改后的记录</li>
<li>OLD：在触发器中用于获取delete操作删除前的数据、update操作修改前的数据</li>
</ul>
</blockquote>
<h4 id="10-3-1-NEW"><a href="#10-3-1-NEW" class="headerlink" title="10.3.1 NEW"></a>10.3.1 NEW</h4><ul>
<li>insert操作中：NEW表示添加的新记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test1</span><br><span class="line">after <span class="keyword">insert</span> <span class="keyword">on</span> students</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;添加&#x27;</span>,NEW.stu_num,<span class="string">&#x27;学生信息&#x27;</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>update操作中：NEW 表示修改后的数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建触发器 : 在监听update操作的触发器中，可以使用NEW获取修改后的数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test2</span><br><span class="line">after <span class="keyword">update</span> <span class="keyword">on</span> students <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;修改学生信息为：&#x27;</span>,NEW.stu_num,NEW.stu_name));</span><br></pre></td></tr></table></figure>

<h4 id="10-3-2-OLD"><a href="#10-3-2-OLD" class="headerlink" title="10.3.2 OLD"></a>10.3.2 OLD</h4><ul>
<li>delete操作中：OLD表示删除的记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test3</span><br><span class="line">after <span class="keyword">delete</span> <span class="keyword">on</span> students <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;删除&#x27;</span>,OLD.stu_num,<span class="string">&#x27;学生信息&#x27;</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>update操作中：OLD表示修改前的记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test2</span><br><span class="line">after <span class="keyword">update</span> <span class="keyword">on</span> students <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;将学生姓名从【&#x27;</span>,OLD.stu_name,<span class="string">&#x27;】修改为【&#x27;</span>,NEW.stu_name,<span class="string">&#x27;】&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="10-4-触发器使用总结"><a href="#10-4-触发器使用总结" class="headerlink" title="10.4 触发器使用总结"></a>10.4 触发器使用总结</h3><h4 id="10-4-1-优点"><a href="#10-4-1-优点" class="headerlink" title="10.4.1 优点"></a>10.4.1 优点</h4><ul>
<li>触发器是自动执行的，当对触发器相关的表执行响应的DML操作时立即执行；</li>
<li>触发器可以实现表中的数据的级联操作（关联操作），有利于保证数据的完整性；</li>
<li>触发器可以对DML操作的数据进行更为复杂的合法性校验</li>
</ul>
<h4 id="10-4-2-缺点"><a href="#10-4-2-缺点" class="headerlink" title="10.4.2 缺点"></a>10.4.2 缺点</h4><ul>
<li>使用触发器实现的业务逻辑如果出现问题将难以定位，后期维护困难；</li>
<li>大量使用触发器容易导致代码结构杂乱，增加了程序的复杂性；</li>
<li>当触发器操作的数据量比较大时，执行效率会大大降低。</li>
</ul>
<h4 id="10-4-3-使用建议"><a href="#10-4-3-使用建议" class="headerlink" title="10.4.3 使用建议"></a>10.4.3 使用建议</h4><ul>
<li>在互联网项目中，应避免适应触发器；</li>
<li>对于并发量不大的项目可以选择使用存储过程，但是在互联网引用中不提倡使用存储过程（原因：存储过程时将实现业务的逻辑交给数据库处理，一则增减了数据库的负载，二则不利于数据库的迁移）</li>
</ul>
<h2 id="十一、视图"><a href="#十一、视图" class="headerlink" title="十一、视图"></a>十一、视图</h2><h3 id="11-1-视图的概念"><a href="#11-1-视图的概念" class="headerlink" title="11.1 视图的概念"></a>11.1 视图的概念</h3><p>视图，就是<code>由数据库中一张表或者多张表根据特定的条件查询出得数据构造成得</code>虚拟表</p>
<h3 id="11-2-视图的作用"><a href="#11-2-视图的作用" class="headerlink" title="11.2 视图的作用"></a>11.2 视图的作用</h3><ul>
<li><strong>安全性</strong>：如果我们直接将数据表授权给用户操作，那么用户可以CRUD数据表中所有数据，加入我们想要对数据表中的部分数据进行保护，可以将公开的数据生成视图，授权用户访问视图；用户通过查询视图可以获取数据表中公开的数据，从而达到将数据表中的部分数据对用户隐藏。</li>
<li><strong>简单性</strong>：如果我们需要查询的数据来源于多张数据表，可以使用多表连接查询来实现；我们通过视图将这些连表查询的结果对用户开放，用户则可以直接通过查询视图获取多表数据，操作更便捷。</li>
</ul>
<h3 id="11-3-创建视图"><a href="#11-3-创建视图" class="headerlink" title="11.3 创建视图"></a>11.3 创建视图</h3><h4 id="11-3-1-语法"><a href="#11-3-1-语法" class="headerlink" title="11.3.1 语法"></a>11.3.1 语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> <span class="operator">&lt;</span>view_name<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">select_statement</span><br></pre></td></tr></table></figure>

<h4 id="11-3-2-实例"><a href="#11-3-2-实例" class="headerlink" title="11.3.2 实例"></a>11.3.2 实例</h4><ul>
<li>实例1：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图实例1：将学生表中性别为男的学生生成一个视图</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_test1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询视图</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> view_test1;</span><br></pre></td></tr></table></figure>

<ul>
<li>示例2：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图示例2：查询学生借书的信息（学生名、图书名、借书数量）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_test2</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">select</span> s.stu_name,b.book_name,borrow_num</span><br><span class="line"><span class="keyword">from</span> books b <span class="keyword">inner</span> <span class="keyword">join</span> records r <span class="keyword">inner</span> <span class="keyword">join</span> students s</span><br><span class="line"><span class="keyword">on</span> b.book_id<span class="operator">=</span>r.bid <span class="keyword">and</span> r.snum<span class="operator">=</span>s.stu_num;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询视图</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> view_test2;</span><br></pre></td></tr></table></figure>

<h3 id="11-4-视图数据的特性"><a href="#11-4-视图数据的特性" class="headerlink" title="11.4 视图数据的特性"></a>11.4 视图数据的特性</h3><blockquote>
<p>视图是虚拟表，查询视图的数据是来源于数据表的。当对视图进行操作时，对原数据表中的数据是否由影响呢？</p>
</blockquote>
<p><strong>查询操作</strong>：如果在数据表中添加了新的数据，而且这个数据满足创建视图时查询语句的条件，通过查询视图也可以查询出新增的数据；当删除原表中满足查询条件的数据时，也会从视图中删除。</p>
<p><strong>新增数据：</strong>如果在视图中添加数据，数据会被添加到原数据表</p>
<p><strong>删除数据：</strong>如果从视图删除数据，数据也将从原表中删除</p>
<p><strong>修改操作：</strong>如果通过修改数据，则也将修改原数据表中的数据</p>
<p><code>视图的使用建议</code>: 对复杂查询简化操作，并且不会对数据进行修改的情况下可以使用视图。</p>
<h3 id="11-5-查询视图结构"><a href="#11-5-查询视图结构" class="headerlink" title="11.5 查询视图结构"></a>11.5 查询视图结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询视图结构</span></span><br><span class="line"><span class="keyword">desc</span> view_test2;</span><br></pre></td></tr></table></figure>

<h3 id="11-6-修改视图"><a href="#11-6-修改视图" class="headerlink" title="11.6 修改视图"></a>11.6 修改视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">OR</span> REPLACE <span class="keyword">view</span> view_test1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">view</span> view_test1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> stu_gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="11-7-删除视图"><a href="#11-7-删除视图" class="headerlink" title="11.7 删除视图"></a>11.7 删除视图</h3><ul>
<li>删除数据表时会同时删除数据表中的数据，删除视图时不会影响原数据表中的数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除视图</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> view_test1;</span><br></pre></td></tr></table></figure>



<h2 id="十二、索引"><a href="#十二、索引" class="headerlink" title="十二、索引"></a>十二、索引</h2><blockquote>
<p>数据库是用来存储数据，在互联网应用中数据库中存储的数据可能会很多(大数据)，<code>数据表中数据的查询速度会随着数据量的增长逐渐变慢</code>，从而导致响应用户请求的速度变慢——用户体验差，我们如何提高数据库的查询效率呢？</p>
</blockquote>
<h3 id="12-1-索引的介绍"><a href="#12-1-索引的介绍" class="headerlink" title="12.1 索引的介绍"></a>12.1 索引的介绍</h3><p>索引，就是用来提高数据表中数据的查询效率的。</p>
<blockquote>
<p>索引，就是将数据表中某一列&#x2F;某几列的值取出来构造成便于查找的结构进行存储，生成数据表的<code>目录</code></p>
<p>当我们进行数据查询的时候，则先在<code>目录</code>中进行查找得到对应的数据的地址，然后再到数据表中根据地址快速的获取数据记录，避免全表扫描。</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111736.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111736.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="12-2-索引的分类"><a href="#12-2-索引的分类" class="headerlink" title="12.2 索引的分类"></a>12.2 索引的分类</h3><p>MySQL中的索引，根据创建索引的列的不同，可以分为：</p>
<ul>
<li>主键索引：在数据表的主键字段创建的索引，这个字段必须被primary key修饰，每张表只能有一个主键</li>
<li>唯一索引：在数据表中的唯一列创建的索引(unique)，此列的所有值只能出现一次，可以为NULL</li>
<li>普通索引：在普通字段上创建的索引，没有唯一性的限制</li>
<li>组合索引：两个及以上字段联合起来创建的索引</li>
</ul>
<p><code>说明</code>:</p>
<ol>
<li>在创建数据表时，将字段声明为主键（添加主键约束），会自动在主键字段创建主键索引；</li>
<li>在创建数据表时，将字段声明为唯一键（添加唯一约束），会自动在唯一字段创建唯一索引；</li>
</ol>
<h3 id="12-3-创建索引"><a href="#12-3-创建索引" class="headerlink" title="12.3 创建索引"></a>12.3 创建索引</h3><h4 id="12-3-1-唯一索引"><a href="#12-3-1-唯一索引" class="headerlink" title="12.3.1 唯一索引"></a>12.3.1 唯一索引</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建唯一索引: 创建唯一索引的列的值不能重复</span></span><br><span class="line"><span class="comment">-- create unique index &lt;index_name&gt; on 表名(列名);</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">unique</span> index index_test1 <span class="keyword">on</span> tb_testindex(tid);</span><br></pre></td></tr></table></figure>

<h4 id="12-3-2-普通索引"><a href="#12-3-2-普通索引" class="headerlink" title="12.3.2 普通索引"></a>12.3.2 普通索引</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建普通索引: 不要求创建索引的列的值的唯一性</span></span><br><span class="line"><span class="comment">-- create index &lt;index_name&gt; on 表名(列名);</span></span><br><span class="line"><span class="keyword">create</span> index index_test2 <span class="keyword">on</span> tb_testindex(name);</span><br></pre></td></tr></table></figure>

<h4 id="12-3-3-组合索引"><a href="#12-3-3-组合索引" class="headerlink" title="12.3.3 组合索引"></a>12.3.3 组合索引</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建组合索引</span></span><br><span class="line"><span class="comment">-- create index &lt;index_name&gt; on 表名(列名1,列名2...);</span></span><br><span class="line"><span class="keyword">create</span> index index_test3 <span class="keyword">on</span> tb_testindex(tid,name);</span><br></pre></td></tr></table></figure>

<h4 id="12-3-4-全文索引"><a href="#12-3-4-全文索引" class="headerlink" title="12.3.4 全文索引"></a>12.3.4 全文索引</h4><blockquote>
<p>MySQL 5.6 版本新增的索引，可以通过此索引进行全文检索操作，因为MySQL全文检索不支持中文，因此这个全文索引不被开发者关注，在应用开发中通常是通过搜索引擎（数据库中间件）实现全文检索</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> fulltext index <span class="operator">&lt;</span>index_name<span class="operator">&gt;</span> <span class="keyword">on</span> 表名(字段名);</span><br></pre></td></tr></table></figure>



<h3 id="12-4-索引使用"><a href="#12-4-索引使用" class="headerlink" title="12.4 索引使用"></a>12.4 索引使用</h3><blockquote>
<p>索引创建完成之后无需调用，当根据创建索引的列进行数据查询的时候，会自动使用索引；</p>
<p>组合索引需要根据创建索引的所有字段进行查询时触发。</p>
</blockquote>
<ul>
<li>在 命令行窗口中可以查看查询语句的查询规划：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_testindex <span class="keyword">where</span> tid<span class="operator">=</span><span class="number">250000</span>\G;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111745.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111745.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h3 id="12-5-查看索引"><a href="#12-5-查看索引" class="headerlink" title="12.5 查看索引"></a>12.5 查看索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 命令行</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> tb_testindex\G;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111755.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111755.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询数据表的索引</span></span><br><span class="line"><span class="keyword">show</span> indexes <span class="keyword">from</span> tb_testindex;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询索引</span></span><br><span class="line"><span class="keyword">show</span> keys <span class="keyword">from</span> tb_testindex;</span><br></pre></td></tr></table></figure>

<h3 id="12-6-删除索引"><a href="#12-6-删除索引" class="headerlink" title="12.6 删除索引"></a>12.6 删除索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除索引：索引是建立在表的字段上的，不同的表中可能会出现相同名称的索引</span></span><br><span class="line"><span class="comment">--           因此删除索引时需要指定表名</span></span><br><span class="line"><span class="keyword">drop</span> index index_test3 <span class="keyword">on</span> tb_testindex;</span><br></pre></td></tr></table></figure>



<h3 id="12-7-索引的使用总结"><a href="#12-7-索引的使用总结" class="headerlink" title="12.7 索引的使用总结"></a>12.7 索引的使用总结</h3><h4 id="12-7-1-优点"><a href="#12-7-1-优点" class="headerlink" title="12.7.1 优点"></a>12.7.1 优点</h4><ul>
<li>索引大大降低了数据库服务器在执行查询操作时扫描的数据，提高查询效率</li>
<li>索引可以避免服务器排序、将随机IO编程顺序IO</li>
</ul>
<h4 id="12-7-2-缺点"><a href="#12-7-2-缺点" class="headerlink" title="12.7.2 缺点"></a>12.7.2 缺点</h4><ul>
<li>索引是根据数据表列的创建的，当数据表中数据发生DML操作时，索引页需要更新；</li>
<li>索引文件也会占用磁盘空间；</li>
</ul>
<h4 id="12-7-3-注意事项"><a href="#12-7-3-注意事项" class="headerlink" title="12.7.3 注意事项"></a>12.7.3 注意事项</h4><ul>
<li>数据表中数据不多时，全表扫面可能更快吗，不要使用索引；</li>
<li>数据量大但是DML操作很频繁时，不建议使用索引；</li>
<li>不要在数据重复读高的列上创建索引（性别）；</li>
<li>创建索引之后，要注意查询SQL语句的编写，避免索引失效。</li>
</ul>
<h2 id="十三、数据库事务"><a href="#十三、数据库事务" class="headerlink" title="十三、数据库事务"></a>十三、数据库事务</h2><h3 id="13-1-数据库事务介绍"><a href="#13-1-数据库事务介绍" class="headerlink" title="13.1 数据库事务介绍"></a>13.1 数据库事务介绍</h3><ul>
<li>我们把完成特定的业务的多个数据库DML操作步骤称之为一个事务</li>
<li>事务，就是完成同一个业务的多个DML操作</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 借书业务</span></span><br><span class="line"><span class="comment">-- 操作1：在借书记录表中添加记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> records(snum,bid,borrow_num,is_return,borrow_date) <span class="keyword">values</span>(<span class="string">&#x27;1001&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,sysdate());</span><br><span class="line"><span class="comment">-- 操作2：修改图书库存</span></span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> book_stock<span class="operator">=</span>book_stock<span class="number">-1</span> <span class="keyword">where</span> book_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 转账业务：张三给李四转账1000</span></span><br><span class="line"><span class="comment">-- 操作1：李四的帐号+1000</span></span><br><span class="line"><span class="comment">-- 操作2：张三的账户-1000</span></span><br></pre></td></tr></table></figure>

<h3 id="13-2-数据库事务特性"><a href="#13-2-数据库事务特性" class="headerlink" title="13.2 数据库事务特性"></a>13.2 数据库事务特性</h3><blockquote>
<p>ACID特性，高频面试题</p>
</blockquote>
<p><strong>原子性</strong>（Atomicity）：一个事务中的多个DML操作，要么同时执行成功，要么同时执行失败</p>
<p><strong>一致性</strong>（Consistency）：事务执行之前和事务执行之后，数据库中的数据是一致的，完整性和一致性不能被破坏</p>
<p><strong>隔离性</strong>（Isolation）：数据库允许多个事务同时执行（张三借Java书的同时允许李四借Java书），多个必行的事务之间不能相互影响</p>
<p><strong>持久性</strong>（Durability）：事务完整之后，对数据库的操作是永久的</p>
<h3 id="13-3-MySQL事务管理"><a href="#13-3-MySQL事务管理" class="headerlink" title="13.3 MySQL事务管理"></a>13.3 MySQL事务管理</h3><h4 id="13-3-1-自动提交"><a href="#13-3-1-自动提交" class="headerlink" title="13.3.1 自动提交"></a>13.3.1 自动提交</h4><ul>
<li>在MySQL中，默认DML指令的执行时自动提交的，当我们执行一个DML指令之后，自动同步到数据库中</li>
</ul>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111805.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111805.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="13-3-2-事务管理"><a href="#13-3-2-事务管理" class="headerlink" title="13.3.2 事务管理"></a>13.3.2 事务管理</h4><blockquote>
<p>开启事务，就是关闭自动提交</p>
</blockquote>
<ul>
<li>在开始事务第一个操作之前，执行<code>start transaction</code>开启事务</li>
<li>依次执行事务中的每个DML操作</li>
<li>如果在执行的过程中的任何位置出现异常，则执行<code>rollback</code>回滚事务</li>
<li>如果事务中所有的DML操作都执行成功，则在最后执行<code>commit</code>提交事务</li>
</ul>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111813.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111813.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 借书业务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 【开启事务】（关闭自动提交---手动提交）</span></span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 操作1：在借书记录表中添加记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> records(snum,bid,borrow_num,is_return,borrow_date) <span class="keyword">values</span>(<span class="string">&#x27;1007&#x27;</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">0</span>,sysdate());</span><br><span class="line"></span><br><span class="line"><span class="comment">-- select aaa;</span></span><br><span class="line"><span class="comment">-- 【事务回滚】（清除连接缓存中的操作,撤销当前事务已经执行的操作）</span></span><br><span class="line"><span class="comment">-- rollback;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 操作2：修改图书库存</span></span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> book_stock<span class="operator">=</span>book_stock<span class="number">-2</span> <span class="keyword">where</span> book_id<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 【提交事务】（将连接缓存中的操作写入数据文件）</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<h3 id="13-4-事务隔离级别"><a href="#13-4-事务隔离级别" class="headerlink" title="13.4 事务隔离级别"></a>13.4 事务隔离级别</h3><blockquote>
<p>数据库允许多个事务并行，多个事务之间是隔离的、相互独立的；如果事务之间不相互隔离并且操作同一数据时，可能会导致数据的一致性被破坏。</p>
</blockquote>
<p>MySQL数据库事务隔离级别：</p>
<h4 id="13-4-1-读未提交（read-uncommitted）"><a href="#13-4-1-读未提交（read-uncommitted）" class="headerlink" title="13.4.1 读未提交（read uncommitted）"></a>13.4.1 <strong>读未提交</strong>（read uncommitted）</h4><p>T2可以读取T1执行但未提交的数据；可能会导致出现脏读</p>
<blockquote>
<p>脏读，一个事务读取到了另一个事务中未提交的数据</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111821.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111821.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="13-4-2-读已提交（read-committed）"><a href="#13-4-2-读已提交（read-committed）" class="headerlink" title="13.4.2 读已提交（read committed）"></a>13.4.2 <strong>读已提交</strong>（read committed）</h4><p>T2只能读取T1已经提交的数据；避免了脏读，但可能会导致不可重复度（虚读）</p>
<blockquote>
<p>不可重复度（虚读）: 在同一个事务中，两次查询操作读取到数据不一致</p>
<p>例如：T2进行第一次查询之后在第二次查询之前，T1修改并提交了数据，T2进行第二次查询时读取到的数据和第一次查询读取到数据不一致。</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111828.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111828.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="13-4-3-可重复读（repeatable-read）"><a href="#13-4-3-可重复读（repeatable-read）" class="headerlink" title="13.4.3 可重复读（repeatable read）"></a>13.4.3 <strong>可重复读</strong>（repeatable read）</h4><p>T2执行第一次查询之后，在事务结束之前其他事务不能修改对应的数据；避免了不可重复读(虚读)，但可能会导致幻读</p>
<blockquote>
<p>幻读，T2对数据表中的数据进行修改然后查询，在查询之前T1向数据表中新增了一条数据，就导致T2以为修改了所有数据，但却查询出了与修改不一致的数据（T1事务新增的数据）</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111837.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111837.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="13-4-4-串行化-serializable"><a href="#13-4-4-串行化-serializable" class="headerlink" title="13.4.4 串行化(serializable)"></a>13.4.4 <strong>串行化</strong>(serializable)</h4><p>同时只允许一个事务对数据表进行操作；避免了脏读、虚读、幻读问题</p>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>脏读</th>
<th>不可重复读(虚读)</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>read uncommitted</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>read committed</td>
<td>×</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>repeatable read</td>
<td>×</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td>serializable</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody></table>
<h4 id="13-4-5-设置数据库事务隔离级别"><a href="#13-4-5-设置数据库事务隔离级别" class="headerlink" title="13.4.5 设置数据库事务隔离级别"></a>13.4.5 设置数据库事务隔离级别</h4><blockquote>
<p>我们可以通过设置数据库默认的事务隔离级别来控制事务之间的隔离性；</p>
<p>也可以通过客户端与数据库连接设置来设置事务间的隔离性（在应用程序中设置–Spring）；</p>
<p>MySQL数据库默认的隔离级别为<code>可重复读</code></p>
</blockquote>
<ul>
<li>查看MySQL数据库默认的隔离级别</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在MySQL8.0.3 之前</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@tx</span>_isolation;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在MySQL8.0.3 之后</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@transaction</span>_isolation;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>设置MySQL默认隔离级别</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> session transaction isolation level <span class="operator">&lt;</span>read committed<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="十四、数据库设计"><a href="#十四、数据库设计" class="headerlink" title="十四、数据库设计"></a>十四、数据库设计</h2><blockquote>
<p>MySQL数据库作为数据存储的介质为应用系统提供数据存储的服务，我们如何设计出合理的数据库、数据表以满足应用系统的数据存储需求呢？</p>
</blockquote>
<ul>
<li>车库：是用来存放车辆的，车库都需要划分车位，如果不划分车位，车子杂乱无章的存放可能会导致车辆堵塞，同时也可能造成场地的浪费——有限的场地能够停放最多的车辆，同时方便每一辆车的出入</li>
<li>数据库，是用来存放数据的，我们需要设计合理的数据表——能够完成数据的存储，同时能够方便的提取应用系统所需的数据</li>
</ul>
<h3 id="14-1-数据库设计流程"><a href="#14-1-数据库设计流程" class="headerlink" title="14.1 数据库设计流程"></a>14.1 数据库设计流程</h3><blockquote>
<p>数据库是为应用系统服务的，数据库存储什么样的数据也是由应用系统来决定的。</p>
<p>当我们进行应用系统开发时，我们首先要明确应用系统的功能需求——软件系统的需求分析</p>
</blockquote>
<ol>
<li><p><strong>根据应用系统的功能，分析数据实体</strong>(实体，就是要存储的数据对象)</p>
<p> 电商系统：商品、用户、订单….</p>
<p> 教务管理系统：学生、课程、成绩…</p>
</li>
<li><p><strong>提取实体的数据项</strong>（数据项，就是实体的属性）</p>
<p> 商品(商品名称、商品图片、商品描述…)</p>
<p> 用户(姓名、登录名、登录密码…)</p>
</li>
<li><p><strong>根据数据库设计三范式规范视图的数据项</strong> 检查实体的数据项是否满足数据库设计三范式</p>
<p> <code>如果实体的数据项不满足三范式，可能会导致数据的冗余，从而引起数据维护困难、破坏数据一致性等问题</code></p>
</li>
<li><p><strong>绘制E-R图</strong> （实体关系图，直观的展示实体与实体之间的关系）</p>
</li>
<li><p><strong>数据库建模</strong></p>
<ul>
<li>三线图进行数据表设计</li>
<li>PowerDesigner</li>
<li>PDMan</li>
</ul>
</li>
<li><p><strong>建库建表</strong>  编写SQL指令创建数据库、数据表</p>
</li>
<li><p><strong>添加测试数据，SQL测试</strong></p>
</li>
</ol>
<h3 id="14-2-数据库设计案例"><a href="#14-2-数据库设计案例" class="headerlink" title="14.2 数据库设计案例"></a>14.2 数据库设计案例</h3><blockquote>
<p>学校图书馆图书管理系统（借书）</p>
</blockquote>
<h4 id="14-2-1-数据实体"><a href="#14-2-1-数据实体" class="headerlink" title="14.2.1 数据实体"></a>14.2.1 数据实体</h4><ul>
<li>学生</li>
<li>类别</li>
<li>图书</li>
<li>借书记录</li>
<li>管理员</li>
</ul>
<h4 id="14-2-2-提取数据项"><a href="#14-2-2-提取数据项" class="headerlink" title="14.2.2 提取数据项"></a>14.2.2 提取数据项</h4><ul>
<li><p>学生（学号、姓名、性别、年龄、院系编号）</p>
</li>
<li><p>院系（院系编号、院系名称、院系说明…）</p>
</li>
<li><p>类别（类别ID，类别名称，类别描述）</p>
</li>
<li><p>图书（图书ID，图书名称，图书作者，图书封面，图书价格，图书库存…）</p>
</li>
<li><p>借书记录（记录ID，学号，图书编号，数量，是否归还，借书日期，还书日期）</p>
</li>
<li><p>管理员（管理员ID，登录名，登录密码，员工编号）</p>
</li>
<li><p>员工（员工编号，员工姓名，手机，qq，邮箱）</p>
</li>
</ul>
<h4 id="14-2-3-数据库设计三范式"><a href="#14-2-3-数据库设计三范式" class="headerlink" title="14.2.3 数据库设计三范式"></a>14.2.3 数据库设计三范式</h4><p><strong><code>第一范式</code>：要求数据表中的字段（列）不可再分</strong></p>
<p>以下表不满足第一范式（在数据库中创建不出不满足第一范式的表）</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111849.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111849.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p>将细分的列作为单独的一列：</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111857.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111857.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong><code>第二范式</code>：不存在非关键字段对关键字段的部分依赖</strong></p>
<p>以下表不满足第二范式</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111904.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111904.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p>将每个关键字段列出来\关键字段的组合也列出来，依次检查每个非关键字段</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111914.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111914.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong><code>第三范式</code>：不存在非关键字段之间的传递依赖</strong></p>
<p>以下数据表不满足第三范式</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111923.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111923.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p>将关键字段和被依赖的非关键字段分别作为主键，依次检查所有的非关键字段的依赖关系</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111930.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111930.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="14-2-4-数据库建模（E-R图）"><a href="#14-2-4-数据库建模（E-R图）" class="headerlink" title="14.2.4 数据库建模（E-R图）"></a>14.2.4 数据库建模（E-R图）</h4><blockquote>
<p>E-R  (Entity-Relationship) 实体关系图，用于直观的体现实体与实体之间的关联关系（一对一、一对多、多对一、多对多）</p>
</blockquote>
<p><strong>E-R图</strong>基本图例</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111941.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111941.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong>E-R图</strong>示例</p>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111948.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111948.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<p><strong>三线图</strong> 统一数据实体的表结构</p>
<blockquote>
<p>每个实体创建一张数据表</p>
<p>多对多关联：需额外常见一个数据表维护关系，关系表分别创建外键与两张表关联</p>
<p>一对多、多对一关联：在多的一端添加外键与一的一端的主键建立主外键约束</p>
<p>一对一关联：在任意一端创建外键与另一端建立主外键关联，并且将外键设置为unique</p>
</blockquote>
<p><img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111957.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001111957.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
<h4 id="14-2-5-数据库建模（PD）"><a href="#14-2-5-数据库建模（PD）" class="headerlink" title="14.2.5 数据库建模（PD）"></a>14.2.5 数据库建模（PD）</h4><blockquote>
<p>E-R图实际上就是数据模建模的一部分：</p>
<ul>
<li>E-R 图   数据表设计  建库建表</li>
<li>PowerDesigner建模工具   导出数据表</li>
<li>PDMan建模工具</li>
</ul>
</blockquote>
<ol>
<li><p><code>下载并安装PowerDesigner建模工具</code></p>
</li>
<li><p><code>PowerDesigner使用</code></p>
<ul>
<li><p><em>概念数据模型</em>（选择workspace–右键new–Conceptual Data Model），相当于E-R</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112006.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112006.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
<li><p><em>逻辑数据模型</em>（打开概念数据模型–tools–Generate Logical Data Model）,体现了实体的主外键关联</p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112013.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112013.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
<li><p><em>物理数据模型</em>（打开逻辑数据模型–tools–Generate Physical Data Mode—选择数据库类型及版本）</p>
<ul>
<li>可以对物理数据模型进行微调</li>
<li>可以通过物理数据模型生成建库建表的SQL语句（在物理数据模型的窗口中—-Database工具条—Generate Database–生成SQL文件）</li>
<li>通过数据库的管理工具执行SQL文件就可以完成数据表的创建</li>
</ul>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112021.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112021.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
<li><p><em>面向对象模型</em>（打开概念数据模型&#x2F;逻辑数据模型&#x2F;物理数据模型—tools–Generate Object-Orentited Model）</p>
<ul>
<li>可以根据语言设置，生成实体类（Java）</li>
<li>如果想要借助于PD建模工具生成Java代码，创建概念的模型时实体名、属性名都要符合Java程序的命名规范。</li>
</ul>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112028.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112028.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
</ul>
<blockquote>
<p>在企业项目开发，我们通常是不会使用建模工具来生成数据表、实体类的，因为生成的代码规范不合乎我们的代码需求</p>
</blockquote>
</li>
</ol>
<h4 id="14-2-6-数据库建模（PDMan）"><a href="#14-2-6-数据库建模（PDMan）" class="headerlink" title="14.2.6 数据库建模（PDMan）"></a>14.2.6 数据库建模（PDMan）</h4><ul>
<li><p>下载安装PDMan</p>
</li>
<li><p>创建项目——在项目中创建数据表</p>
</li>
<li><p>在项目中生成<code>关系图</code></p>
<p>  <img src="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112039.png" class="lazyload" data-srcset="https://cdn.staticaly.com/gh/bitezhang/blogzdy@master/javaweb/mysql/20221001112039.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p>
</li>
</ul>

  </div>
  
  
    
    <div class='footer'>
       <!-- 参考资料、相关资料等 -->
      
       <!-- 相关文章 -->
      
      <!-- 版权声明组件 -->
      
      <!-- 打赏组件 -->
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
      
        
          
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fa-solid fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：19.7k 字</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fa-solid fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：80 分钟</p>
    </a>
  </div>


        
      
        
      
    </div>
    <!-- Custom Files bottomMeta begin -->
    
    <!-- Custom Files bottomMeta end -->
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='../day03-JDBC/'>
          <p class='title'><i class="fa-solid fa-chevron-left" aria-hidden="true"></i>day03-JDBC</p>
          <p class='content'>
Course：JDBC 数据库编程

一、JDBC介绍
JDBC (Java DataBase Contectivity) Java与数据库的连接——数据库编程
JDBC 是Java语言（JD...</p>
        </a>
      
      
        <a class='next' href='../../16/day10-jQuery/'>
          <p class='title'>day10-jQuery<i class="fa-solid fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>一、jQuery简介1.1 web前端的知识回顾
HTML  决定了网页的内容
CSS   决定了标签的样式
JavaScript 决定了网页的功能：对标签属性、样式的操作、DOM节点操作、aj...</p>
        </a>
      
    </div>
  
  <!-- Custom Files postEnd begin-->
  
  <!-- Custom Files postEnd end-->
</article>


  


  <article class="post white-box shadow floatable blur" id="comments">
    <span hidden>
      <meta itemprop="discussionUrl" content="#comments">
    </span>
    <p ct><i class='fa-solid fa-comments'></i> 评论</p>
    

    <div id="layoutHelper-comments"></div>

  </article>






</div>
<aside id='l_side' itemscope itemtype="http://schema.org/WPSideBar">
  

  
    
    
      
    
  


<div class="widget-sticky pjax">

  
  


  <section class="widget toc-wrapper desktop mobile " id="toc-div" >
    
  <header>
    
      <i class="fa-solid fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81MySQL%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9"><span class="toc-text">一、MySQL课程内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D"><span class="toc-text">1.1 数据库介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1.2 MySQL数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-SQL-%E7%BB%93%E6%9E%84%E5%8C%96%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text">1.3 SQL 结构化查询语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-SQL-%E9%AB%98%E7%BA%A7"><span class="toc-text">1.4 SQL 高级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-text">1.5 数据库设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1"><span class="toc-text">1.6 数据库事务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D"><span class="toc-text">二、数据库介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E5%BF%B5"><span class="toc-text">2.1 数据库概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.2 关系型数据库与非关系型数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%A7%E5%93%81"><span class="toc-text">2.3 常见的数据库产品</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%AF%E8%AF%AD"><span class="toc-text">2.4 数据库术语</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">三、MySQL数据库环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-MySQL%E7%89%88%E6%9C%AC%E5%8F%8A%E4%B8%8B%E8%BD%BD"><span class="toc-text">3.1 MySQL版本及下载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E7%89%88%E6%9C%AC"><span class="toc-text">3.1.1 版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E4%B8%8B%E8%BD%BD"><span class="toc-text">3.1.2 下载</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-MySQL-%E5%AE%89%E8%A3%85"><span class="toc-text">3.2 MySQL 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-MySQL%E9%85%8D%E7%BD%AE"><span class="toc-text">3.3 MySQL配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E7%AB%AF%E5%8F%A3%E9%85%8D%E7%BD%AE"><span class="toc-text">3.3.1 端口配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E8%AE%BE%E7%BD%AE"><span class="toc-text">3.3.2 账号密码设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-%E6%9C%8D%E5%8A%A1%E5%90%8D%E7%A7%B0"><span class="toc-text">3.3.3 服务名称</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-MySQL-%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%90%AF%E5%8A%A8%E4%B8%8E%E5%81%9C%E6%AD%A2"><span class="toc-text">3.4 MySQL 服务的启动与停止</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%AE%A1%E7%90%86%E7%AA%97%E5%8F%A3"><span class="toc-text">3.4.1 计算机管理窗口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-windows%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-text">3.4.2 windows命令行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-MySQL%E5%8D%B8%E8%BD%BD"><span class="toc-text">3.5 MySQL卸载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81MySQL%E7%9A%84%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-text">四、MySQL的管理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-MySQL-Command-line-Client%E4%BD%BF%E7%94%A8"><span class="toc-text">4.1 MySQL Command line Client使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7Navicat%E4%BD%BF%E7%94%A8"><span class="toc-text">4.2 可视化工具Navicat使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-Navicat%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BD%E5%8F%8A%E5%AE%89%E8%A3%85"><span class="toc-text">4.2.1 Navicat工具下载及安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5"><span class="toc-text">4.2.2 创建连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81MySQL%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84"><span class="toc-text">五、MySQL逻辑结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84"><span class="toc-text">5.1 逻辑结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E8%AE%B0%E5%BD%95-x2F-%E5%85%83%E7%BB%84"><span class="toc-text">5.2 记录&#x2F;元组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81SQL-%E7%BB%93%E6%9E%84%E5%8C%96%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text">六、SQL 结构化查询语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-SQL%E6%A6%82%E8%BF%B0"><span class="toc-text">6.1 SQL概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-1-SQL%E5%8F%91%E5%B1%95"><span class="toc-text">6.1.1 SQL发展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-2-SQL%E5%88%86%E7%B1%BB"><span class="toc-text">6.1.2 SQL分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-SQL%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">6.2 SQL基本语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-DDL-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80"><span class="toc-text">6.3 DDL 数据定义语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-DDL-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-text">6.3.1 DDL-数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-DDL-%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-text">6.3.2 DDL-数据表操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.4 MySQL数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-1-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.4.1 数值类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.4.2 字符串类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-3-%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.4.3 日期类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E5%AD%97%E6%AE%B5%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.5 字段约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-1-%E7%BA%A6%E6%9D%9F%E4%BB%8B%E7%BB%8D"><span class="toc-text">6.5.1 约束介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.5.2 非空约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-3-%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.5.3 唯一约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-4-%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.5.4 主键约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-5-%E4%B8%BB%E9%94%AE%E8%87%AA%E5%8A%A8%E5%A2%9E%E9%95%BF"><span class="toc-text">6.5.5 主键自动增长</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-6-%E8%81%94%E5%90%88%E4%B8%BB%E9%94%AE"><span class="toc-text">6.5.6 联合主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-7-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.5.7 外键约束</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-DML-%E6%95%B0%E6%8D%AE%E6%93%8D%E7%BA%B5%E8%AF%AD%E8%A8%80"><span class="toc-text">6.6 DML 数据操纵语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-1-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-text">6.6.1 插入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-2-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-text">6.6.2 删除数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-text">6.6.3 修改数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-DQL-%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-text">6.7 DQL 数据查询语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-1-%E6%9F%A5%E8%AF%A2%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-text">6.7.1 查询基础语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-2-where-%E5%AD%90%E5%8F%A5"><span class="toc-text">6.7.2 where 子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-3-LIKE-%E5%AD%90%E5%8F%A5"><span class="toc-text">6.7.3 LIKE 子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-4-%E5%AF%B9%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-text">6.7.4 对查询结果的处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-5-%E6%8E%92%E5%BA%8F-order-by"><span class="toc-text">6.7.5 排序 -  order by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-6-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-text">6.7.6 聚合函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-7-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0-%E5%92%8C-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-text">6.7.7 日期函数 和 字符串函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-8-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2-group-by"><span class="toc-text">6.7.8 分组查询 - group by</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7-9-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2-limit"><span class="toc-text">6.7.9 分页查询 - limit</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB"><span class="toc-text">七、数据表的关联关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB%E4%BB%8B%E7%BB%8D"><span class="toc-text">7.1 关联关系介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94"><span class="toc-text">7.2 一对一关联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E4%B8%80%E5%AF%B9%E5%A4%9A%E4%B8%8E%E5%A4%9A%E5%AF%B9%E4%B8%80"><span class="toc-text">7.3 一对多与多对一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94"><span class="toc-text">7.4 多对多关联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">7.5 外键约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F-%E7%BA%A7%E8%81%94"><span class="toc-text">7.6 外键约束-级联</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">八、连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-text">8.1 数据准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-text">8.1.1 创建数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-2-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-text">8.1.2 添加数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%86%85%E8%BF%9E%E6%8E%A5-INNER-JOIN"><span class="toc-text">8.2 内连接 INNER JOIN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-1-%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-text">8.2.1 笛卡尔积</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-2-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9D%A1%E4%BB%B6"><span class="toc-text">8.2.2 内连接条件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%B7%A6%E8%BF%9E%E6%8E%A5-LEFT-JOIN"><span class="toc-text">8.2 左连接 LEFT JOIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%8F%B3%E8%BF%9E%E6%8E%A5-RIGHT-JOIN"><span class="toc-text">8.3 右连接 RIGHT JOIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-%E6%95%B0%E6%8D%AE%E8%A1%A8%E5%88%AB%E5%90%8D"><span class="toc-text">8.4 数据表别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-%E5%AD%90%E6%9F%A5%E8%AF%A2-x2F-%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-text">8.5 子查询&#x2F;嵌套查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-5-1-%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%8D%95%E4%B8%AA%E5%80%BC-%E5%8D%95%E8%A1%8C%E5%8D%95%E5%88%97"><span class="toc-text">8.5.1 子查询返回单个值-单行单列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-5-2-%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%A4%9A%E4%B8%AA%E5%80%BC-%E5%A4%9A%E8%A1%8C%E5%8D%95%E5%88%97"><span class="toc-text">8.5.2 子查询返回多个值-多行单列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-5-3-%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%A4%9A%E4%B8%AA%E5%80%BC-%E5%A4%9A%E8%A1%8C%E5%A4%9A%E5%88%97"><span class="toc-text">8.5.3 子查询返回多个值-多行多列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">九、存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BB%8B%E7%BB%8D"><span class="toc-text">9.1 存储过程介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-1-SQL%E6%8C%87%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-text">9.1.1 SQL指令执行过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-2-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-text">9.1.2 存储过程的介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BC%98%E7%BC%BA%E7%82%B9%E5%88%86%E6%9E%90"><span class="toc-text">9.1.3 存储过程优缺点分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">9.2 创建存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-1-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%88%9B%E5%BB%BA%E8%AF%AD%E6%B3%95"><span class="toc-text">9.2.1 存储过程创建语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-2-%E7%A4%BA%E4%BE%8B"><span class="toc-text">9.2.2 示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">9.3 调用存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">9.4 存储过程中变量的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-1-%E5%AE%9A%E4%B9%89%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-text">9.4.1 定义局部变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-2-%E5%AE%9A%E4%B9%89%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-text">9.4.2 定义用户变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-3-%E7%BB%99%E5%8F%98%E9%87%8F%E8%AE%BE%E7%BD%AE%E5%80%BC"><span class="toc-text">9.4.3 给变量设置值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-4-%E5%B0%86%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E8%B5%8B%E5%80%BC%E7%BB%99%E5%8F%98%E9%87%8F"><span class="toc-text">9.4.4 将查询结果赋值给变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-5-%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">9.4.5 用户变量使用注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">9.5 存储过程的参数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-5-1-IN-%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-text">9.5.1 IN 输入参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-5-2-OUT-%E8%BE%93%E5%87%BA%E5%8F%82%E6%95%B0"><span class="toc-text">9.5.2 OUT 输出参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-5-3-INOUT-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%8F%82%E6%95%B0"><span class="toc-text">9.5.3 INOUT 输入输出参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-text">9.6 存储过程中流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-6-1-%E5%88%86%E6%94%AF%E8%AF%AD%E5%8F%A5"><span class="toc-text">9.6.1 分支语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-6-2-%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="toc-text">9.6.2 循环语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-7-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="toc-text">9.7 存储过程管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-7-1-%E6%9F%A5%E8%AF%A2%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">9.7.1 查询存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-7-2-%E4%BF%AE%E6%94%B9%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">9.7.2 修改存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-7-3-%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">9.7.3 删除存储过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-8-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%BB%83%E4%B9%A0%E6%A1%88%E4%BE%8B"><span class="toc-text">9.8 存储过程练习案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-1-%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-text">9.8.1 数据准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-2-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%AE%9E%E7%8E%B0%E5%80%9F%E4%B9%A6%E4%B8%9A%E5%8A%A1"><span class="toc-text">9.8.2 创建存储过程实现借书业务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-3-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%AE%9E%E7%8E%B0%E8%BF%98%E4%B9%A6%E4%B8%9A%E5%8A%A1"><span class="toc-text">9.8.3 创建存储过程实现还书业务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-9-%E6%B8%B8%E6%A0%87"><span class="toc-text">9.9 游标</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-1-%E6%B8%B8%E6%A0%87%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">9.1.1 游标的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-2-%E6%B8%B8%E6%A0%87%E7%9A%84%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-text">9.1.2 游标的使用步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-3-%E6%B8%B8%E6%A0%87%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-text">9.1.3 游标使用案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">十、触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-text">10.1 触发器的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">10.2 触发器的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-1-%E6%A1%88%E4%BE%8B%E8%AF%B4%E6%98%8E"><span class="toc-text">10.2.1 案例说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-2-%E5%88%9B%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">10.2.2 创建触发器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-3-%E6%9F%A5%E7%9C%8B%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">10.2.3 查看触发器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-3-%E6%B5%8B%E8%AF%95%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">10.2.3 测试触发器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-4-%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">10.2.4 删除触发器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-NEW%E4%B8%8EOLD"><span class="toc-text">10.3 NEW与OLD</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-1-NEW"><span class="toc-text">10.3.1 NEW</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-2-OLD"><span class="toc-text">10.3.2 OLD</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E8%A7%A6%E5%8F%91%E5%99%A8%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93"><span class="toc-text">10.4 触发器使用总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-1-%E4%BC%98%E7%82%B9"><span class="toc-text">10.4.1 优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-2-%E7%BC%BA%E7%82%B9"><span class="toc-text">10.4.2 缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-3-%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-text">10.4.3 使用建议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E8%A7%86%E5%9B%BE"><span class="toc-text">十一、视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E8%A7%86%E5%9B%BE%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">11.1 视图的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">11.2 视图的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="toc-text">11.3 创建视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-1-%E8%AF%AD%E6%B3%95"><span class="toc-text">11.3.1 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-2-%E5%AE%9E%E4%BE%8B"><span class="toc-text">11.3.2 实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-4-%E8%A7%86%E5%9B%BE%E6%95%B0%E6%8D%AE%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-text">11.4 视图数据的特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-%E6%9F%A5%E8%AF%A2%E8%A7%86%E5%9B%BE%E7%BB%93%E6%9E%84"><span class="toc-text">11.5 查询视图结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-6-%E4%BF%AE%E6%94%B9%E8%A7%86%E5%9B%BE"><span class="toc-text">11.6 修改视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-7-%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-text">11.7 删除视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E7%B4%A2%E5%BC%95"><span class="toc-text">十二、索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-text">12.1 索引的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E7%B4%A2%E5%BC%95%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">12.2 索引的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-text">12.3 创建索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-1-%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95"><span class="toc-text">12.3.1 唯一索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-2-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95"><span class="toc-text">12.3.2 普通索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-3-%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-text">12.3.3 组合索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-4-%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95"><span class="toc-text">12.3.4 全文索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8"><span class="toc-text">12.4 索引使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-5-%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95"><span class="toc-text">12.5 查看索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-6-%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="toc-text">12.6 删除索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-7-%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93"><span class="toc-text">12.7 索引的使用总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-7-1-%E4%BC%98%E7%82%B9"><span class="toc-text">12.7.1 优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-7-2-%E7%BC%BA%E7%82%B9"><span class="toc-text">12.7.2 缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-7-3-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">12.7.3 注意事项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1"><span class="toc-text">十三、数据库事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E4%BB%8B%E7%BB%8D"><span class="toc-text">13.1 数据库事务介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7"><span class="toc-text">13.2 数据库事务特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-MySQL%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">13.3 MySQL事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-3-1-%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4"><span class="toc-text">13.3.1 自动提交</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-3-2-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">13.3.2 事务管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text">13.4 事务隔离级别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-4-1-%E8%AF%BB%E6%9C%AA%E6%8F%90%E4%BA%A4%EF%BC%88read-uncommitted%EF%BC%89"><span class="toc-text">13.4.1 读未提交（read uncommitted）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-4-2-%E8%AF%BB%E5%B7%B2%E6%8F%90%E4%BA%A4%EF%BC%88read-committed%EF%BC%89"><span class="toc-text">13.4.2 读已提交（read committed）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-4-3-%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%EF%BC%88repeatable-read%EF%BC%89"><span class="toc-text">13.4.3 可重复读（repeatable read）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-4-4-%E4%B8%B2%E8%A1%8C%E5%8C%96-serializable"><span class="toc-text">13.4.4 串行化(serializable)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-4-5-%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text">13.4.5 设置数据库事务隔离级别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-text">十四、数据库设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B"><span class="toc-text">14.1 数据库设计流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E6%A1%88%E4%BE%8B"><span class="toc-text">14.2 数据库设计案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-1-%E6%95%B0%E6%8D%AE%E5%AE%9E%E4%BD%93"><span class="toc-text">14.2.1 数据实体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-2-%E6%8F%90%E5%8F%96%E6%95%B0%E6%8D%AE%E9%A1%B9"><span class="toc-text">14.2.2 提取数据项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="toc-text">14.2.3 数据库设计三范式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E6%A8%A1%EF%BC%88E-R%E5%9B%BE%EF%BC%89"><span class="toc-text">14.2.4 数据库建模（E-R图）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E6%A8%A1%EF%BC%88PD%EF%BC%89"><span class="toc-text">14.2.5 数据库建模（PD）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-6-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E6%A8%A1%EF%BC%88PDMan%EF%BC%89"><span class="toc-text">14.2.6 数据库建模（PDMan）</span></a></li></ol></li></ol></li></ol>
    </div>
  </section>

  

</div>


<!-- 没有 pjax 占位会报错 万恶的 pjax -->

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <!-- Custom Files side begin -->
  
  <!-- Custom Files side end -->
</aside>



          <!--此文件用来存放一些不方便取值的变量-->
<!--思路大概是将值藏到重加载的区域内-->

<pjax>
<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.commentPath="";
  pdata.commentPlaceholder="";
  pdata.commentConfig={};
  //  see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs
  
    // header
    var l_header=document.getElementById("l_header");
    
    l_header.classList.add("show");
    
    
      // cover
      var cover_wrapper=document.querySelector('#l_cover .cover-wrapper');
      var scroll_down=document.getElementById('scroll-down');
      cover_wrapper.id="none";
      cover_wrapper.style.display="none";
      scroll_down.style.display="none";
    
  
</script>
</pjax>
        </div>
        
  
  <footer class="footer clearfix"  itemscope itemtype="http://schema.org/WPFooter">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js
      theme='#1BCDFC'
      autoplay='true'
      volume='0.7'
      loop='all'
      order='list'
      fixed='true'
      list-max-height='320px'
      server='netease'
      type='playlist'
      id='7632089142'
      list-folded='true'>
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper" itemprop="about" itemscope itemtype="http://schema.org/Thing">
          
            
              <a href="https://space.bilibili.com/34529760?spm_id_from=333.1007.0.0/"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="../../../../mailto:947514507@qq.com/"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://github.com/bitezhang/"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=7632089142/"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/#5.7.5" target="_blank" class="codename">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_value_site_pv"><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © 2017-2022</a></p>

        </div>
      
    
    <!-- Custom Files footer begin-->
    
    <!-- Custom Files footer end-->
  </footer>


        <a id="s-top" class="fa-solid fa-arrow-up fa-fw" href="/" onclick="return false;" title="top"></a>
      </div>
    </div>
    <div>
      <script>
  /******************** volantis.dom ********************************/
  // 页面选择器 将dom对象缓存起来 see: /source/js/app.js etc.
  volantis.dom.bodyAnchor = volantis.dom.$(document.getElementById("safearea")); // 页面主体
  volantis.dom.topBtn = volantis.dom.$(document.getElementById('s-top')); // 向上
  volantis.dom.wrapper = volantis.dom.$(document.getElementById('wrapper')); // 整个导航栏
  volantis.dom.coverAnchor = volantis.dom.$(document.querySelector('#l_cover .cover-wrapper')); // 1个
  volantis.dom.switcher = volantis.dom.$(document.querySelector('#l_header .switcher .s-search')); // 搜索按钮   移动端 1个
  volantis.dom.header = volantis.dom.$(document.getElementById('l_header')); // 移动端导航栏
  volantis.dom.search = volantis.dom.$(document.querySelector('#l_header .m_search')); // 搜索框 桌面端 移动端 1个
  volantis.dom.mPhoneList = volantis.dom.$(document.querySelectorAll('#l_header .m-phone .list-v')); //  手机端 子菜单 多个
</script>

<script>
  
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fortawesome/fontawesome-free/css/all.min.css");
  
  
  
</script>

<!-- required -->


<!-- internal -->

<script src="../../../../../../../../js/app.js"></script>






<!-- rightmenu要在darkmode之前（ToggleButton） darkmode要在comments之前（volantis.dark.push）-->

  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "color-scheme";
const rootElementDarkModeAttributeName = "color-scheme";
const setLS = (k, v) => {
    localStorage.setItem(k, v);
};
const removeLS = (k) => {
    localStorage.removeItem(k);
};
const getLS = (k) => {
    return localStorage.getItem(k);
};
const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};
const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};
const validColorModeKeys = {
  dark: true,
  light: true,
};
const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);
  getCustomDarkMode();
  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};
const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};
/**
 * get target mode
 */
 const getCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  if(currentSetting=="dark"){
    volantis.dark.mode="light";
  }else{
    volantis.dark.mode="dark";
  }
  // console.log(volantis.dark.mode)
};
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};
/**
 * 暗黑模式触发器
 */
volantis.dark.toggle=()=>{
  const mode = toggleCustomDarkMode();
  applyCustomDarkModeSettings(mode);
  // 使用 volantis.dark.push 方法传入volantis.dark.toggle回调函数 参见layout/_partial/scripts/global.ejs
  volantis.dark.method.toggle.start();
}
/**
 * bind event for toggle button
 */

function bindToggleButton() {
  var btn= document.querySelectorAll("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn")
  btn.forEach(function (e) {
    volantis.dom.$(e).on('click',volantis.dark.toggle);
  })
}
applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", ()=>{
  volantis.requestAnimationFrame(bindToggleButton)
});
volantis.pjax.push(bindToggleButton);

const darkModelListeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "dark";
    }
    volantis.dark.method.toggle.start();
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "light";
    }
    volantis.dark.method.toggle.start();
  }
}
window.matchMedia('(prefers-color-scheme: dark)').addListener(darkModelListeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(darkModelListeners.light)
</script>




<script>
  function loadIssuesJS() {
    
      const sites_api = document.getElementById('sites-api');
      if (sites_api != undefined && typeof SitesJS === 'undefined') {
        volantis.js("../../../../js/plugins/tags/sites.js")
      }
    
    
      const friends_api = document.getElementById('friends-api');
      if (friends_api != undefined && typeof FriendsJS === 'undefined') {
        volantis.js("../../../../js/plugins/tags/friends.js")
      }
    
    
      const contributors_api = document.getElementById('contributors-api');
      if (contributors_api != undefined && typeof ContributorsJS === 'undefined') {
        volantis.js("../../../../js/plugins/tags/contributors.js")
      }
    
  };
  loadIssuesJS()
  volantis.pjax.push(()=>{
    loadIssuesJS();
  })

</script>




  <script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/vanilla-lazyload/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>




  

<script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: ["#"],
	maxRPS: 6,
	hoverDelay: 0
  };
</script>
<script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/flying-pages/flying-pages.min.js"></script>







  <script>
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/aplayer/dist/APlayer.min.css");
  (async () => {
    // APlayer 需要在  MetingJS 之前加载
    await volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/aplayer/dist/APlayer.min.js")
    await volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/meting/dist/Meting.min.js")
  
  })();

  function SetAPlayerPlugin(){
    let Metings = document.querySelectorAll('meting-js');
    if (Metings.length === 0) {return;};
    if (Metings[0].aplayer && Metings[0].aplayer.on) {
      // improve the accessibility https://web.dev/button-name/
      document.querySelectorAll(".aplayer-icon-menu").forEach(e=>{
        e.setAttribute("aria-label","Aplayer Menu")
      })
      // message see: /layout/_plugins/message/script.ejs
      
        try {
          setTimeout(() => {
            Metings.forEach((item, index) => {
              const aplayerItem = item.aplayer; if(!aplayerItem) return;
              const rightAplayerCheck = 'true' === 'true'
                && item.meta.id === '7632089142';
              if(rightAplayerCheck) RightMenuAplayer.checkAPlayer();
              if(aplayerItem.events.events.play.every(item => {return item.name !== 'messagePlay'})) {
                aplayerItem.on('play', function messagePlay() {
                  let index = aplayerItem.list.index;
                  let title = aplayerItem.list.audios[index].title;
                  let artist = aplayerItem.list.audios[index].artist;
                  setTimeout(() => {
                    VolantisApp.message('音乐通知', title + ' - ' + artist, {
                      icon: 'fa-solid fa-play',
                      transitionIn: 'flipInX',
                      transitionOut: 'flipOutX'
                    });
                  }, 100)
                });
              }
              if(aplayerItem.events.events.pause.every(item => {return item.name !== 'messagePause'})) {
                aplayerItem.on('pause', function messagePause() {
                  let index = aplayerItem.list.index;
                  let title = aplayerItem.list.audios[index].title;
                  let artist = aplayerItem.list.audios[index].artist;
                  setTimeout(() => {
                    // 歌曲播放结束也会触发 pause 事件，为了避免错误提示，等待一会儿
                    if(aplayerItem.paused) {
                      VolantisApp.message('音乐通知', title + ' - ' + artist, {
                        icon: 'fa-solid fa-pause',
                        transitionIn: 'flipInX',
                        transitionOut: 'flipOutX'
                      });
                    }
                  }, 100)
                });
              }
            });
          }, 500)
        } catch (error) { console.error(error); }
      
    }else{
      volantis.requestAnimationFrame(SetAPlayerPlugin)
    }
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    SetAPlayerPlugin();
  });
  volantis.pjax.push(SetAPlayerPlugin);
</script>




      <script>
  volantis.layoutHelper("comments",`<div id="giscus_container"></div>`)

  volantis.giscus = {};

  function check_giscus() {
    if (volantis.dark.mode === "dark") {
      volantis.giscus.Theme = 'dark';
    } else {
      volantis.giscus.Theme = 'light';
    }

    return document.getElementById("giscus_container");
  }

  function pjax_giscus() {
    const HEAD = check_giscus();
    if (!HEAD) return;
    let cfg = Object.assign({"theme":{"light":"light","dark":"dark"},"repo":"bitezhang/comments","repo-id":"R_kgDOH-YLMw","category":"Announcements","category-id":"DIC_kwDOH-YLM84CRXVe","mapping":"pathname","reactions-enabled":"1","emit-metadata":"0","lang":"zh-CN"},pdata.commentConfig)
    const script = document.createElement('script');
    script.setAttribute('src', 'https://giscus.app/client.js');
    Object.keys(cfg).forEach(k=>{
      if (k != "theme") {
        script.setAttribute('data-'+k, cfg[k]);
      }
    })
    script.setAttribute('data-theme', volantis.giscus.Theme);
    script.setAttribute('crossorigin', "anonymous");
    HEAD.appendChild(script);
  }

  function dark_giscus() {
    const HEAD = check_giscus();
    if (!HEAD) return;

    const message = {
      setConfig: {
        theme: volantis.giscus.Theme
      }
    };
    const giscusIframe = document.querySelector('iframe.giscus-frame');
    giscusIframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }
  pjax_giscus();
  volantis.pjax.push(pjax_giscus);
  volantis.dark.push(dark_giscus);
</script>

    




  <script defer src="https://cdn.dusays.com/bsz.js" data-pjax></script>


<!-- optional -->

  <script>
  const SearchServiceDataPathRoot = ("/" || "/").endsWith("/") ?
    "/" || "/" :
    "//" || "/";
  const SearchServiceDataPath = SearchServiceDataPathRoot + "content.json";

  function loadSearchScript() {
    // see: layout/_partial/scripts/_ctrl/cdnCtrl.ejs
    return volantis.js("../../../../js/search/hexo.js");
  }

  function loadSearchService() {
    loadSearchScript();
    document.querySelectorAll(".input.u-search-input").forEach((e) => {
      e.removeEventListener("focus", loadSearchService, false);
    });

    document.querySelectorAll(".u-search-form").forEach((e) => {
      e.addEventListener("submit", (event) => {
        event.preventDefault();
      }, false);
    });
  }

  // 打开并搜索 字符串 s
  function OpenSearch(s) {
    if (typeof SearchService === 'undefined')
      loadSearchScript().then(() => {
        SearchService.setQueryText(s);
        SearchService.search();
      });
    else {
      SearchService.setQueryText(s);
      SearchService.search();
    }
  }

  // 访问含有 ?s=xxx  的链接时打开搜索 // 与搜索引擎 structured data 相关: /scripts/helpers/structured-data/lib/config.js
  if (window.location.search && /^\?s=/g.test(window.location.search)) {
    let queryText = decodeURI(window.location.search)
      .replace(/\ /g, "-")
      .replace(/^\?s=/g, "");
    OpenSearch(queryText);
  }

  // 搜索输入框获取焦点时加载搜索
  document.querySelectorAll(".input.u-search-input").forEach((e) => {
    e.addEventListener("focus", loadSearchService, false);
  });
</script>







  <script>



  function pjax_highlightjs_copyCode(){
    if (!(document.querySelector(".highlight .code pre") ||
      document.querySelector(".article pre code"))) {
      return;
    }
    VolantisApp.utilCopyCode(".highlight .code pre, .article pre code")
  }
  volantis.requestAnimationFrame(pjax_highlightjs_copyCode)
  volantis.pjax.push(pjax_highlightjs_copyCode)

</script>












  <script>
  function load_swiper() {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.css");
    volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.js").then(() => {
      pjax_swiper();
    });
  }

  load_swiper();

  function pjax_swiper() {
    volantis.swiper = new Swiper('.swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    });
  }

  volantis.pjax.push(() => {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    if (typeof volantis.swiper === "undefined") {
      load_swiper();
    } else {
      pjax_swiper();
    }
  });
</script>


<!-- pjax 标签必须存在于所有页面 否则 pjax error -->
<pjax>

</pjax>

<script>
  function listennSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    let targets = []
    const sections = [...navItems].map((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
        decodeURI(link.getAttribute("href")).replace("#", "")
      );
      targets.push(target)
      // 解除 a 标签 href 的 锚点定位, a 标签 href 的 锚点定位 会随机启用?? 产生错位???
      link.setAttribute("onclick","return false;")
      link.setAttribute("toc-action","toc-"+decodeURI(link.getAttribute("href")).replace("#", ""))
      link.setAttribute("href","/")
      // 配置 点击 触发新的锚点定位
      link.addEventListener("click", (event) => {
        event.preventDefault();
        // 这里的 addTop 是通过错位使得 toc 自动展开.
        volantis.scroll.to(target,{addTop: 5, observer:true})
        // Anchor id
        history.pushState(null, document.title, "#" + target.id);
      });
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    // 方案一：
    volantis.activateNavIndex=0
    activateNavByIndex(navItems[volantis.activateNavIndex])
    volantis.scroll.push(()=>{
      if (targets[0].getBoundingClientRect().top >= 0) {
        volantis.activateNavIndex = 0
      }else if (targets[targets.length-1].getBoundingClientRect().top < 0) {
        volantis.activateNavIndex = targets.length-1
      } else {
        for (let index = 0; index < targets.length; index++) {
          const target0 = targets[index];
          const target1 = targets[(index+1)%targets.length];
          if (target0.getBoundingClientRect().top < 0&&target1.getBoundingClientRect().top >= 0) {
            volantis.activateNavIndex=index
            break;
          }
        }
      }
      activateNavByIndex(navItems[volantis.activateNavIndex])
    })

    // 方案二：
    // IntersectionObserver 不是完美精确到像素级别 也不是低延时性的
    // function findIndex(entries) {
    //   let index = 0;
    //   let entry = entries[index];
    //   if (entry.boundingClientRect.top > 0) {
    //     index = sections.indexOf(entry.target);
    //     return index === 0 ? 0 : index - 1;
    //   }
    //   for (; index < entries.length; index++) {
    //     if (entries[index].boundingClientRect.top <= 0) {
    //       entry = entries[index];
    //     } else {
    //       return sections.indexOf(entry.target);
    //     }
    //   }
    //   return sections.indexOf(entry.target);
    // }
    // function createIntersectionObserver(marginTop) {
    //   marginTop = Math.floor(marginTop + 10000);
    //   let intersectionObserver = new IntersectionObserver(
    //     (entries, observe) => {
    //       let scrollHeight = document.documentElement.scrollHeight;
    //       if (scrollHeight > marginTop) {
    //         observe.disconnect();
    //         createIntersectionObserver(scrollHeight);
    //         return;
    //       }
    //       let index = findIndex(entries);
    //       activateNavByIndex(navItems[index]);
    //     }, {
    //       rootMargin: marginTop + "px 0px -100% 0px",
    //       threshold: 0,
    //     }
    //   );
    //   sections.forEach((element) => {
    //     element && intersectionObserver.observe(element);
    //   });
    // }
    // createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
  document.addEventListener("pjax:success", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
</script>



<script>
  document.onreadystatechange = function () {
    if (document.readyState == 'complete') {
      // 页面加载完毕 样式加载失败，或是当前网速慢，或是开启了省流模式
      const { saveData, effectiveType } = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {}
      if (getComputedStyle(document.querySelector("#safearea"), null)["display"] == "none" || saveData || /2g/.test(effectiveType)) {
        document.querySelectorAll(".reveal").forEach(function (e) {
          e.style["opacity"] = "1";
        });
        document.querySelector("#safearea").style["display"] = "block";
      }
    }
  }
</script>


  <script type="application/ld+json">[{"@context":"http://schema.org","@type":"Organization","name":"比特张的博客","url":"http://example.com/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},{"@context":"http://schema.org","@type":"Person","name":"bitezhang","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"http://example.com/","sameAs":["https://github.com/volantis-x"],"description":"个人学习博客"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"http://example.com/","name":"比特张的博客"}},{"@type":"ListItem","position":2,"item":{"@id":"http://example.com/categories/JavaWeb-1/","name":"JavaWeb(1)"}},{"@type":"ListItem","position":3,"item":{"@id":"http://example.com/2022/09/19/day02-MySQL/","name":"day02-MySQL"}}]},{"@context":"http://schema.org","@type":"WebSite","name":"比特张的博客","url":"http://example.com/","keywords":"zdy","description":"个人学习博客","author":{"@type":"Person","name":"bitezhang","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"http://example.com/","description":"个人学习博客"},"publisher":{"@type":"Organization","name":"比特张的博客","url":"http://example.com/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"potentialAction":{"@type":"SearchAction","name":"Site Search","target":{"@type":"EntryPoint","urlTemplate":"http://example.com?s={search_term_string}"},"query-input":"required name=search_term_string"}},{"@context":"http://schema.org","@type":"BlogPosting","headline":"day02-MySQL","description":"个人学习博客","inLanguage":["zh-CN","default"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2022/09/19/day02-MySQL/"},"author":{"@type":"Person","name":"bitezhang","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"http://example.com/"},"publisher":{"@type":"Organization","name":"比特张的博客","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"url":"http://example.com/2022/09/19/day02-MySQL/","wordCount":0,"datePublished":"2022-09-19T01:08:56.000Z","dateModified":"2022-10-05T06:55:20.713Z","articleSection":"JavaWeb(1)","keywords":"MySQL","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}}]</script>



      
        <!--
  pjax重载区域接口：
  1.  <pjax></pjax> 标签 pjax 标签必须存在于所有页面 否则 pjax error
  2.  script[data-pjax]
  3.  .pjax-reload script
  4.  .pjax
-->



<script src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/pjax/pjax.min.js"></script>


<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox]):not([onclick="return false;"]):not([onclick="return!1"]):not([target="_blank"]):not([target="view_window"]):not([href$=".xml"])',
        selectors: [
          "head title",
          "head meta[name=keywords]",
          "head meta[name=description]",
          
          "#l_main",
          "#pjax-header-nav-list",
          ".pjax",
          "pjax", // <pjax></pjax> 标签
          "script[data-pjax], .pjax-reload script" // script标签添加data-pjax 或 script标签外层添加.pjax-reload 的script代码段重载
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000,
        
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      // 使用 volantis.pjax.send 方法传入pjax:send回调函数 参见layout/_partial/scripts/global.ejs
      volantis.pjax.method.send.start();
    });

    document.addEventListener('pjax:complete', function () {
      // 使用 volantis.pjax.push 方法传入重载函数 参见layout/_partial/scripts/global.ejs
      volantis.pjax.method.complete.start();
    });

    document.addEventListener('pjax:error', function (e) {
      if(volantis.debug) {
        console.error(e);
        console.log('pjax error: \n' + JSON.stringify(e));
      }else{
        // 使用 volantis.pjax.error 方法传入pjax:error回调函数 参见layout/_partial/scripts/global.ejs
        volantis.pjax.method.error.start();
        window.location.href = e.triggerElement.href;
      }
    });
</script>

      
    </div>
    <!-- import body_end begin-->
    <!-- import body_end end-->
    <!-- Custom Files bodyEnd begin-->
    
    <!-- Custom Files bodyEnd end-->
  </body>
</html>
